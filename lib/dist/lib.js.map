{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///external {\"root\":\"React\",\"commonjs2\":\"react\",\"commonjs\":\"react\",\"amd\":\"react\"}","webpack:///../node_modules/immer/dist/immer.module.js","webpack:///../node_modules/is-hotkey/lib/index.js","webpack:///../node_modules/lodash/isObject.js","webpack:///../node_modules/webpack/buildin/global.js","webpack:///../node_modules/lodash/_root.js","webpack:///../node_modules/lodash/_Symbol.js","webpack:///../node_modules/esrever/esrever.js","webpack:///../node_modules/lodash/throttle.js","webpack:///../node_modules/direction/index.js","webpack:///external {\"root\":\"ReactDOM\",\"commonjs2\":\"react-dom\",\"commonjs\":\"react-dom\",\"amd\":\"react-dom\"}","webpack:///../node_modules/is-url/index.js","webpack:///../node_modules/webpack/buildin/module.js","webpack:///../node_modules/process/browser.js","webpack:///../node_modules/lodash/debounce.js","webpack:///../node_modules/lodash/now.js","webpack:///../node_modules/lodash/_freeGlobal.js","webpack:///../node_modules/lodash/toNumber.js","webpack:///../node_modules/lodash/isSymbol.js","webpack:///../node_modules/lodash/_baseGetTag.js","webpack:///../node_modules/lodash/_getRawTag.js","webpack:///../node_modules/lodash/_objectToString.js","webpack:///../node_modules/lodash/isObjectLike.js","webpack:///../node_modules/slate/node_modules/is-plain-object/index.js","webpack:///../node_modules/slate/node_modules/isobject/index.js","webpack:///../node_modules/slate/dist/index.es.js","webpack:///../node_modules/compute-scroll-into-view/es/index.js","webpack:///../node_modules/scroll-into-view-if-needed/es/index.js","webpack:///../node_modules/slate-react/dist/index.es.js","webpack:///./src/helpers/compose.js","webpack:///./src/helpers/flow.js","webpack:///./src/helpers/map.js","webpack:///./src/helpers/get.js","webpack:///./src/helpers/apply.js","webpack:///./src/helpers/createPlugin.js","webpack:///./src/helpers/withId.js","webpack:///./src/helpers/useForceUpdate.js","webpack:///./src/helpers/leafHelpers.js","webpack:///./src/constants.js","webpack:///./src/helpers/elementHelpers.js","webpack:///./src/helpers/messageHelpers.js","webpack:///./src/components/Toolbar.js","webpack:///./src/components/Icon.js","webpack:///./src/plugins/bold.js","webpack:///./src/plugins/italic.js","webpack:///./src/plugins/underline.js","webpack:///./src/plugins/logger.js","webpack:///./src/plugins/bulletedList.js","webpack:///./src/plugins/numberedList.js","webpack:///./src/plugins/listItem.js","webpack:///./src/plugins/mention.js","webpack:///./src/plugins/editorPlaceholder.js","webpack:///./src/plugins/link.js","webpack:///./src/plugins/cursorTracker.js","webpack:///./src/plugins/heading1.js","webpack:///./src/components/JsonViewer.js","webpack:///./src/serializers/plain.js","webpack:///./src/helpers/why.js","webpack:///./src/transformers/react.js","webpack:///./src/lib.js"],"names":["root","factory","exports","module","require","define","amd","a","i","window","__WEBPACK_EXTERNAL_MODULE__0__","__WEBPACK_EXTERNAL_MODULE__10__","installedModules","__webpack_require__","moduleId","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","_a","Archtype","ProxyType","hasSymbol","hasMap","Map","hasSet","Set","NOTHING","DRAFTABLE","DRAFT_STATE","iteratorSymbol","iterator","extendStatics","b","setPrototypeOf","__proto__","Array","__extends","__","this","constructor","isDraft","isDraftable","proto","getPrototypeOf","isPlainObject","isArray","isMap","isSet","ownKeys","Reflect","getOwnPropertySymbols","obj","getOwnPropertyNames","concat","each","iter","getArchtype","forEach","entry","index","thing","die","type","ES5Object","ProxyObject","ES5Array","ProxyArray","has","prop","is","x","y","target","latest","state","copy","base","shallowCopy","invokeGetters","slice","clone","desc","getOwnPropertyDescriptor","Error","writable","configurable","freeze","deep","isFrozen","add","clear","delete","dontMutateFrozenCollections","set","_","ImmerScope","parent","immer","drafts","canAutoFreeze","usePatches","patchListener","patches","inversePatches","revoke","leave","current","enter","scope","draft","revoked","processResult","result","baseDraft","isReplaced","undefined","willFinalize","modified","finalize","maybeFreeze","push","op","path","finalizeTree","finalized","onDelete","useProxies","assigned","exists","copy_1","onCopy","autoFreeze","basePath","assignedValue","origValue","generatePatchesFromAssigned","_b","length","delta","start","end","replaceCount","generateArrayPatches","unshift","generateSetPatches","generatePatches","rootPath","finalizeProperty","rootState","parentValue","childValue","isDraftProp","isSetMember","propOrOldValue","grandChild","onAssign","objectTraps","peek","createProxy","baseValue","prepareCopy","markChanged","deleteProperty","owner","arrayTraps","willFinalizeES5","finalizing","markChangesSweep","markChangesRecursively","markChangedES5","hasArrayChanges","min","Math","createES5Proxy","clonePotentialDraft","descriptors","assertUnrevoked","peek$1","prepareCopy$1","get$1","set$1","proxyProperty","isEnumerable","isManual","fn","arguments","apply","isNaN","parseInt","JSON","stringify","hasObjectChanges","keys","state_1","descriptor","DraftMap","_super","size","prepareCopy$2","cb","thisArg","_this","_value","_map","values","next","done","entries","DraftSet","prepareCopy$3","applyPatches","patch","join","deepClonePatchValue","splice","map","from","cloned","__spreadArrays","il","k","j","jl","configDefaults","Proxy","revocable","process","Immer","config","setUseProxies","produce","produceWithPatches","recipe","defaultBase_1","self_1","arguments$1","args","_i","scope_1","proxy","hasError","Promise","then","error","arg1","arg2","arg3","ip","createDraft","finishDraft","setAutoFreeze","proxyMap","proxySet","traps","IS_MAC","test","navigator","platform","MODIFIERS","alt","control","meta","shift","ALIASES","break","cmd","command","ctl","ctrl","del","down","esc","ins","left","mod","opt","option","return","right","space","spacebar","up","win","windows","CODES","backspace","tab","pause","capslock","escape","pageup","pagedown","home","arrowleft","arrowup","arrowright","arrowdown","insert","numlock","scrolllock","'","f","isHotkey","hotkey","options","event","array","string","parseHotkey","check","e","some","compareHotkey","byKey","ret","replace","split","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","optional","endsWith","toKeyName","modifier","which","toKeyCode","err","expected","actual","toLowerCase","toUpperCase","charCodeAt","default","isCodeHotkey","isKeyHotkey","g","Function","freeGlobal","freeSelf","self","freeExports","global","regexSymbolWithCombiningMarks","regexSurrogatePair","reverse","$0","$1","$2","charAt","esrever","debounce","isObject","func","wait","leading","trailing","TypeError","String","rtl","ltr","LTR","RegExp","match","protocolAndDomainRE","everythingAfterProtocol","localhostDomainRE","nonLocalhostDomainRE","webpackPolyfill","deprecate","paths","children","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","fun","setTimeout","clearTimeout","currentQueue","queue","draining","queueIndex","cleanUpNextTick","drainQueue","timeout","len","run","marker","runClearTimeout","Item","noop","nextTick","title","browser","env","argv","version","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","binding","cwd","chdir","dir","umask","now","toNumber","nativeMax","max","nativeMin","lastArgs","lastThis","maxWait","timerId","lastCallTime","lastInvokeTime","maxing","invokeFunc","time","leadingEdge","timerExpired","shouldInvoke","timeSinceLastCall","trailingEdge","timeWaiting","remainingWait","debounced","isInvoking","cancel","flush","Date","isSymbol","reTrim","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","other","valueOf","isBinary","baseGetTag","isObjectLike","getRawTag","objectToString","symToStringTag","objectProto","nativeObjectToString","toString","isOwn","tag","unmasked","isObjectObject","val","ctor","prot","_defineProperty","_objectWithoutProperties","source","excluded","sourceKeys","indexOf","_objectWithoutPropertiesLoose","sourceSymbolKeys","propertyIsEnumerable","DIRTY_PATHS","WeakMap","FLUSHING","NORMALIZING","PATH_REFS","POINT_REFS","RANGE_REFS","SPACE","PUNCTUATION","CHAMELEON","getCharacterDistance","text","offset","prev","charCode","isSurrogate","isModifier","isBMPEmoji","isVariationSelector","isWordCharacter","char","remaining","rest","code","enumerableOnly","symbols","filter","sym","_objectSpread","getOwnPropertyDescriptors","defineProperties","Editor","editor","voids","at","selection","levels","Text","isText","Path","equals","addMark","range","anchor","point","edge","focus","distance","positions","unit","deleteBackward","deleteForward","deleteFragment","edges","node","fragment","hasBlocks","element","isBlock","hasInlines","isInline","hasTexts","every","insertBreak","insertFragment","insertNode","insertText","Element","isElement","isEditor","isVoid","normalizeNode","onChange","removeMark","marks","Range","isRange","isNodeList","Operation","isOperationList","operations","Point","isEdge","isStart","isEnd","first","isNormalizing","leaf","isExpanded","nodes","_node","previous","block","above","prevNode","prevPath","blockPath","isAncestor","last","to","span","isPath","includes","universal","Span","isSpan","hit","iterable","pass","_ref","matches","isLower","compare","force","getDirtyPaths","allPaths","_ref2","withoutNormalizing","pop","parentPath","depth","firstPath","lastPath","common","isPoint","affinity","ref","pathRefs","refs","pointRefs","reverse$1","available","isNewBlock","advance","started","getWordDistance","isFirst","rangeRefs","points","transform","_path","_node2","before","after","_point","_key","_path2","_node3","_parent","_index","_point2","_key2","_path3","newPath","_node4","_parent2","_index2","truePath","newParent","newIndex","_point3","_key3","_path4","_index3","_point4","_key4","_prev","texts","_path5","_offset","_text2","_node5","_before","_after","_point5","_key5","_path6","newProperties","_node6","_key6","_newProperties","assign","_path7","position","properties","newNode","_node7","_parent4","_index4","_before2","_after2","_before3","_after3","_point6","_key7","isCollapsed","endBlock","skip","isBefore","normalize","isElementList","props","ancestors","ancestor","child","childPath","another","_leaf","isNode","visited","isAfter","nextIndex","ownKeys$1","_objectSpread$1","isNodeOperation","isOperation","isSelectionOperation","isTextOperation","isSibling","_properties","av","as","bs","bv","isChild","isCommon","isDescendant","isParent","list","operation","endsBefore","_op","_op2","_op3","_position","_op4","onp","PathRef","unref","ownKeys$2","_objectSpread$2","PointRef","ownKeys$3","isBackward","rs","re","ts","te","isAfterStart","isBeforeEnd","s1","e1","s2","e2","_objectSpread$3","isForward","affinityAnchor","affinityFocus","RangeRef","ownKeys$4","_objectSpread$4","loose","isTextList","decorations","leaves","dec","middle","_off","ownKeys$5","_objectSpread$5","ownKeys$6","_objectSpread$6","NodeTransforms","hanging","select","unhangRange","pointRef","Transforms","_matchPath","pathRef","isAtEnd","splitNodes","void","matchPath","parentNodeEntry","toPath","moveNodes","removeNodes","_toPath","splitPath","_toPath2","commonPath","isPreviousSibling","emptyAncestor","emptyRef","isEmpty","toRef","targets","_ref3","depths","_ref4","rangeRef","splitMode","height","always","deleteRange","beforeRef","highest","voidMatch","voidNode","voidPath","afterPath","insertNodes","afterRef","highestPath","lowestPath","setNodes","_ref5","_loop","intersection","liftNodes","roots","commonNodeEntry","commonNode","wrapperPath","wrapper","ownKeys$7","_objectSpread$7","ownKeys$8","_objectSpread$8","_text","opts","setSelection","oldProps","newProps","furthestVoid","startBlock","isAcrossBlocks","isSingleText","startVoid","endVoid","startRef","endRef","mergeNodes","inlineElementMatch","_inlinePath","blockMatch","isBlockStart","isBlockEnd","mergeStart","mergeEnd","matcher","starts","middles","ends","starting","inlineMatch","inlinePath","isInlineStart","isInlineEnd","middleRef","_end","ownKeys$9","_objectSpread$9","createEditor","dirtyPaths","oldDirtyPaths","newDirtyPaths","resolve","getFragment","inline","shouldHaveInlines","_child","isLast","unsetNodes","oldAncestors","newAncestors","_ancestor","_p","el","nodeType","canOverflow","overflow","skipOverflowHiddenElements","isScrollable","clientHeight","scrollHeight","clientWidth","scrollWidth","style","getComputedStyle","overflowY","overflowX","frame","ownerDocument","defaultView","frameElement","getFrameElement","isHiddenByFrame","alignNearest","scrollingEdgeStart","scrollingEdgeEnd","scrollingSize","scrollingBorderStart","scrollingBorderEnd","elementEdgeStart","elementEdgeEnd","elementSize","scrollMode","boundary","checkBoundary","scrollingElement","document","documentElement","frames","cursor","parentNode","body","viewportWidth","visualViewport","width","innerWidth","viewportHeight","innerHeight","viewportX","scrollX","pageXOffset","viewportY","scrollY","pageYOffset","_target$getBoundingCl","getBoundingClientRect","targetHeight","targetWidth","targetTop","top","targetRight","targetBottom","bottom","targetLeft","targetBlock","targetInline","computations","_frame$getBoundingCli","frameStyle","borderLeft","borderLeftWidth","borderTop","borderTopWidth","borderRight","borderRightWidth","borderBottom","borderBottomWidth","blockScroll","inlineScroll","scrollbarWidth","offsetWidth","scrollbarHeight","offsetHeight","scrollLeft","scrollTop","isOptionsObject","targetIsDetached","contains","behavior","computeOptions","getOptions","actions","canSmoothScroll","scroll","defaultBehavior","Key","id","NODE_TO_INDEX","NODE_TO_PARENT","EDITOR_TO_ELEMENT","ELEMENT_TO_NODE","KEY_TO_ELEMENT","NODE_TO_ELEMENT","NODE_TO_KEY","IS_READ_ONLY","IS_FOCUSED","EDITOR_TO_ON_CHANGE","PLACEHOLDER_SYMBOL","isDOMElement","isDOMNode","Node","isDOMText","getEditableChild","direction","childNodes","triedForward","triedBackward","getAttribute","getPlainText","domNode","nodeValue","childNode","display","getPropertyValue","tagName","ReactEditor","isFocused","isReadOnly","toDOMNode","activeElement","blur","preventScroll","domSelection","getSelection","rangeCount","removeAllRanges","deselect","targetEl","editable","editorEl","parentElement","message","closest","isContentEditable","data","insertData","setFragmentData","findKey","domPoint","querySelectorAll","textContent","attr","domAnchor","toDOMPoint","domFocus","domRange","createRange","startNode","startOffset","endNode","endOffset","isStartAtZeroWidth","isEndAtZeroWidth","setStart","setEnd","domEl","hasAttribute","nativeEvent","clientX","clientY","toSlateNode","findPath","rect","isPrev","caretRangeFromPoint","caretPositionFromPoint","offsetNode","toSlateRange","nearestNode","nearestOffset","normalizeDOMPoint","textNode","leafNode","contents","cloneContents","removeChild","querySelector","slateNode","anchorNode","anchorOffset","focusNode","focusOffset","Selection","startContainer","endContainer","collapsed","toSlatePoint","FocusedContext","EditorContext","useEditor","SlateContext","useSlate","context","Slate","setKey","onContextChange","createElement","Provider","ReadOnlyContext","SelectedContext","withReact","toDOMRange","attach","trim","cloneRange","setEndAfter","zw","isNewline","whiteSpace","appendChild","encoded","btoa","encodeURIComponent","setAttribute","setData","div","innerHTML","getData","decoded","decodeURIComponent","atob","parsed","parse","lines","line","unstable_batchedUpdates","ZeroWidthString","TextString","isTrailing","isLineBreak","MemoizedLeaf","memo","renderLeaf","DefaultLeaf","Fragment","contentEditable","pointerEvents","verticalAlign","maxWidth","opacity","userSelect","fontStyle","fontWeight","textDecoration","placeholder","attributes","useIsomorphicLayoutEffect","MemoizedText","MemoizedElement","decorate","renderElement","DefaultElement","readOnly","Children","Tag","color","outline","isRangeListEqual","isLeafBlock","sel","ds","IS_APPLE","userAgent","MSStream","IS_FIREFOX","IS_SAFARI","IS_EDGE_LEGACY","HOTKEYS","bold","compose","moveBackward","moveForward","moveWordBackward","moveWordForward","extendBackward","extendForward","italic","splitBlock","undo","APPLE_HOTKEYS","moveLineBackward","moveLineForward","deleteLineBackward","deleteLineForward","deleteWordBackward","deleteWordForward","extendLineBackward","extendLineForward","redo","transposeCharacter","WINDOWS_HOTKEYS","generic","apple","isGeneric","isApple","isWindows","Hotkeys","isBold","isCompose","isMoveBackward","isMoveForward","isDeleteBackward","isDeleteForward","isDeleteLineBackward","isDeleteLineForward","isDeleteWordBackward","isDeleteWordForward","isExtendBackward","isExtendForward","isExtendLineBackward","isExtendLineForward","isItalic","isMoveLineBackward","isMoveLineForward","isMoveWordBackward","isMoveWordForward","isRedo","isSplitBlock","isTransposeCharacter","isUndo","HAS_BEFORE_INPUT_SUPPORT","Editable","autoFocus","defaultDecorate","onDOMBeforeInput","propsOnDOMBeforeInput","Component","isComposing","isUpdatingSelection","latestElement","hasDomSelection","editorElement","hasDomSelectionInEditor","newDomRange","addRange","leafEl","hasEditableTarget","isDOMEventHandled","inputType","dataTransfer","preventDefault","startsWith","targetRange","getTargetRanges","DataTransfer","addEventListener","removeEventListener","onDOMSelectionChange","anchorNodeSelectable","isTargetInsideVoid","focusNodeSelectable","role","spellCheck","autoCorrect","autoCapitalize","suppressContentEditableWarning","wordWrap","onBeforeInput","isEventHandled","onBlur","relatedTarget","hasDOMNode","onClick","hasTarget","_start","onCompositionEnd","onCompositionStart","clipboardData","onCut","onDragOver","onDragStart","onDrop","files","findEventRange","onFocus","onKeyDown","move","collapse","onPaste","types","isPlainTextOnlyPaste","handler","isDefaultPrevented","isPropagationStopped","defaultPrevented","funcs","arg","reduceRight","composed","flow","reduce","iteratee","collection","createPlugin","configs","ToolbarButton","renderCustom","handleMessage","enhanceEditor","withId","useForceUpdate","useRef","useState","curr","setCurr","isForceUpdated","forceUpdate","isMarkActive","format","toggleMark","renderDefaultLeaf","makeRenderLeaf","mark","CustomLeaf","BULLETED_LIST","NUMBERED_LIST","H1","isBlockActive","isList","React","forwardRef","margin","lineHeight","HeadingElement","renderDefaultElement","makeRenderElement","CustomElement","addMessageListener","callback","listener","postMessage","ReactNativeWebView","styles","toolbar","flexDirection","button","alignItems","justifyContent","minWidth","padding","border","background","borderRadius","buttonActive","separator","Toolbar","Button","active","Separator","svgIcons","format_bold","format_italic","format_underlined","format_list_bulleted","format_list_numbered","format_h1","icon","Icon","src","onMouseDown","groupMethod","console","log","groupEnd","isActive","unwrapNodes","wrapNodes","removeEditorChangeListener","wordBefore","beforeRange","beforeText","beforeMatch","afterRange","afterMatch","search","removeMentionApplyListener","mention","MentionListWrapper","renderMentionList","setSearch","setTarget","useEffect","removeMentionSearchListener","wrapperEl","rangeRect","editorRect","boxSizing","zIndex","isDefined","EditorPlaceholder","cache","createPlaceholder","useCallback","content","mergedStyle","getUrl","url","href","isUrl","jsonViewer","JsonViewer","plainSerializer","isRoot","makeReactTransformer","rules","reactTransformer","defaultReactTransformer","underline","minHeight","editorWrapper","fontFamily","editableWrapper","getToolbarButtons","HeroEditor","showToolbar","plugins","onLayout","wrapperStyle","editableStyle","wrapperLayout","useMemo","plugin","composeRenderLeaf","composeRenderElement","getCustomElements","toolBarButtons","removeHandlers","addMessageListeners","removeHandler","className"],"mappings":"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","file":"lib.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"react\"), require(\"react-dom\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"react\", \"react-dom\"], factory);\n\telse {\n\t\tvar a = typeof exports === 'object' ? factory(require(\"react\"), require(\"react-dom\")) : factory(root[\"React\"], root[\"ReactDOM\"]);\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function(__WEBPACK_EXTERNAL_MODULE__0__, __WEBPACK_EXTERNAL_MODULE__10__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 23);\n","module.exports = __WEBPACK_EXTERNAL_MODULE__0__;","// Should be no imports here!\nvar _a; // SOme things that should be evaluated before all else...\n\n\nvar hasSymbol = typeof Symbol !== \"undefined\";\nvar hasMap = typeof Map !== \"undefined\";\nvar hasSet = typeof Set !== \"undefined\";\n/**\r\n * The sentinel value returned by producers to replace the draft with undefined.\r\n */\n\nvar NOTHING = hasSymbol ? Symbol(\"immer-nothing\") : (_a = {}, _a[\"immer-nothing\"] = true, _a);\n/**\r\n * To let Immer treat your class instances as plain immutable objects\r\n * (albeit with a custom prototype), you must define either an instance property\r\n * or a static property on each of your custom classes.\r\n *\r\n * Otherwise, your class instance will never be drafted, which means it won't be\r\n * safe to mutate in a produce callback.\r\n */\n\nvar DRAFTABLE = hasSymbol ? Symbol(\"immer-draftable\") : \"__$immer_draftable\";\nvar DRAFT_STATE = hasSymbol ? Symbol(\"immer-state\") : \"__$immer_state\";\nvar iteratorSymbol = hasSymbol ? Symbol.iterator : \"@@iterator\";\n\n/* istanbul ignore next */\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) { if (b.hasOwnProperty(p)) { d[p] = b[p]; } }\n  };\n\n  return extendStatics(d, b);\n}; // Ugly hack to resolve #502 and inherit built in Map / Set\n\n\nfunction __extends(d, b) {\n  extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = ( // @ts-ignore\n  __.prototype = b.prototype, new __());\n}\n\nvar Archtype;\n\n(function (Archtype) {\n  Archtype[Archtype[\"Object\"] = 0] = \"Object\";\n  Archtype[Archtype[\"Array\"] = 1] = \"Array\";\n  Archtype[Archtype[\"Map\"] = 2] = \"Map\";\n  Archtype[Archtype[\"Set\"] = 3] = \"Set\";\n})(Archtype || (Archtype = {}));\n\nvar ProxyType;\n\n(function (ProxyType) {\n  ProxyType[ProxyType[\"ProxyObject\"] = 0] = \"ProxyObject\";\n  ProxyType[ProxyType[\"ProxyArray\"] = 1] = \"ProxyArray\";\n  ProxyType[ProxyType[\"ES5Object\"] = 2] = \"ES5Object\";\n  ProxyType[ProxyType[\"ES5Array\"] = 3] = \"ES5Array\";\n  ProxyType[ProxyType[\"Map\"] = 4] = \"Map\";\n  ProxyType[ProxyType[\"Set\"] = 5] = \"Set\";\n})(ProxyType || (ProxyType = {}));\n\n/** Returns true if the given value is an Immer draft */\n\nfunction isDraft(value) {\n  return !!value && !!value[DRAFT_STATE];\n}\n/** Returns true if the given value can be drafted by Immer */\n\nfunction isDraftable(value) {\n  if (!value) { return false; }\n  return isPlainObject(value) || Array.isArray(value) || !!value[DRAFTABLE] || !!value.constructor[DRAFTABLE] || isMap(value) || isSet(value);\n}\nfunction isPlainObject(value) {\n  if (!value || typeof value !== \"object\") { return false; }\n  var proto = Object.getPrototypeOf(value);\n  return !proto || proto === Object.prototype;\n}\nfunction original(value) {\n  if (value && value[DRAFT_STATE]) {\n    return value[DRAFT_STATE].base;\n  } // otherwise return undefined\n\n}\nvar ownKeys = typeof Reflect !== \"undefined\" && Reflect.ownKeys ? Reflect.ownKeys : typeof Object.getOwnPropertySymbols !== \"undefined\" ? function (obj) {\n  return Object.getOwnPropertyNames(obj).concat(Object.getOwnPropertySymbols(obj));\n} :\n/* istanbul ignore next */\nObject.getOwnPropertyNames;\nfunction each(obj, iter) {\n  if (getArchtype(obj) === Archtype.Object) {\n    ownKeys(obj).forEach(function (key) {\n      return iter(key, obj[key], obj);\n    });\n  } else {\n    obj.forEach(function (entry, index) {\n      return iter(index, entry, obj);\n    });\n  }\n}\nfunction isEnumerable(base, prop) {\n  var desc = Object.getOwnPropertyDescriptor(base, prop);\n  return desc && desc.enumerable ? true : false;\n}\nfunction getArchtype(thing) {\n  /* istanbul ignore next */\n  if (!thing) { die(); }\n\n  if (thing[DRAFT_STATE]) {\n    switch (thing[DRAFT_STATE].type) {\n      case ProxyType.ES5Object:\n      case ProxyType.ProxyObject:\n        return Archtype.Object;\n\n      case ProxyType.ES5Array:\n      case ProxyType.ProxyArray:\n        return Archtype.Array;\n\n      case ProxyType.Map:\n        return Archtype.Map;\n\n      case ProxyType.Set:\n        return Archtype.Set;\n    }\n  }\n\n  return Array.isArray(thing) ? Archtype.Array : isMap(thing) ? Archtype.Map : isSet(thing) ? Archtype.Set : Archtype.Object;\n}\nfunction has(thing, prop) {\n  return getArchtype(thing) === Archtype.Map ? thing.has(prop) : Object.prototype.hasOwnProperty.call(thing, prop);\n}\nfunction get(thing, prop) {\n  // @ts-ignore\n  return getArchtype(thing) === Archtype.Map ? thing.get(prop) : thing[prop];\n}\nfunction set(thing, propOrOldValue, value) {\n  switch (getArchtype(thing)) {\n    case Archtype.Map:\n      thing.set(propOrOldValue, value);\n      break;\n\n    case Archtype.Set:\n      thing.delete(propOrOldValue);\n      thing.add(value);\n      break;\n\n    default:\n      thing[propOrOldValue] = value;\n  }\n}\nfunction is(x, y) {\n  // From: https://github.com/facebook/fbjs/blob/c69904a511b900266935168223063dd8772dfc40/packages/fbjs/src/core/shallowEqual.js\n  if (x === y) {\n    return x !== 0 || 1 / x === 1 / y;\n  } else {\n    return x !== x && y !== y;\n  }\n}\nfunction isMap(target) {\n  return hasMap && target instanceof Map;\n}\nfunction isSet(target) {\n  return hasSet && target instanceof Set;\n}\nfunction latest(state) {\n  return state.copy || state.base;\n}\nfunction shallowCopy(base, invokeGetters) {\n  if (invokeGetters === void 0) {\n    invokeGetters = false;\n  }\n\n  if (Array.isArray(base)) { return base.slice(); }\n  var clone = Object.create(Object.getPrototypeOf(base));\n  ownKeys(base).forEach(function (key) {\n    if (key === DRAFT_STATE) {\n      return; // Never copy over draft state.\n    }\n\n    var desc = Object.getOwnPropertyDescriptor(base, key);\n    var value = desc.value;\n\n    if (desc.get) {\n      if (!invokeGetters) {\n        throw new Error(\"Immer drafts cannot have computed properties\");\n      }\n\n      value = desc.get.call(base);\n    }\n\n    if (desc.enumerable) {\n      clone[key] = value;\n    } else {\n      Object.defineProperty(clone, key, {\n        value: value,\n        writable: true,\n        configurable: true\n      });\n    }\n  });\n  return clone;\n}\nfunction freeze(obj, deep) {\n  if (!isDraftable(obj) || isDraft(obj) || Object.isFrozen(obj)) { return; }\n  var type = getArchtype(obj);\n\n  if (type === Archtype.Set) {\n    obj.add = obj.clear = obj.delete = dontMutateFrozenCollections;\n  } else if (type === Archtype.Map) {\n    obj.set = obj.clear = obj.delete = dontMutateFrozenCollections;\n  }\n\n  Object.freeze(obj);\n  if (deep) { each(obj, function (_, value) {\n    return freeze(value, true);\n  }); }\n}\n\nfunction dontMutateFrozenCollections() {\n  throw new Error(\"This object has been frozen and should not be mutated\");\n}\n\nfunction createHiddenProperty(target, prop, value) {\n  Object.defineProperty(target, prop, {\n    value: value,\n    enumerable: false,\n    writable: true\n  });\n}\n/* istanbul ignore next */\n\nfunction die() {\n  throw new Error(\"Illegal state, please file a bug\");\n}\n\n/** Each scope represents a `produce` call. */\n\nvar ImmerScope =\n/** @class */\nfunction () {\n  function ImmerScope(parent, immer) {\n    this.drafts = [];\n    this.parent = parent;\n    this.immer = immer; // Whenever the modified draft contains a draft from another scope, we\n    // need to prevent auto-freezing so the unowned draft can be finalized.\n\n    this.canAutoFreeze = true;\n  }\n\n  ImmerScope.prototype.usePatches = function (patchListener) {\n    if (patchListener) {\n      this.patches = [];\n      this.inversePatches = [];\n      this.patchListener = patchListener;\n    }\n  };\n\n  ImmerScope.prototype.revoke = function () {\n    this.leave();\n    this.drafts.forEach(revoke); // @ts-ignore\n\n    this.drafts = null;\n  };\n\n  ImmerScope.prototype.leave = function () {\n    if (this === ImmerScope.current) {\n      ImmerScope.current = this.parent;\n    }\n  };\n\n  ImmerScope.enter = function (immer) {\n    var scope = new ImmerScope(ImmerScope.current, immer);\n    ImmerScope.current = scope;\n    return scope;\n  };\n\n  return ImmerScope;\n}();\n\nfunction revoke(draft) {\n  var state = draft[DRAFT_STATE];\n  if (state.type === ProxyType.ProxyObject || state.type === ProxyType.ProxyArray) { state.revoke(); }else { state.revoked = true; }\n}\n\nfunction processResult(immer, result, scope) {\n  var baseDraft = scope.drafts[0];\n  var isReplaced = result !== undefined && result !== baseDraft;\n  immer.willFinalize(scope, result, isReplaced);\n\n  if (isReplaced) {\n    if (baseDraft[DRAFT_STATE].modified) {\n      scope.revoke();\n      throw new Error(\"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.\"); // prettier-ignore\n    }\n\n    if (isDraftable(result)) {\n      // Finalize the result in case it contains (or is) a subset of the draft.\n      result = finalize(immer, result, scope);\n      if (!scope.parent) { maybeFreeze(immer, result); }\n    }\n\n    if (scope.patches) {\n      scope.patches.push({\n        op: \"replace\",\n        path: [],\n        value: result\n      });\n      scope.inversePatches.push({\n        op: \"replace\",\n        path: [],\n        value: baseDraft[DRAFT_STATE].base\n      });\n    }\n  } else {\n    // Finalize the base draft.\n    result = finalize(immer, baseDraft, scope, []);\n  }\n\n  scope.revoke();\n\n  if (scope.patches) {\n    scope.patchListener(scope.patches, scope.inversePatches);\n  }\n\n  return result !== NOTHING ? result : undefined;\n}\n\nfunction finalize(immer, draft, scope, path) {\n  var state = draft[DRAFT_STATE];\n\n  if (!state) {\n    if (Object.isFrozen(draft)) { return draft; }\n    return finalizeTree(immer, draft, scope);\n  } // Never finalize drafts owned by another scope.\n\n\n  if (state.scope !== scope) {\n    return draft;\n  }\n\n  if (!state.modified) {\n    maybeFreeze(immer, state.base, true);\n    return state.base;\n  }\n\n  if (!state.finalized) {\n    state.finalized = true;\n    finalizeTree(immer, state.draft, scope, path); // We cannot really delete anything inside of a Set. We can only replace the whole Set.\n\n    if (immer.onDelete && state.type !== ProxyType.Set) {\n      // The `assigned` object is unreliable with ES5 drafts.\n      if (immer.useProxies) {\n        var assigned = state.assigned;\n        each(assigned, function (prop, exists) {\n          if (!exists) { immer.onDelete(state, prop); }\n        });\n      } else {\n        var base = state.base,\n            copy_1 = state.copy;\n        each(base, function (prop) {\n          if (!has(copy_1, prop)) { immer.onDelete(state, prop); }\n        });\n      }\n    }\n\n    if (immer.onCopy) {\n      immer.onCopy(state);\n    } // At this point, all descendants of `state.copy` have been finalized,\n    // so we can be sure that `scope.canAutoFreeze` is accurate.\n\n\n    if (immer.autoFreeze && scope.canAutoFreeze) {\n      freeze(state.copy, false);\n    }\n\n    if (path && scope.patches) {\n      generatePatches(state, path, scope.patches, scope.inversePatches);\n    }\n  }\n\n  return state.copy;\n}\n\nfunction finalizeTree(immer, root, scope, rootPath) {\n  var state = root[DRAFT_STATE];\n\n  if (state) {\n    if (state.type === ProxyType.ES5Object || state.type === ProxyType.ES5Array) {\n      // Create the final copy, with added keys and without deleted keys.\n      state.copy = shallowCopy(state.draft, true);\n    }\n\n    root = state.copy;\n  }\n\n  each(root, function (key, value) {\n    return finalizeProperty(immer, scope, root, state, root, key, value, rootPath);\n  });\n  return root;\n}\n\nfunction finalizeProperty(immer, scope, root, rootState, parentValue, prop, childValue, rootPath) {\n  if (childValue === parentValue) {\n    throw Error(\"Immer forbids circular references\");\n  } // In the `finalizeTree` method, only the `root` object may be a draft.\n\n\n  var isDraftProp = !!rootState && parentValue === root;\n  var isSetMember = isSet(parentValue);\n\n  if (isDraft(childValue)) {\n    var path = rootPath && isDraftProp && !isSetMember && // Set objects are atomic since they have no keys.\n    !has(rootState.assigned, prop) // Skip deep patches for assigned keys.\n    ? rootPath.concat(prop) : undefined; // Drafts owned by `scope` are finalized here.\n\n    childValue = finalize(immer, childValue, scope, path);\n    set(parentValue, prop, childValue); // Drafts from another scope must prevent auto-freezing.\n\n    if (isDraft(childValue)) {\n      scope.canAutoFreeze = false;\n    }\n  } // Unchanged draft properties are ignored.\n  else if (isDraftProp && is(childValue, get(rootState.base, prop))) {\n      return;\n    } // Search new objects for unfinalized drafts. Frozen objects should never contain drafts.\n    // TODO: the recursion over here looks weird, shouldn't non-draft stuff have it's own recursion?\n    // especially the passing on of root and rootState doesn't make sense...\n    else if (isDraftable(childValue)) {\n        each(childValue, function (key, grandChild) {\n          return finalizeProperty(immer, scope, root, rootState, childValue, key, grandChild, rootPath);\n        });\n        if (!scope.parent) { maybeFreeze(immer, childValue); }\n      }\n\n  if (isDraftProp && immer.onAssign && !isSetMember) {\n    immer.onAssign(rootState, prop, childValue);\n  }\n}\n\nfunction maybeFreeze(immer, value, deep) {\n  if (deep === void 0) {\n    deep = false;\n  }\n\n  if (immer.autoFreeze && !isDraft(value)) {\n    freeze(value, deep);\n  }\n}\n\n/**\r\n * Returns a new draft of the `base` object.\r\n *\r\n * The second argument is the parent draft-state (used internally).\r\n */\n\nfunction createProxy(base, parent) {\n  var isArray = Array.isArray(base);\n  var state = {\n    type: isArray ? ProxyType.ProxyArray : ProxyType.ProxyObject,\n    // Track which produce call this is associated with.\n    scope: parent ? parent.scope : ImmerScope.current,\n    // True for both shallow and deep changes.\n    modified: false,\n    // Used during finalization.\n    finalized: false,\n    // Track which properties have been assigned (true) or deleted (false).\n    assigned: {},\n    // The parent draft state.\n    parent: parent,\n    // The base state.\n    base: base,\n    // The base proxy.\n    draft: null,\n    // Any property proxies.\n    drafts: {},\n    // The base copy with any updated values.\n    copy: null,\n    // Called by the `produce` function.\n    revoke: null,\n    isManual: false\n  }; // the traps must target something, a bit like the 'real' base.\n  // but also, we need to be able to determine from the target what the relevant state is\n  // (to avoid creating traps per instance to capture the state in closure,\n  // and to avoid creating weird hidden properties as well)\n  // So the trick is to use 'state' as the actual 'target'! (and make sure we intercept everything)\n  // Note that in the case of an array, we put the state in an array to have better Reflect defaults ootb\n\n  var target = state;\n  var traps = objectTraps;\n\n  if (isArray) {\n    target = [state];\n    traps = arrayTraps;\n  } // TODO: optimization: might be faster, cheaper if we created a non-revocable proxy\n  // and administrate revoking ourselves\n\n\n  var _a = Proxy.revocable(target, traps),\n      revoke = _a.revoke,\n      proxy = _a.proxy;\n\n  state.draft = proxy;\n  state.revoke = revoke;\n  return proxy;\n}\n/**\r\n * Object drafts\r\n */\n\nvar objectTraps = {\n  get: function (state, prop) {\n    if (prop === DRAFT_STATE) { return state; }\n    var drafts = state.drafts; // Check for existing draft in unmodified state.\n\n    if (!state.modified && has(drafts, prop)) {\n      return drafts[prop];\n    }\n\n    var value = latest(state)[prop];\n\n    if (state.finalized || !isDraftable(value)) {\n      return value;\n    } // Check for existing draft in modified state.\n\n\n    if (state.modified) {\n      // Assigned values are never drafted. This catches any drafts we created, too.\n      if (value !== peek(state.base, prop)) { return value; } // Store drafts on the copy (when one exists).\n      // @ts-ignore\n\n      drafts = state.copy;\n    }\n\n    return drafts[prop] = state.scope.immer.createProxy(value, state);\n  },\n  has: function (state, prop) {\n    return prop in latest(state);\n  },\n  ownKeys: function (state) {\n    return Reflect.ownKeys(latest(state));\n  },\n  set: function (state, prop\n  /* strictly not, but helps TS */\n  , value) {\n    if (!state.modified) {\n      var baseValue = peek(state.base, prop); // Optimize based on value's truthiness. Truthy values are guaranteed to\n      // never be undefined, so we can avoid the `in` operator. Lastly, truthy\n      // values may be drafts, but falsy values are never drafts.\n\n      var isUnchanged = value ? is(baseValue, value) || value === state.drafts[prop] : is(baseValue, value) && prop in state.base;\n      if (isUnchanged) { return true; }\n      prepareCopy(state);\n      markChanged(state);\n    }\n\n    state.assigned[prop] = true; // @ts-ignore\n\n    state.copy[prop] = value;\n    return true;\n  },\n  deleteProperty: function (state, prop) {\n    // The `undefined` check is a fast path for pre-existing keys.\n    if (peek(state.base, prop) !== undefined || prop in state.base) {\n      state.assigned[prop] = false;\n      prepareCopy(state);\n      markChanged(state);\n    } else if (state.assigned[prop]) {\n      // if an originally not assigned property was deleted\n      delete state.assigned[prop];\n    } // @ts-ignore\n\n\n    if (state.copy) { delete state.copy[prop]; }\n    return true;\n  },\n  // Note: We never coerce `desc.value` into an Immer draft, because we can't make\n  // the same guarantee in ES5 mode.\n  getOwnPropertyDescriptor: function (state, prop) {\n    var owner = latest(state);\n    var desc = Reflect.getOwnPropertyDescriptor(owner, prop);\n\n    if (desc) {\n      desc.writable = true;\n      desc.configurable = state.type !== ProxyType.ProxyArray || prop !== \"length\";\n    }\n\n    return desc;\n  },\n  defineProperty: function () {\n    throw new Error(\"Object.defineProperty() cannot be used on an Immer draft\"); // prettier-ignore\n  },\n  getPrototypeOf: function (state) {\n    return Object.getPrototypeOf(state.base);\n  },\n  setPrototypeOf: function () {\n    throw new Error(\"Object.setPrototypeOf() cannot be used on an Immer draft\"); // prettier-ignore\n  }\n};\n/**\r\n * Array drafts\r\n */\n\nvar arrayTraps = {};\neach(objectTraps, function (key, fn) {\n  // @ts-ignore\n  arrayTraps[key] = function () {\n    arguments[0] = arguments[0][0];\n    return fn.apply(this, arguments);\n  };\n});\n\narrayTraps.deleteProperty = function (state, prop) {\n  if (isNaN(parseInt(prop))) {\n    throw new Error(\"Immer only supports deleting array indices\"); // prettier-ignore\n  }\n\n  return objectTraps.deleteProperty.call(this, state[0], prop);\n};\n\narrayTraps.set = function (state, prop, value) {\n  if (prop !== \"length\" && isNaN(parseInt(prop))) {\n    throw new Error(\"Immer only supports setting array indices and the 'length' property\"); // prettier-ignore\n  }\n\n  return objectTraps.set.call(this, state[0], prop, value, state[0]);\n};\n/**\r\n * Map drafts\r\n */\n// Access a property without creating an Immer draft.\n\n\nfunction peek(draft, prop) {\n  var state = draft[DRAFT_STATE];\n  var desc = Reflect.getOwnPropertyDescriptor(state ? latest(state) : draft, prop);\n  return desc && desc.value;\n}\n\nfunction markChanged(state) {\n  if (!state.modified) {\n    state.modified = true;\n\n    if (state.type === ProxyType.ProxyObject || state.type === ProxyType.ProxyArray) {\n      var copy_1 = state.copy = shallowCopy(state.base);\n      each(state.drafts, function (key, value) {\n        // @ts-ignore\n        copy_1[key] = value;\n      });\n      state.drafts = undefined;\n    }\n\n    if (state.parent) {\n      markChanged(state.parent);\n    }\n  }\n}\n\nfunction prepareCopy(state) {\n  if (!state.copy) {\n    state.copy = shallowCopy(state.base);\n  }\n}\n\nfunction willFinalizeES5(scope, result, isReplaced) {\n  scope.drafts.forEach(function (draft) {\n    draft[DRAFT_STATE].finalizing = true;\n  });\n\n  if (!isReplaced) {\n    if (scope.patches) {\n      markChangesRecursively(scope.drafts[0]);\n    } // This is faster when we don't care about which attributes changed.\n\n\n    markChangesSweep(scope.drafts);\n  } // When a child draft is returned, look for changes.\n  else if (isDraft(result) && result[DRAFT_STATE].scope === scope) {\n      markChangesSweep(scope.drafts);\n    }\n}\nfunction createES5Proxy(base, parent) {\n  var isArray = Array.isArray(base);\n  var draft = clonePotentialDraft(base);\n  each(draft, function (prop) {\n    proxyProperty(draft, prop, isArray || isEnumerable(base, prop));\n  });\n  var state = {\n    type: isArray ? ProxyType.ES5Array : ProxyType.ES5Object,\n    scope: parent ? parent.scope : ImmerScope.current,\n    modified: false,\n    finalizing: false,\n    finalized: false,\n    assigned: {},\n    parent: parent,\n    base: base,\n    draft: draft,\n    copy: null,\n    revoked: false,\n    isManual: false\n  };\n  createHiddenProperty(draft, DRAFT_STATE, state);\n  return draft;\n} // Access a property without creating an Immer draft.\n\nfunction peek$1(draft, prop) {\n  var state = draft[DRAFT_STATE];\n\n  if (state && !state.finalizing) {\n    state.finalizing = true;\n    var value = draft[prop];\n    state.finalizing = false;\n    return value;\n  }\n\n  return draft[prop];\n}\n\nfunction get$1(state, prop) {\n  assertUnrevoked(state);\n  var value = peek$1(latest(state), prop);\n  if (state.finalizing) { return value; } // Create a draft if the value is unmodified.\n\n  if (value === peek$1(state.base, prop) && isDraftable(value)) {\n    prepareCopy$1(state); // @ts-ignore\n\n    return state.copy[prop] = state.scope.immer.createProxy(value, state);\n  }\n\n  return value;\n}\n\nfunction set$1(state, prop, value) {\n  assertUnrevoked(state);\n  state.assigned[prop] = true;\n\n  if (!state.modified) {\n    if (is(value, peek$1(latest(state), prop))) { return; }\n    markChangedES5(state);\n    prepareCopy$1(state);\n  } // @ts-ignore\n\n\n  state.copy[prop] = value;\n}\n\nfunction markChangedES5(state) {\n  if (!state.modified) {\n    state.modified = true;\n    if (state.parent) { markChangedES5(state.parent); }\n  }\n}\n\nfunction prepareCopy$1(state) {\n  if (!state.copy) { state.copy = clonePotentialDraft(state.base); }\n}\n\nfunction clonePotentialDraft(base) {\n  var state = base && base[DRAFT_STATE];\n\n  if (state) {\n    state.finalizing = true;\n    var draft = shallowCopy(state.draft, true);\n    state.finalizing = false;\n    return draft;\n  }\n\n  return shallowCopy(base);\n} // property descriptors are recycled to make sure we don't create a get and set closure per property,\n// but share them all instead\n\n\nvar descriptors = {};\n\nfunction proxyProperty(draft, prop, enumerable) {\n  var desc = descriptors[prop];\n\n  if (desc) {\n    desc.enumerable = enumerable;\n  } else {\n    descriptors[prop] = desc = {\n      configurable: true,\n      enumerable: enumerable,\n      get: function () {\n        return get$1(this[DRAFT_STATE], prop);\n      },\n      set: function (value) {\n        set$1(this[DRAFT_STATE], prop, value);\n      }\n    };\n  }\n\n  Object.defineProperty(draft, prop, desc);\n}\n\nfunction assertUnrevoked(state) {\n  if (state.revoked === true) { throw new Error(\"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? \" + JSON.stringify(latest(state))); }\n} // This looks expensive, but only proxies are visited, and only objects without known changes are scanned.\n\nfunction markChangesSweep(drafts) {\n  // The natural order of drafts in the `scope` array is based on when they\n  // were accessed. By processing drafts in reverse natural order, we have a\n  // better chance of processing leaf nodes first. When a leaf node is known to\n  // have changed, we can avoid any traversal of its ancestor nodes.\n  for (var i = drafts.length - 1; i >= 0; i--) {\n    var state = drafts[i][DRAFT_STATE];\n\n    if (!state.modified) {\n      switch (state.type) {\n        case ProxyType.ES5Array:\n          if (hasArrayChanges(state)) { markChangedES5(state); }\n          break;\n\n        case ProxyType.ES5Object:\n          if (hasObjectChanges(state)) { markChangedES5(state); }\n          break;\n      }\n    }\n  }\n}\n\nfunction markChangesRecursively(object) {\n  if (!object || typeof object !== \"object\") { return; }\n  var state = object[DRAFT_STATE];\n  if (!state) { return; }\n  var base = state.base,\n      draft = state.draft,\n      assigned = state.assigned,\n      type = state.type;\n\n  if (type === ProxyType.ES5Object) {\n    // Look for added keys.\n    // TODO: looks quite duplicate to hasObjectChanges,\n    // probably there is a faster way to detect changes, as sweep + recurse seems to do some\n    // unnecessary work.\n    // also: probably we can store the information we detect here, to speed up tree finalization!\n    each(draft, function (key) {\n      if (key === DRAFT_STATE) { return; } // The `undefined` check is a fast path for pre-existing keys.\n\n      if (base[key] === undefined && !has(base, key)) {\n        assigned[key] = true;\n        markChangedES5(state);\n      } else if (!assigned[key]) {\n        // Only untouched properties trigger recursion.\n        markChangesRecursively(draft[key]);\n      }\n    }); // Look for removed keys.\n\n    each(base, function (key) {\n      // The `undefined` check is a fast path for pre-existing keys.\n      if (draft[key] === undefined && !has(draft, key)) {\n        assigned[key] = false;\n        markChangedES5(state);\n      }\n    });\n  } else if (type === ProxyType.ES5Array) {\n    if (hasArrayChanges(state)) {\n      markChangedES5(state);\n      assigned.length = true;\n    }\n\n    if (draft.length < base.length) {\n      for (var i = draft.length; i < base.length; i++) { assigned[i] = false; }\n    } else {\n      for (var i = base.length; i < draft.length; i++) { assigned[i] = true; }\n    } // Minimum count is enough, the other parts has been processed.\n\n\n    var min = Math.min(draft.length, base.length);\n\n    for (var i = 0; i < min; i++) {\n      // Only untouched indices trigger recursion.\n      if (assigned[i] === undefined) { markChangesRecursively(draft[i]); }\n    }\n  }\n}\n\nfunction hasObjectChanges(state) {\n  var base = state.base,\n      draft = state.draft; // Search for added keys and changed keys. Start at the back, because\n  // non-numeric keys are ordered by time of definition on the object.\n\n  var keys = Object.keys(draft);\n\n  for (var i = keys.length - 1; i >= 0; i--) {\n    var key = keys[i];\n    var baseValue = base[key]; // The `undefined` check is a fast path for pre-existing keys.\n\n    if (baseValue === undefined && !has(base, key)) {\n      return true;\n    } // Once a base key is deleted, future changes go undetected, because its\n    // descriptor is erased. This branch detects any missed changes.\n    else {\n        var value = draft[key];\n        var state_1 = value && value[DRAFT_STATE];\n\n        if (state_1 ? state_1.base !== baseValue : !is(value, baseValue)) {\n          return true;\n        }\n      }\n  } // At this point, no keys were added or changed.\n  // Compare key count to determine if keys were deleted.\n\n\n  return keys.length !== Object.keys(base).length;\n}\n\nfunction hasArrayChanges(state) {\n  var draft = state.draft;\n  if (draft.length !== state.base.length) { return true; } // See #116\n  // If we first shorten the length, our array interceptors will be removed.\n  // If after that new items are added, result in the same original length,\n  // those last items will have no intercepting property.\n  // So if there is no own descriptor on the last position, we know that items were removed and added\n  // N.B.: splice, unshift, etc only shift values around, but not prop descriptors, so we only have to check\n  // the last one\n\n  var descriptor = Object.getOwnPropertyDescriptor(draft, draft.length - 1); // descriptor can be null, but only for newly created sparse arrays, eg. new Array(10)\n\n  if (descriptor && !descriptor.get) { return true; } // For all other cases, we don't have to compare, as they would have been picked up by the index setters\n\n  return false;\n}\n\nvar DraftMap = function (_super) {\n  if (!_super) {\n    /* istanbul ignore next */\n    throw new Error(\"Map is not polyfilled\");\n  }\n\n  __extends(DraftMap, _super); // Create class manually, cause #502\n\n\n  function DraftMap(target, parent) {\n    this[DRAFT_STATE] = {\n      type: ProxyType.Map,\n      parent: parent,\n      scope: parent ? parent.scope : ImmerScope.current,\n      modified: false,\n      finalized: false,\n      copy: undefined,\n      assigned: undefined,\n      base: target,\n      draft: this,\n      isManual: false,\n      revoked: false\n    };\n    return this;\n  }\n\n  var p = DraftMap.prototype; // TODO: smaller build size if we create a util for Object.defineProperty\n\n  Object.defineProperty(p, \"size\", {\n    get: function () {\n      return latest(this[DRAFT_STATE]).size;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  p.has = function (key) {\n    return latest(this[DRAFT_STATE]).has(key);\n  };\n\n  p.set = function (key, value) {\n    var state = this[DRAFT_STATE];\n    assertUnrevoked(state);\n\n    if (latest(state).get(key) !== value) {\n      prepareCopy$2(state);\n      state.scope.immer.markChanged(state);\n      state.assigned.set(key, true);\n      state.copy.set(key, value);\n      state.assigned.set(key, true);\n    }\n\n    return this;\n  };\n\n  p.delete = function (key) {\n    if (!this.has(key)) {\n      return false;\n    }\n\n    var state = this[DRAFT_STATE];\n    assertUnrevoked(state);\n    prepareCopy$2(state);\n    state.scope.immer.markChanged(state);\n    state.assigned.set(key, false);\n    state.copy.delete(key);\n    return true;\n  };\n\n  p.clear = function () {\n    var state = this[DRAFT_STATE];\n    assertUnrevoked(state);\n    prepareCopy$2(state);\n    state.scope.immer.markChanged(state);\n    state.assigned = new Map();\n    return state.copy.clear();\n  };\n\n  p.forEach = function (cb, thisArg) {\n    var _this = this;\n\n    var state = this[DRAFT_STATE];\n    latest(state).forEach(function (_value, key, _map) {\n      cb.call(thisArg, _this.get(key), key, _this);\n    });\n  };\n\n  p.get = function (key) {\n    var state = this[DRAFT_STATE];\n    assertUnrevoked(state);\n    var value = latest(state).get(key);\n\n    if (state.finalized || !isDraftable(value)) {\n      return value;\n    }\n\n    if (value !== state.base.get(key)) {\n      return value; // either already drafted or reassigned\n    } // despite what it looks, this creates a draft only once, see above condition\n\n\n    var draft = state.scope.immer.createProxy(value, state);\n    prepareCopy$2(state);\n    state.copy.set(key, draft);\n    return draft;\n  };\n\n  p.keys = function () {\n    return latest(this[DRAFT_STATE]).keys();\n  };\n\n  p.values = function () {\n    var _a;\n\n    var _this = this;\n\n    var iterator = this.keys();\n    return _a = {}, _a[iteratorSymbol] = function () {\n      return _this.values();\n    }, _a.next = function () {\n      var r = iterator.next();\n      /* istanbul ignore next */\n\n      if (r.done) { return r; }\n\n      var value = _this.get(r.value);\n\n      return {\n        done: false,\n        value: value\n      };\n    }, _a;\n  };\n\n  p.entries = function () {\n    var _a;\n\n    var _this = this;\n\n    var iterator = this.keys();\n    return _a = {}, _a[iteratorSymbol] = function () {\n      return _this.entries();\n    }, _a.next = function () {\n      var r = iterator.next();\n      /* istanbul ignore next */\n\n      if (r.done) { return r; }\n\n      var value = _this.get(r.value);\n\n      return {\n        done: false,\n        value: [r.value, value]\n      };\n    }, _a;\n  };\n\n  p[iteratorSymbol] = function () {\n    return this.entries();\n  };\n\n  return DraftMap;\n}(Map);\n\nfunction proxyMap(target, parent) {\n  // @ts-ignore\n  return new DraftMap(target, parent);\n}\n\nfunction prepareCopy$2(state) {\n  if (!state.copy) {\n    state.assigned = new Map();\n    state.copy = new Map(state.base);\n  }\n}\n\nvar DraftSet = function (_super) {\n  if (!_super) {\n    /* istanbul ignore next */\n    throw new Error(\"Set is not polyfilled\");\n  }\n\n  __extends(DraftSet, _super); // Create class manually, cause #502\n\n\n  function DraftSet(target, parent) {\n    this[DRAFT_STATE] = {\n      type: ProxyType.Set,\n      parent: parent,\n      scope: parent ? parent.scope : ImmerScope.current,\n      modified: false,\n      finalized: false,\n      copy: undefined,\n      base: target,\n      draft: this,\n      drafts: new Map(),\n      revoked: false,\n      isManual: false\n    };\n    return this;\n  }\n\n  var p = DraftSet.prototype;\n  Object.defineProperty(p, \"size\", {\n    get: function () {\n      return latest(this[DRAFT_STATE]).size;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  p.has = function (value) {\n    var state = this[DRAFT_STATE];\n    assertUnrevoked(state); // bit of trickery here, to be able to recognize both the value, and the draft of its value\n\n    if (!state.copy) {\n      return state.base.has(value);\n    }\n\n    if (state.copy.has(value)) { return true; }\n    if (state.drafts.has(value) && state.copy.has(state.drafts.get(value))) { return true; }\n    return false;\n  };\n\n  p.add = function (value) {\n    var state = this[DRAFT_STATE];\n    assertUnrevoked(state);\n\n    if (state.copy) {\n      state.copy.add(value);\n    } else if (!state.base.has(value)) {\n      prepareCopy$3(state);\n      state.scope.immer.markChanged(state);\n      state.copy.add(value);\n    }\n\n    return this;\n  };\n\n  p.delete = function (value) {\n    if (!this.has(value)) {\n      return false;\n    }\n\n    var state = this[DRAFT_STATE];\n    assertUnrevoked(state);\n    prepareCopy$3(state);\n    state.scope.immer.markChanged(state);\n    return state.copy.delete(value) || (state.drafts.has(value) ? state.copy.delete(state.drafts.get(value)) :\n    /* istanbul ignore next */\n    false);\n  };\n\n  p.clear = function () {\n    var state = this[DRAFT_STATE];\n    assertUnrevoked(state);\n    prepareCopy$3(state);\n    state.scope.immer.markChanged(state);\n    return state.copy.clear();\n  };\n\n  p.values = function () {\n    var state = this[DRAFT_STATE];\n    assertUnrevoked(state);\n    prepareCopy$3(state);\n    return state.copy.values();\n  };\n\n  p.entries = function entries() {\n    var state = this[DRAFT_STATE];\n    assertUnrevoked(state);\n    prepareCopy$3(state);\n    return state.copy.entries();\n  };\n\n  p.keys = function () {\n    return this.values();\n  };\n\n  p[iteratorSymbol] = function () {\n    return this.values();\n  };\n\n  p.forEach = function forEach(cb, thisArg) {\n    var iterator = this.values();\n    var result = iterator.next();\n\n    while (!result.done) {\n      cb.call(thisArg, result.value, result.value, this);\n      result = iterator.next();\n    }\n  };\n\n  return DraftSet;\n}(Set);\n\nfunction proxySet(target, parent) {\n  // @ts-ignore\n  return new DraftSet(target, parent);\n}\n\nfunction prepareCopy$3(state) {\n  if (!state.copy) {\n    // create drafts for all entries to preserve insertion order\n    state.copy = new Set();\n    state.base.forEach(function (value) {\n      if (isDraftable(value)) {\n        var draft = state.scope.immer.createProxy(value, state);\n        state.drafts.set(value, draft);\n        state.copy.add(draft);\n      } else {\n        state.copy.add(value);\n      }\n    });\n  }\n}\n\nfunction generatePatches(state, basePath, patches, inversePatches) {\n  switch (state.type) {\n    case ProxyType.ProxyObject:\n    case ProxyType.ES5Object:\n    case ProxyType.Map:\n      return generatePatchesFromAssigned(state, basePath, patches, inversePatches);\n\n    case ProxyType.ES5Array:\n    case ProxyType.ProxyArray:\n      return generateArrayPatches(state, basePath, patches, inversePatches);\n\n    case ProxyType.Set:\n      return generateSetPatches(state, basePath, patches, inversePatches);\n  }\n}\n\nfunction generateArrayPatches(state, basePath, patches, inversePatches) {\n  var _a, _b;\n\n  var base = state.base,\n      assigned = state.assigned,\n      copy = state.copy;\n  /* istanbul ignore next */\n\n  if (!copy) { die(); } // Reduce complexity by ensuring `base` is never longer.\n\n  if (copy.length < base.length) {\n    _a = [copy, base], base = _a[0], copy = _a[1];\n    _b = [inversePatches, patches], patches = _b[0], inversePatches = _b[1];\n  }\n\n  var delta = copy.length - base.length; // Find the first replaced index.\n\n  var start = 0;\n\n  while (base[start] === copy[start] && start < base.length) {\n    ++start;\n  } // Find the last replaced index. Search from the end to optimize splice patches.\n\n\n  var end = base.length;\n\n  while (end > start && base[end - 1] === copy[end + delta - 1]) {\n    --end;\n  } // Process replaced indices.\n\n\n  for (var i = start; i < end; ++i) {\n    if (assigned[i] && copy[i] !== base[i]) {\n      var path = basePath.concat([i]);\n      patches.push({\n        op: \"replace\",\n        path: path,\n        value: copy[i]\n      });\n      inversePatches.push({\n        op: \"replace\",\n        path: path,\n        value: base[i]\n      });\n    }\n  }\n\n  var replaceCount = patches.length; // Process added indices.\n\n  for (var i = end + delta - 1; i >= end; --i) {\n    var path = basePath.concat([i]);\n    patches[replaceCount + i - end] = {\n      op: \"add\",\n      path: path,\n      value: copy[i]\n    };\n    inversePatches.push({\n      op: \"remove\",\n      path: path\n    });\n  }\n} // This is used for both Map objects and normal objects.\n\n\nfunction generatePatchesFromAssigned(state, basePath, patches, inversePatches) {\n  var base = state.base,\n      copy = state.copy;\n  each(state.assigned, function (key, assignedValue) {\n    var origValue = get(base, key);\n    var value = get(copy, key);\n    var op = !assignedValue ? \"remove\" : has(base, key) ? \"replace\" : \"add\";\n    if (origValue === value && op === \"replace\") { return; }\n    var path = basePath.concat(key);\n    patches.push(op === \"remove\" ? {\n      op: op,\n      path: path\n    } : {\n      op: op,\n      path: path,\n      value: value\n    });\n    inversePatches.push(op === \"add\" ? {\n      op: \"remove\",\n      path: path\n    } : op === \"remove\" ? {\n      op: \"add\",\n      path: path,\n      value: origValue\n    } : {\n      op: \"replace\",\n      path: path,\n      value: origValue\n    });\n  });\n}\n\nfunction generateSetPatches(state, basePath, patches, inversePatches) {\n  var base = state.base,\n      copy = state.copy;\n  var i = 0;\n  base.forEach(function (value) {\n    if (!copy.has(value)) {\n      var path = basePath.concat([i]);\n      patches.push({\n        op: \"remove\",\n        path: path,\n        value: value\n      });\n      inversePatches.unshift({\n        op: \"add\",\n        path: path,\n        value: value\n      });\n    }\n\n    i++;\n  });\n  i = 0;\n  copy.forEach(function (value) {\n    if (!base.has(value)) {\n      var path = basePath.concat([i]);\n      patches.push({\n        op: \"add\",\n        path: path,\n        value: value\n      });\n      inversePatches.unshift({\n        op: \"remove\",\n        path: path,\n        value: value\n      });\n    }\n\n    i++;\n  });\n}\n\nfunction applyPatches(draft, patches) {\n  patches.forEach(function (patch) {\n    var path = patch.path,\n        op = patch.op;\n    /* istanbul ignore next */\n\n    if (!path.length) { die(); }\n    var base = draft;\n\n    for (var i = 0; i < path.length - 1; i++) {\n      base = get(base, path[i]);\n      if (!base || typeof base !== \"object\") { throw new Error(\"Cannot apply patch, path doesn't resolve: \" + path.join(\"/\")); } // prettier-ignore\n    }\n\n    var type = getArchtype(base);\n    var value = deepClonePatchValue(patch.value); // used to clone patch to ensure original patch is not modified, see #411\n\n    var key = path[path.length - 1];\n\n    switch (op) {\n      case \"replace\":\n        switch (type) {\n          case Archtype.Map:\n            return base.set(key, value);\n\n          /* istanbul ignore next */\n\n          case Archtype.Set:\n            throw new Error('Sets cannot have \"replace\" patches.');\n\n          default:\n            // if value is an object, then it's assigned by reference\n            // in the following add or remove ops, the value field inside the patch will also be modifyed\n            // so we use value from the cloned patch\n            // @ts-ignore\n            return base[key] = value;\n        }\n\n      case \"add\":\n        switch (type) {\n          case Archtype.Array:\n            return base.splice(key, 0, value);\n\n          case Archtype.Map:\n            return base.set(key, value);\n\n          case Archtype.Set:\n            return base.add(value);\n\n          default:\n            return base[key] = value;\n        }\n\n      case \"remove\":\n        switch (type) {\n          case Archtype.Array:\n            return base.splice(key, 1);\n\n          case Archtype.Map:\n            return base.delete(key);\n\n          case Archtype.Set:\n            return base.delete(patch.value);\n\n          default:\n            return delete base[key];\n        }\n\n      default:\n        throw new Error(\"Unsupported patch operation: \" + op);\n    }\n  });\n  return draft;\n}\n\nfunction deepClonePatchValue(obj) {\n  if (!obj || typeof obj !== \"object\") { return obj; }\n  if (Array.isArray(obj)) { return obj.map(deepClonePatchValue); }\n  if (isMap(obj)) { return new Map(Array.from(obj.entries()).map(function (_a) {\n    var k = _a[0],\n        v = _a[1];\n    return [k, deepClonePatchValue(v)];\n  })); }\n  if (isSet(obj)) { return new Set(Array.from(obj).map(deepClonePatchValue)); }\n  var cloned = Object.create(Object.getPrototypeOf(obj));\n\n  for (var key in obj) { cloned[key] = deepClonePatchValue(obj[key]); }\n\n  return cloned;\n}\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n\r\nfunction __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\n\n/* istanbul ignore next */\n\nfunction verifyMinified() {}\n\nvar configDefaults = {\n  useProxies: typeof Proxy !== \"undefined\" && typeof Proxy.revocable !== \"undefined\" && typeof Reflect !== \"undefined\",\n  autoFreeze: typeof process !== \"undefined\" ? process.env.NODE_ENV !== \"production\" :\n  /* istanbul ignore next */\n  verifyMinified.name === \"verifyMinified\",\n  onAssign: null,\n  onDelete: null,\n  onCopy: null\n};\n\nvar Immer =\n/** @class */\nfunction () {\n  function Immer(config) {\n    var _this = this;\n\n    this.useProxies = false;\n    this.autoFreeze = false;\n    each(configDefaults, function (key, value) {\n      var _a, _b; // @ts-ignore\n\n\n      _this[key] = (_b = (_a = config) === null || _a === void 0 ? void 0 : _a[key], _b !== null && _b !== void 0 ? _b : value);\n    });\n    this.setUseProxies(this.useProxies);\n    this.produce = this.produce.bind(this);\n    this.produceWithPatches = this.produceWithPatches.bind(this);\n  }\n  /**\r\n   * The `produce` function takes a value and a \"recipe function\" (whose\r\n   * return value often depends on the base state). The recipe function is\r\n   * free to mutate its first argument however it wants. All mutations are\r\n   * only ever applied to a __copy__ of the base state.\r\n   *\r\n   * Pass only a function to create a \"curried producer\" which relieves you\r\n   * from passing the recipe function every time.\r\n   *\r\n   * Only plain objects and arrays are made mutable. All other objects are\r\n   * considered uncopyable.\r\n   *\r\n   * Note: This function is __bound__ to its `Immer` instance.\r\n   *\r\n   * @param {any} base - the initial state\r\n   * @param {Function} producer - function that receives a proxy of the base state as first argument and which can be freely modified\r\n   * @param {Function} patchListener - optional function that will be called with all the patches produced here\r\n   * @returns {any} a new state, or the initial state if nothing was modified\r\n   */\n\n\n  Immer.prototype.produce = function (base, recipe, patchListener) {\n    var _this = this; // curried invocation\n\n\n    if (typeof base === \"function\" && typeof recipe !== \"function\") {\n      var defaultBase_1 = recipe;\n      recipe = base;\n      var self_1 = this;\n      return function curriedProduce(base) {\n        var arguments$1 = arguments;\n\n        var _this = this;\n\n        if (base === void 0) {\n          base = defaultBase_1;\n        }\n\n        var args = [];\n\n        for (var _i = 1; _i < arguments.length; _i++) {\n          args[_i - 1] = arguments$1[_i];\n        }\n\n        return self_1.produce(base, function (draft) {\n          return recipe.call.apply(recipe, __spreadArrays([_this, draft], args));\n        }); // prettier-ignore\n      };\n    } // prettier-ignore\n\n\n    {\n      if (typeof recipe !== \"function\") {\n        throw new Error(\"The first or second argument to `produce` must be a function\");\n      }\n\n      if (patchListener !== undefined && typeof patchListener !== \"function\") {\n        throw new Error(\"The third argument to `produce` must be a function or undefined\");\n      }\n    }\n    var result; // Only plain objects, arrays, and \"immerable classes\" are drafted.\n\n    if (isDraftable(base)) {\n      var scope_1 = ImmerScope.enter(this);\n      var proxy = this.createProxy(base, undefined);\n      var hasError = true;\n\n      try {\n        result = recipe(proxy);\n        hasError = false;\n      } finally {\n        // finally instead of catch + rethrow better preserves original stack\n        if (hasError) { scope_1.revoke(); }else { scope_1.leave(); }\n      }\n\n      if (typeof Promise !== \"undefined\" && result instanceof Promise) {\n        return result.then(function (result) {\n          scope_1.usePatches(patchListener);\n          return processResult(_this, result, scope_1);\n        }, function (error) {\n          scope_1.revoke();\n          throw error;\n        });\n      }\n\n      scope_1.usePatches(patchListener);\n      return processResult(this, result, scope_1);\n    } else {\n      result = recipe(base);\n      if (result === NOTHING) { return undefined; }\n      if (result === undefined) { result = base; }\n      maybeFreeze(this, result, true);\n      return result;\n    }\n  };\n\n  Immer.prototype.produceWithPatches = function (arg1, arg2, arg3) {\n    var _this = this;\n\n    if (typeof arg1 === \"function\") {\n      return function (state) {\n        var arguments$1 = arguments;\n\n        var args = [];\n\n        for (var _i = 1; _i < arguments.length; _i++) {\n          args[_i - 1] = arguments$1[_i];\n        }\n\n        return _this.produceWithPatches(state, function (draft) {\n          return arg1.apply(void 0, __spreadArrays([draft], args));\n        });\n      };\n    } // non-curried form\n\n    /* istanbul ignore next */\n\n\n    if (arg3) { die(); }\n    var patches, inversePatches;\n    var nextState = this.produce(arg1, arg2, function (p, ip) {\n      patches = p;\n      inversePatches = ip;\n    });\n    return [nextState, patches, inversePatches];\n  };\n\n  Immer.prototype.createDraft = function (base) {\n    if (!isDraftable(base)) {\n      throw new Error(\"First argument to `createDraft` must be a plain object, an array, or an immerable object\"); // prettier-ignore\n    }\n\n    var scope = ImmerScope.enter(this);\n    var proxy = this.createProxy(base, undefined);\n    proxy[DRAFT_STATE].isManual = true;\n    scope.leave();\n    return proxy;\n  };\n\n  Immer.prototype.finishDraft = function (draft, patchListener) {\n    var state = draft && draft[DRAFT_STATE];\n\n    if (!state || !state.isManual) {\n      throw new Error(\"First argument to `finishDraft` must be a draft returned by `createDraft`\"); // prettier-ignore\n    }\n\n    if (state.finalized) {\n      throw new Error(\"The given draft is already finalized\"); // prettier-ignore\n    }\n\n    var scope = state.scope;\n    scope.usePatches(patchListener);\n    return processResult(this, undefined, scope);\n  };\n  /**\r\n   * Pass true to automatically freeze all copies created by Immer.\r\n   *\r\n   * By default, auto-freezing is disabled in production.\r\n   */\n\n\n  Immer.prototype.setAutoFreeze = function (value) {\n    this.autoFreeze = value;\n  };\n  /**\r\n   * Pass true to use the ES2015 `Proxy` class when creating drafts, which is\r\n   * always faster than using ES5 proxies.\r\n   *\r\n   * By default, feature detection is used, so calling this is rarely necessary.\r\n   */\n\n\n  Immer.prototype.setUseProxies = function (value) {\n    this.useProxies = value;\n  };\n\n  Immer.prototype.applyPatches = function (base, patches) {\n    // If a patch replaces the entire state, take that replacement as base\n    // before applying patches\n    var i;\n\n    for (i = patches.length - 1; i >= 0; i--) {\n      var patch = patches[i];\n\n      if (patch.path.length === 0 && patch.op === \"replace\") {\n        base = patch.value;\n        break;\n      }\n    }\n\n    if (isDraft(base)) {\n      // N.B: never hits if some patch a replacement, patches are never drafts\n      return applyPatches(base, patches);\n    } // Otherwise, produce a copy of the base state.\n\n\n    return this.produce(base, function (draft) {\n      return applyPatches(draft, patches.slice(i + 1));\n    });\n  };\n\n  Immer.prototype.createProxy = function (value, parent) {\n    // precondition: createProxy should be guarded by isDraftable, so we know we can safely draft\n    var draft = isMap(value) ? proxyMap(value, parent) : isSet(value) ? proxySet(value, parent) : this.useProxies ? createProxy(value, parent) : createES5Proxy(value, parent);\n    var scope = parent ? parent.scope : ImmerScope.current;\n    scope.drafts.push(draft);\n    return draft;\n  };\n\n  Immer.prototype.willFinalize = function (scope, thing, isReplaced) {\n    if (!this.useProxies) { willFinalizeES5(scope, thing, isReplaced); }\n  };\n\n  Immer.prototype.markChanged = function (state) {\n    if (this.useProxies) {\n      markChanged(state);\n    } else {\n      markChangedES5(state);\n    }\n  };\n\n  return Immer;\n}();\n\nvar immer = new Immer();\n/**\r\n * The `produce` function takes a value and a \"recipe function\" (whose\r\n * return value often depends on the base state). The recipe function is\r\n * free to mutate its first argument however it wants. All mutations are\r\n * only ever applied to a __copy__ of the base state.\r\n *\r\n * Pass only a function to create a \"curried producer\" which relieves you\r\n * from passing the recipe function every time.\r\n *\r\n * Only plain objects and arrays are made mutable. All other objects are\r\n * considered uncopyable.\r\n *\r\n * Note: This function is __bound__ to its `Immer` instance.\r\n *\r\n * @param {any} base - the initial state\r\n * @param {Function} producer - function that receives a proxy of the base state as first argument and which can be freely modified\r\n * @param {Function} patchListener - optional function that will be called with all the patches produced here\r\n * @returns {any} a new state, or the initial state if nothing was modified\r\n */\n\nvar produce = immer.produce;\n/**\r\n * Like `produce`, but `produceWithPatches` always returns a tuple\r\n * [nextState, patches, inversePatches] (instead of just the next state)\r\n */\n\nvar produceWithPatches = immer.produceWithPatches.bind(immer);\n/**\r\n * Pass true to automatically freeze all copies created by Immer.\r\n *\r\n * By default, auto-freezing is disabled in production.\r\n */\n\nvar setAutoFreeze = immer.setAutoFreeze.bind(immer);\n/**\r\n * Pass true to use the ES2015 `Proxy` class when creating drafts, which is\r\n * always faster than using ES5 proxies.\r\n *\r\n * By default, feature detection is used, so calling this is rarely necessary.\r\n */\n\nvar setUseProxies = immer.setUseProxies.bind(immer);\n/**\r\n * Apply an array of Immer patches to the first argument.\r\n *\r\n * This function is a producer, which means copy-on-write is in effect.\r\n */\n\nvar applyPatches$1 = immer.applyPatches.bind(immer);\n/**\r\n * Create an Immer draft from the given base state, which may be a draft itself.\r\n * The draft can be modified until you finalize it with the `finishDraft` function.\r\n */\n\nvar createDraft = immer.createDraft.bind(immer);\n/**\r\n * Finalize an Immer draft from a `createDraft` call, returning the base state\r\n * (if no changes were made) or a modified copy. The draft must *not* be\r\n * mutated afterwards.\r\n *\r\n * Pass a function as the 2nd argument to generate Immer patches based on the\r\n * changes that were made.\r\n */\n\nvar finishDraft = immer.finishDraft.bind(immer);\n/**\r\n * This function is actually a no-op, but can be used to cast an immutable type\r\n * to an draft type and make TypeScript happy\r\n *\r\n * @param value\r\n */\n\nfunction castDraft(value) {\n  return value;\n}\n/**\r\n * This function is actually a no-op, but can be used to cast a mutable type\r\n * to an immutable type and make TypeScript happy\r\n * @param value\r\n */\n\nfunction castImmutable(value) {\n  return value;\n}\n\nexport default produce;\nexport { Immer, applyPatches$1 as applyPatches, castDraft, castImmutable, createDraft, finishDraft, DRAFTABLE as immerable, isDraft, isDraftable, NOTHING as nothing, original, produce, produceWithPatches, setAutoFreeze, setUseProxies };\n//# sourceMappingURL=immer.module.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\n/**\n * Constants.\n */\n\nvar IS_MAC = typeof window != 'undefined' && /Mac|iPod|iPhone|iPad/.test(window.navigator.platform);\n\nvar MODIFIERS = {\n  alt: 'altKey',\n  control: 'ctrlKey',\n  meta: 'metaKey',\n  shift: 'shiftKey'\n};\n\nvar ALIASES = {\n  add: '+',\n  break: 'pause',\n  cmd: 'meta',\n  command: 'meta',\n  ctl: 'control',\n  ctrl: 'control',\n  del: 'delete',\n  down: 'arrowdown',\n  esc: 'escape',\n  ins: 'insert',\n  left: 'arrowleft',\n  mod: IS_MAC ? 'meta' : 'control',\n  opt: 'alt',\n  option: 'alt',\n  return: 'enter',\n  right: 'arrowright',\n  space: ' ',\n  spacebar: ' ',\n  up: 'arrowup',\n  win: 'meta',\n  windows: 'meta'\n};\n\nvar CODES = {\n  backspace: 8,\n  tab: 9,\n  enter: 13,\n  shift: 16,\n  control: 17,\n  alt: 18,\n  pause: 19,\n  capslock: 20,\n  escape: 27,\n  ' ': 32,\n  pageup: 33,\n  pagedown: 34,\n  end: 35,\n  home: 36,\n  arrowleft: 37,\n  arrowup: 38,\n  arrowright: 39,\n  arrowdown: 40,\n  insert: 45,\n  delete: 46,\n  meta: 91,\n  numlock: 144,\n  scrolllock: 145,\n  ';': 186,\n  '=': 187,\n  ',': 188,\n  '-': 189,\n  '.': 190,\n  '/': 191,\n  '`': 192,\n  '[': 219,\n  '\\\\': 220,\n  ']': 221,\n  '\\'': 222\n};\n\nfor (var f = 1; f < 20; f++) {\n  CODES['f' + f] = 111 + f;\n}\n\n/**\n * Is hotkey?\n */\n\nfunction isHotkey(hotkey, options, event) {\n  if (options && !('byKey' in options)) {\n    event = options;\n    options = null;\n  }\n\n  if (!Array.isArray(hotkey)) {\n    hotkey = [hotkey];\n  }\n\n  var array = hotkey.map(function (string) {\n    return parseHotkey(string, options);\n  });\n  var check = function check(e) {\n    return array.some(function (object) {\n      return compareHotkey(object, e);\n    });\n  };\n  var ret = event == null ? check : check(event);\n  return ret;\n}\n\nfunction isCodeHotkey(hotkey, event) {\n  return isHotkey(hotkey, event);\n}\n\nfunction isKeyHotkey(hotkey, event) {\n  return isHotkey(hotkey, { byKey: true }, event);\n}\n\n/**\n * Parse.\n */\n\nfunction parseHotkey(hotkey, options) {\n  var byKey = options && options.byKey;\n  var ret = {};\n\n  // Special case to handle the `+` key since we use it as a separator.\n  hotkey = hotkey.replace('++', '+add');\n  var values = hotkey.split('+');\n  var length = values.length;\n\n  // Ensure that all the modifiers are set to false unless the hotkey has them.\n\n  for (var k in MODIFIERS) {\n    ret[MODIFIERS[k]] = false;\n  }\n\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = values[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var value = _step.value;\n\n      var optional = value.endsWith('?') && value.length > 1;\n\n      if (optional) {\n        value = value.slice(0, -1);\n      }\n\n      var name = toKeyName(value);\n      var modifier = MODIFIERS[name];\n\n      if (length === 1 || !modifier) {\n        if (byKey) {\n          ret.key = name;\n        } else {\n          ret.which = toKeyCode(value);\n        }\n      }\n\n      if (modifier) {\n        ret[modifier] = optional ? null : true;\n      }\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator.return) {\n        _iterator.return();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  return ret;\n}\n\n/**\n * Compare.\n */\n\nfunction compareHotkey(object, event) {\n  for (var key in object) {\n    var expected = object[key];\n    var actual = void 0;\n\n    if (expected == null) {\n      continue;\n    }\n\n    if (key === 'key' && event.key != null) {\n      actual = event.key.toLowerCase();\n    } else if (key === 'which') {\n      actual = expected === 91 && event.which === 93 ? 91 : event.which;\n    } else {\n      actual = event[key];\n    }\n\n    if (actual == null && expected === false) {\n      continue;\n    }\n\n    if (actual !== expected) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * Utils.\n */\n\nfunction toKeyCode(name) {\n  name = toKeyName(name);\n  var code = CODES[name] || name.toUpperCase().charCodeAt(0);\n  return code;\n}\n\nfunction toKeyName(name) {\n  name = name.toLowerCase();\n  name = ALIASES[name] || name;\n  return name;\n}\n\n/**\n * Export.\n */\n\nexports.default = isHotkey;\nexports.isHotkey = isHotkey;\nexports.isCodeHotkey = isCodeHotkey;\nexports.isKeyHotkey = isKeyHotkey;\nexports.parseHotkey = parseHotkey;\nexports.compareHotkey = compareHotkey;\nexports.toKeyCode = toKeyCode;\nexports.toKeyName = toKeyName;","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nmodule.exports = isObject;\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nmodule.exports = root;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nmodule.exports = Symbol;\n","/*! https://mths.be/esrever v0.2.0 by @mathias */\n;(function(root) {\n\n\t// Detect free variables `exports`\n\tvar freeExports = typeof exports == 'object' && exports;\n\n\t// Detect free variable `module`\n\tvar freeModule = typeof module == 'object' && module &&\n\t\tmodule.exports == freeExports && module;\n\n\t// Detect free variable `global`, from Node.js or Browserified code,\n\t// and use it as `root`\n\tvar freeGlobal = typeof global == 'object' && global;\n\tif (freeGlobal.global === freeGlobal || freeGlobal.window === freeGlobal) {\n\t\troot = freeGlobal;\n\t}\n\n\t/*--------------------------------------------------------------------------*/\n\n\tvar regexSymbolWithCombiningMarks = /([\\0-\\u02FF\\u0370-\\u1AAF\\u1B00-\\u1DBF\\u1E00-\\u20CF\\u2100-\\uD7FF\\uE000-\\uFE1F\\uFE30-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])([\\u0300-\\u036F\\u1AB0-\\u1AFF\\u1DC0-\\u1DFF\\u20D0-\\u20FF\\uFE20-\\uFE2F]+)/g;\n\tvar regexSurrogatePair = /([\\uD800-\\uDBFF])([\\uDC00-\\uDFFF])/g;\n\n\tvar reverse = function(string) {\n\t\t// Step 1: deal with combining marks and astral symbols (surrogate pairs)\n\t\tstring = string\n\t\t\t// Swap symbols with their combining marks so the combining marks go first\n\t\t\t.replace(regexSymbolWithCombiningMarks, function($0, $1, $2) {\n\t\t\t\t// Reverse the combining marks so they will end up in the same order\n\t\t\t\t// later on (after another round of reversing)\n\t\t\t\treturn reverse($2) + $1;\n\t\t\t})\n\t\t\t// Swap high and low surrogates so the low surrogates go first\n\t\t\t.replace(regexSurrogatePair, '$2$1');\n\t\t// Step 2: reverse the code units in the string\n\t\tvar result = '';\n\t\tvar index = string.length;\n\t\twhile (index--) {\n\t\t\tresult += string.charAt(index);\n\t\t}\n\t\treturn result;\n\t};\n\n\t/*--------------------------------------------------------------------------*/\n\n\tvar esrever = {\n\t\t'version': '0.2.0',\n\t\t'reverse': reverse\n\t};\n\n\t// Some AMD build optimizers, like r.js, check for specific condition patterns\n\t// like the following:\n\tif (\n\t\ttypeof define == 'function' &&\n\t\ttypeof define.amd == 'object' &&\n\t\tdefine.amd\n\t) {\n\t\tdefine(function() {\n\t\t\treturn esrever;\n\t\t});\n\t}\telse if (freeExports && !freeExports.nodeType) {\n\t\tif (freeModule) { // in Node.js, io.js, or RingoJS v0.8.0+\n\t\t\tfreeModule.exports = esrever;\n\t\t} else { // in Narwhal or RingoJS v0.7.0-\n\t\t\tfor (var key in esrever) {\n\t\t\t\tesrever.hasOwnProperty(key) && (freeExports[key] = esrever[key]);\n\t\t\t}\n\t\t}\n\t} else { // in Rhino or a web browser\n\t\troot.esrever = esrever;\n\t}\n\n}(this));\n","var debounce = require('./debounce'),\n    isObject = require('./isObject');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a throttled function that only invokes `func` at most once per\n * every `wait` milliseconds. The throttled function comes with a `cancel`\n * method to cancel delayed `func` invocations and a `flush` method to\n * immediately invoke them. Provide `options` to indicate whether `func`\n * should be invoked on the leading and/or trailing edge of the `wait`\n * timeout. The `func` is invoked with the last arguments provided to the\n * throttled function. Subsequent calls to the throttled function return the\n * result of the last `func` invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the throttled function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.throttle` and `_.debounce`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to throttle.\n * @param {number} [wait=0] The number of milliseconds to throttle invocations to.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=true]\n *  Specify invoking on the leading edge of the timeout.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new throttled function.\n * @example\n *\n * // Avoid excessively updating the position while scrolling.\n * jQuery(window).on('scroll', _.throttle(updatePosition, 100));\n *\n * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.\n * var throttled = _.throttle(renewToken, 300000, { 'trailing': false });\n * jQuery(element).on('click', throttled);\n *\n * // Cancel the trailing throttled invocation.\n * jQuery(window).on('popstate', throttled.cancel);\n */\nfunction throttle(func, wait, options) {\n  var leading = true,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  if (isObject(options)) {\n    leading = 'leading' in options ? !!options.leading : leading;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n  return debounce(func, wait, {\n    'leading': leading,\n    'maxWait': wait,\n    'trailing': trailing\n  });\n}\n\nmodule.exports = throttle;\n","'use strict'\n\nmodule.exports = direction\n\nvar RTL = '\\u0591-\\u07FF\\uFB1D-\\uFDFD\\uFE70-\\uFEFC'\nvar LTR =\n  'A-Za-z\\u00C0-\\u00D6\\u00D8-\\u00F6' +\n  '\\u00F8-\\u02B8\\u0300-\\u0590\\u0800-\\u1FFF\\u200E\\u2C00-\\uFB1C' +\n  '\\uFE00-\\uFE6F\\uFEFD-\\uFFFF'\n\nvar rtl = new RegExp('^[^' + LTR + ']*[' + RTL + ']')\nvar ltr = new RegExp('^[^' + RTL + ']*[' + LTR + ']')\n\nfunction direction(value) {\n  value = String(value || '')\n\n  if (rtl.test(value)) {\n    return 'rtl'\n  }\n\n  if (ltr.test(value)) {\n    return 'ltr'\n  }\n\n  return 'neutral'\n}\n","module.exports = __WEBPACK_EXTERNAL_MODULE__10__;","\n/**\n * Expose `isUrl`.\n */\n\nmodule.exports = isUrl;\n\n/**\n * RegExps.\n * A URL must match #1 and then at least one of #2/#3.\n * Use two levels of REs to avoid REDOS.\n */\n\nvar protocolAndDomainRE = /^(?:\\w+:)?\\/\\/(\\S+)$/;\n\nvar localhostDomainRE = /^localhost[\\:?\\d]*(?:[^\\:?\\d]\\S*)?$/\nvar nonLocalhostDomainRE = /^[^\\s\\.]+\\.\\S{2,}$/;\n\n/**\n * Loosely validate a URL `string`.\n *\n * @param {String} string\n * @return {Boolean}\n */\n\nfunction isUrl(string){\n  if (typeof string !== 'string') {\n    return false;\n  }\n\n  var match = string.match(protocolAndDomainRE);\n  if (!match) {\n    return false;\n  }\n\n  var everythingAfterProtocol = match[1];\n  if (!everythingAfterProtocol) {\n    return false;\n  }\n\n  if (localhostDomainRE.test(everythingAfterProtocol) ||\n      nonLocalhostDomainRE.test(everythingAfterProtocol)) {\n    return true;\n  }\n\n  return false;\n}\n","module.exports = function(module) {\n\tif (!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","var isObject = require('./isObject'),\n    now = require('./now'),\n    toNumber = require('./toNumber');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        timeWaiting = wait - timeSinceLastCall;\n\n    return maxing\n      ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n      : timeWaiting;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        clearTimeout(timerId);\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\nmodule.exports = debounce;\n","var root = require('./_root');\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\nmodule.exports = now;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nmodule.exports = freeGlobal;\n","var isObject = require('./isObject'),\n    isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = toNumber;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nmodule.exports = isSymbol;\n","var Symbol = require('./_Symbol'),\n    getRawTag = require('./_getRawTag'),\n    objectToString = require('./_objectToString');\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nmodule.exports = baseGetTag;\n","var Symbol = require('./_Symbol');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nmodule.exports = getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nmodule.exports = objectToString;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nmodule.exports = isObjectLike;\n","/*!\n * is-plain-object <https://github.com/jonschlinkert/is-plain-object>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\n\nimport isObject from 'isobject';\n\nfunction isObjectObject(o) {\n  return isObject(o) === true\n    && Object.prototype.toString.call(o) === '[object Object]';\n}\n\nexport default function isPlainObject(o) {\n  var ctor,prot;\n\n  if (isObjectObject(o) === false) return false;\n\n  // If has modified constructor\n  ctor = o.constructor;\n  if (typeof ctor !== 'function') return false;\n\n  // If has modified prototype\n  prot = ctor.prototype;\n  if (isObjectObject(prot) === false) return false;\n\n  // If constructor does not have an Object-specific method\n  if (prot.hasOwnProperty('isPrototypeOf') === false) {\n    return false;\n  }\n\n  // Most likely a plain Object\n  return true;\n};\n","/*!\n * isobject <https://github.com/jonschlinkert/isobject>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\n\nexport default function isObject(val) {\n  return val != null && typeof val === 'object' && Array.isArray(val) === false;\n};\n","import isPlainObject from 'is-plain-object';\nimport { createDraft, finishDraft, isDraft, produce } from 'immer';\nimport { reverse } from 'esrever';\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nvar DIRTY_PATHS = new WeakMap();\nvar FLUSHING = new WeakMap();\nvar NORMALIZING = new WeakMap();\nvar PATH_REFS = new WeakMap();\nvar POINT_REFS = new WeakMap();\nvar RANGE_REFS = new WeakMap();\n\n/**\r\n * Constants for string distance checking.\r\n */\nvar SPACE = /\\s/;\nvar PUNCTUATION = /[\\u0021-\\u0023\\u0025-\\u002A\\u002C-\\u002F\\u003A\\u003B\\u003F\\u0040\\u005B-\\u005D\\u005F\\u007B\\u007D\\u00A1\\u00A7\\u00AB\\u00B6\\u00B7\\u00BB\\u00BF\\u037E\\u0387\\u055A-\\u055F\\u0589\\u058A\\u05BE\\u05C0\\u05C3\\u05C6\\u05F3\\u05F4\\u0609\\u060A\\u060C\\u060D\\u061B\\u061E\\u061F\\u066A-\\u066D\\u06D4\\u0700-\\u070D\\u07F7-\\u07F9\\u0830-\\u083E\\u085E\\u0964\\u0965\\u0970\\u0AF0\\u0DF4\\u0E4F\\u0E5A\\u0E5B\\u0F04-\\u0F12\\u0F14\\u0F3A-\\u0F3D\\u0F85\\u0FD0-\\u0FD4\\u0FD9\\u0FDA\\u104A-\\u104F\\u10FB\\u1360-\\u1368\\u1400\\u166D\\u166E\\u169B\\u169C\\u16EB-\\u16ED\\u1735\\u1736\\u17D4-\\u17D6\\u17D8-\\u17DA\\u1800-\\u180A\\u1944\\u1945\\u1A1E\\u1A1F\\u1AA0-\\u1AA6\\u1AA8-\\u1AAD\\u1B5A-\\u1B60\\u1BFC-\\u1BFF\\u1C3B-\\u1C3F\\u1C7E\\u1C7F\\u1CC0-\\u1CC7\\u1CD3\\u2010-\\u2027\\u2030-\\u2043\\u2045-\\u2051\\u2053-\\u205E\\u207D\\u207E\\u208D\\u208E\\u2329\\u232A\\u2768-\\u2775\\u27C5\\u27C6\\u27E6-\\u27EF\\u2983-\\u2998\\u29D8-\\u29DB\\u29FC\\u29FD\\u2CF9-\\u2CFC\\u2CFE\\u2CFF\\u2D70\\u2E00-\\u2E2E\\u2E30-\\u2E3B\\u3001-\\u3003\\u3008-\\u3011\\u3014-\\u301F\\u3030\\u303D\\u30A0\\u30FB\\uA4FE\\uA4FF\\uA60D-\\uA60F\\uA673\\uA67E\\uA6F2-\\uA6F7\\uA874-\\uA877\\uA8CE\\uA8CF\\uA8F8-\\uA8FA\\uA92E\\uA92F\\uA95F\\uA9C1-\\uA9CD\\uA9DE\\uA9DF\\uAA5C-\\uAA5F\\uAADE\\uAADF\\uAAF0\\uAAF1\\uABEB\\uFD3E\\uFD3F\\uFE10-\\uFE19\\uFE30-\\uFE52\\uFE54-\\uFE61\\uFE63\\uFE68\\uFE6A\\uFE6B\\uFF01-\\uFF03\\uFF05-\\uFF0A\\uFF0C-\\uFF0F\\uFF1A\\uFF1B\\uFF1F\\uFF20\\uFF3B-\\uFF3D\\uFF3F\\uFF5B\\uFF5D\\uFF5F-\\uFF65]/;\nvar CHAMELEON = /['\\u2018\\u2019]/;\nvar SURROGATE_START = 0xd800;\nvar SURROGATE_END = 0xdfff;\nvar ZERO_WIDTH_JOINER = 0x200d;\n/**\r\n * Get the distance to the end of the first character in a string of text.\r\n */\n\nvar getCharacterDistance = text => {\n  var offset = 0; // prev types:\n  // SURR: surrogate pair\n  // MOD: modifier (technically also surrogate pair)\n  // ZWJ: zero width joiner\n  // VAR: variation selector\n  // BMP: sequenceable character from basic multilingual plane\n\n  var prev = null;\n  var charCode = text.charCodeAt(0);\n\n  while (charCode) {\n    if (isSurrogate(charCode)) {\n      var modifier = isModifier(charCode, text, offset); // Early returns are the heart of this function, where we decide if previous and current\n      // codepoints should form a single character (in terms of how many of them should selection\n      // jump over).\n\n      if (prev === 'SURR' || prev === 'BMP') {\n        break;\n      }\n\n      offset += 2;\n      prev = modifier ? 'MOD' : 'SURR';\n      charCode = text.charCodeAt(offset); // Absolutely fine to `continue` without any checks because if `charCode` is NaN (which\n      // is the case when out of `text` range), next `while` loop won\"t execute and we\"re done.\n\n      continue;\n    }\n\n    if (charCode === ZERO_WIDTH_JOINER) {\n      offset += 1;\n      prev = 'ZWJ';\n      charCode = text.charCodeAt(offset);\n      continue;\n    }\n\n    if (isBMPEmoji(charCode)) {\n      if (prev && prev !== 'ZWJ' && prev !== 'VAR') {\n        break;\n      }\n\n      offset += 1;\n      prev = 'BMP';\n      charCode = text.charCodeAt(offset);\n      continue;\n    }\n\n    if (isVariationSelector(charCode)) {\n      if (prev && prev !== 'ZWJ') {\n        break;\n      }\n\n      offset += 1;\n      prev = 'VAR';\n      charCode = text.charCodeAt(offset);\n      continue;\n    } // Modifier 'groups up' with what ever character is before that (even whitespace), need to\n    // look ahead.\n\n\n    if (prev === 'MOD') {\n      offset += 1;\n      break;\n    } // If while loop ever gets here, we're done (e.g latin chars).\n\n\n    break;\n  }\n\n  return offset || 1;\n};\n/**\r\n * Get the distance to the end of the first word in a string of text.\r\n */\n\nvar getWordDistance = text => {\n  var length = 0;\n  var i = 0;\n  var started = false;\n  var char;\n\n  while (char = text.charAt(i)) {\n    var l = getCharacterDistance(char);\n    char = text.slice(i, i + l);\n    var rest = text.slice(i + l);\n\n    if (isWordCharacter(char, rest)) {\n      started = true;\n      length += l;\n    } else if (!started) {\n      length += l;\n    } else {\n      break;\n    }\n\n    i += l;\n  }\n\n  return length;\n};\n/**\r\n * Check if a character is a word character. The `remaining` argument is used\r\n * because sometimes you must read subsequent characters to truly determine it.\r\n */\n\nvar isWordCharacter = (char, remaining) => {\n  if (SPACE.test(char)) {\n    return false;\n  } // Chameleons count as word characters as long as they're in a word, so\n  // recurse to see if the next one is a word character or not.\n\n\n  if (CHAMELEON.test(char)) {\n    var next = remaining.charAt(0);\n    var length = getCharacterDistance(next);\n    next = remaining.slice(0, length);\n    var rest = remaining.slice(length);\n\n    if (isWordCharacter(next, rest)) {\n      return true;\n    }\n  }\n\n  if (PUNCTUATION.test(char)) {\n    return false;\n  }\n\n  return true;\n};\n/**\r\n * Determines if `code` is a surrogate\r\n */\n\n\nvar isSurrogate = code => SURROGATE_START <= code && code <= SURROGATE_END;\n/**\r\n * Does `code` form Modifier with next one.\r\n *\r\n * https://emojipedia.org/modifiers/\r\n */\n\n\nvar isModifier = (code, text, offset) => {\n  if (code === 0xd83c) {\n    var next = text.charCodeAt(offset + 1);\n    return next <= 0xdfff && next >= 0xdffb;\n  }\n\n  return false;\n};\n/**\r\n * Is `code` a Variation Selector.\r\n *\r\n * https://codepoints.net/variation_selectors\r\n */\n\n\nvar isVariationSelector = code => {\n  return code <= 0xfe0f && code >= 0xfe00;\n};\n/**\r\n * Is `code` one of the BMP codes used in emoji sequences.\r\n *\r\n * https://emojipedia.org/emoji-zwj-sequences/\r\n */\n\n\nvar isBMPEmoji = code => {\n  // This requires tiny bit of maintanance, better ideas?\n  // Fortunately it only happens if new Unicode Standard\n  // is released. Fails gracefully if upkeep lags behind,\n  // same way Slate previously behaved with all emojis.\n  return code === 0x2764 || // heart (❤)\n  code === 0x2642 || // male (♂)\n  code === 0x2640 || // female (♀)\n  code === 0x2620 || // scull (☠)\n  code === 0x2695 || // medical (⚕)\n  code === 0x2708 || // plane (✈️)\n  code === 0x25ef // large circle (◯)\n  ;\n};\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\nvar Editor = {\n  /**\r\n   * Get the ancestor above a location in the document.\r\n   */\n  above(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      voids = false,\n      mode = 'lowest',\n      at = editor.selection,\n      match\n    } = options;\n\n    if (!at) {\n      return;\n    }\n\n    var path = Editor.path(editor, at);\n    var reverse = mode === 'lowest';\n\n    for (var [n, p] of Editor.levels(editor, {\n      at: path,\n      voids,\n      match,\n      reverse\n    })) {\n      if (!Text.isText(n) && !Path.equals(path, p)) {\n        return [n, p];\n      }\n    }\n  },\n\n  /**\r\n   * Add a custom property to the leaf text nodes in the current selection.\r\n   *\r\n   * If the selection is currently collapsed, the marks will be added to the\r\n   * `editor.marks` property instead, and applied when text is inserted next.\r\n   */\n  addMark(editor, key, value) {\n    editor.addMark(key, value);\n  },\n\n  /**\r\n   * Get the point after a location.\r\n   */\n  after(editor, at) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var anchor = Editor.point(editor, at, {\n      edge: 'end'\n    });\n    var focus = Editor.end(editor, []);\n    var range = {\n      anchor,\n      focus\n    };\n    var {\n      distance = 1\n    } = options;\n    var d = 0;\n    var target;\n\n    for (var p of Editor.positions(editor, _objectSpread({}, options, {\n      at: range\n    }))) {\n      if (d > distance) {\n        break;\n      }\n\n      if (d !== 0) {\n        target = p;\n      }\n\n      d++;\n    }\n\n    return target;\n  },\n\n  /**\r\n   * Get the point before a location.\r\n   */\n  before(editor, at) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var anchor = Editor.start(editor, []);\n    var focus = Editor.point(editor, at, {\n      edge: 'start'\n    });\n    var range = {\n      anchor,\n      focus\n    };\n    var {\n      distance = 1\n    } = options;\n    var d = 0;\n    var target;\n\n    for (var p of Editor.positions(editor, _objectSpread({}, options, {\n      at: range,\n      reverse: true\n    }))) {\n      if (d > distance) {\n        break;\n      }\n\n      if (d !== 0) {\n        target = p;\n      }\n\n      d++;\n    }\n\n    return target;\n  },\n\n  /**\r\n   * Delete content in the editor backward from the current selection.\r\n   */\n  deleteBackward(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      unit = 'character'\n    } = options;\n    editor.deleteBackward(unit);\n  },\n\n  /**\r\n   * Delete content in the editor forward from the current selection.\r\n   */\n  deleteForward(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      unit = 'character'\n    } = options;\n    editor.deleteForward(unit);\n  },\n\n  /**\r\n   * Delete the content in the current selection.\r\n   */\n  deleteFragment(editor) {\n    editor.deleteFragment();\n  },\n\n  /**\r\n   * Get the start and end points of a location.\r\n   */\n  edges(editor, at) {\n    return [Editor.start(editor, at), Editor.end(editor, at)];\n  },\n\n  /**\r\n   * Get the end point of a location.\r\n   */\n  end(editor, at) {\n    return Editor.point(editor, at, {\n      edge: 'end'\n    });\n  },\n\n  /**\r\n   * Get the first node at a location.\r\n   */\n  first(editor, at) {\n    var path = Editor.path(editor, at, {\n      edge: 'start'\n    });\n    return Editor.node(editor, path);\n  },\n\n  /**\r\n   * Get the fragment at a location.\r\n   */\n  fragment(editor, at) {\n    var range = Editor.range(editor, at);\n    var fragment = Node.fragment(editor, range);\n    return fragment;\n  },\n\n  /**\r\n   * Check if a node has block children.\r\n   */\n  hasBlocks(editor, element) {\n    return element.children.some(n => Editor.isBlock(editor, n));\n  },\n\n  /**\r\n   * Check if a node has inline and text children.\r\n   */\n  hasInlines(editor, element) {\n    return element.children.some(n => Text.isText(n) || Editor.isInline(editor, n));\n  },\n\n  /**\r\n   * Check if a node has text children.\r\n   */\n  hasTexts(editor, element) {\n    return element.children.every(n => Text.isText(n));\n  },\n\n  /**\r\n   * Insert a block break at the current selection.\r\n   *\r\n   * If the selection is currently expanded, it will be deleted first.\r\n   */\n  insertBreak(editor) {\n    editor.insertBreak();\n  },\n\n  /**\r\n   * Insert a fragment at the current selection.\r\n   *\r\n   * If the selection is currently expanded, it will be deleted first.\r\n   */\n  insertFragment(editor, fragment) {\n    editor.insertFragment(fragment);\n  },\n\n  /**\r\n   * Insert a node at the current selection.\r\n   *\r\n   * If the selection is currently expanded, it will be deleted first.\r\n   */\n  insertNode(editor, node) {\n    editor.insertNode(node);\n  },\n\n  /**\r\n   * Insert text at the current selection.\r\n   *\r\n   * If the selection is currently expanded, it will be deleted first.\r\n   */\n  insertText(editor, text) {\n    editor.insertText(text);\n  },\n\n  /**\r\n   * Check if a value is a block `Element` object.\r\n   */\n  isBlock(editor, value) {\n    return Element.isElement(value) && !editor.isInline(value);\n  },\n\n  /**\r\n   * Check if a value is an `Editor` object.\r\n   */\n  isEditor(value) {\n    return isPlainObject(value) && typeof value.addMark === 'function' && typeof value.apply === 'function' && typeof value.deleteBackward === 'function' && typeof value.deleteForward === 'function' && typeof value.deleteFragment === 'function' && typeof value.insertBreak === 'function' && typeof value.insertFragment === 'function' && typeof value.insertNode === 'function' && typeof value.insertText === 'function' && typeof value.isInline === 'function' && typeof value.isVoid === 'function' && typeof value.normalizeNode === 'function' && typeof value.onChange === 'function' && typeof value.removeMark === 'function' && (value.marks === null || isPlainObject(value.marks)) && (value.selection === null || Range.isRange(value.selection)) && Node.isNodeList(value.children) && Operation.isOperationList(value.operations);\n  },\n\n  /**\r\n   * Check if a point is the end point of a location.\r\n   */\n  isEnd(editor, point, at) {\n    var end = Editor.end(editor, at);\n    return Point.equals(point, end);\n  },\n\n  /**\r\n   * Check if a point is an edge of a location.\r\n   */\n  isEdge(editor, point, at) {\n    return Editor.isStart(editor, point, at) || Editor.isEnd(editor, point, at);\n  },\n\n  /**\r\n   * Check if an element is empty, accounting for void nodes.\r\n   */\n  isEmpty(editor, element) {\n    var {\n      children\n    } = element;\n    var [first] = children;\n    return children.length === 0 || children.length === 1 && Text.isText(first) && first.text === '' && !editor.isVoid(element);\n  },\n\n  /**\r\n   * Check if a value is an inline `Element` object.\r\n   */\n  isInline(editor, value) {\n    return Element.isElement(value) && editor.isInline(value);\n  },\n\n  /**\r\n   * Check if the editor is currently normalizing after each operation.\r\n   */\n  isNormalizing(editor) {\n    var isNormalizing = NORMALIZING.get(editor);\n    return isNormalizing === undefined ? true : isNormalizing;\n  },\n\n  /**\r\n   * Check if a point is the start point of a location.\r\n   */\n  isStart(editor, point, at) {\n    // PERF: If the offset isn't `0` we know it's not the start.\n    if (point.offset !== 0) {\n      return false;\n    }\n\n    var start = Editor.start(editor, at);\n    return Point.equals(point, start);\n  },\n\n  /**\r\n   * Check if a value is a void `Element` object.\r\n   */\n  isVoid(editor, value) {\n    return Element.isElement(value) && editor.isVoid(value);\n  },\n\n  /**\r\n   * Get the last node at a location.\r\n   */\n  last(editor, at) {\n    var path = Editor.path(editor, at, {\n      edge: 'end'\n    });\n    return Editor.node(editor, path);\n  },\n\n  /**\r\n   * Get the leaf text node at a location.\r\n   */\n  leaf(editor, at) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var path = Editor.path(editor, at, options);\n    var node = Node.leaf(editor, path);\n    return [node, path];\n  },\n\n  /**\r\n   * Iterate through all of the levels at a location.\r\n   */\n  *levels(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      at = editor.selection,\n      reverse = false,\n      voids = false\n    } = options;\n    var {\n      match\n    } = options;\n\n    if (match == null) {\n      match = () => true;\n    }\n\n    if (!at) {\n      return;\n    }\n\n    var levels = [];\n    var path = Editor.path(editor, at);\n\n    for (var [n, p] of Node.levels(editor, path)) {\n      if (!match(n)) {\n        continue;\n      }\n\n      levels.push([n, p]);\n\n      if (!voids && Editor.isVoid(editor, n)) {\n        break;\n      }\n    }\n\n    if (reverse) {\n      levels.reverse();\n    }\n\n    yield* levels;\n  },\n\n  /**\r\n   * Get the marks that would be added to text at the current selection.\r\n   */\n  marks(editor) {\n    var {\n      marks,\n      selection\n    } = editor;\n\n    if (!selection) {\n      return null;\n    }\n\n    if (marks) {\n      return marks;\n    }\n\n    if (Range.isExpanded(selection)) {\n      var [match] = Editor.nodes(editor, {\n        match: Text.isText\n      });\n\n      if (match) {\n        var [_node] = match;\n\n        var _rest = _objectWithoutProperties(_node, [\"text\"]);\n\n        return _rest;\n      } else {\n        return {};\n      }\n    }\n\n    var {\n      anchor\n    } = selection;\n    var {\n      path\n    } = anchor;\n    var [node] = Editor.leaf(editor, path);\n\n    if (anchor.offset === 0) {\n      var prev = Editor.previous(editor, {\n        at: path,\n        match: Text.isText\n      });\n      var block = Editor.above(editor, {\n        match: n => Editor.isBlock(editor, n)\n      });\n\n      if (prev && block) {\n        var [prevNode, prevPath] = prev;\n        var [, blockPath] = block;\n\n        if (Path.isAncestor(blockPath, prevPath)) {\n          node = prevNode;\n        }\n      }\n    }\n\n    var rest = _objectWithoutProperties(node, [\"text\"]);\n\n    return rest;\n  },\n\n  /**\r\n   * Get the matching node in the branch of the document after a location.\r\n   */\n  next(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      mode = 'lowest',\n      voids = false\n    } = options;\n    var {\n      match,\n      at = editor.selection\n    } = options;\n\n    if (!at) {\n      return;\n    }\n\n    var [, from] = Editor.last(editor, at);\n    var [, to] = Editor.last(editor, []);\n    var span = [from, to];\n\n    if (Path.isPath(at) && at.length === 0) {\n      throw new Error(\"Cannot get the next node from the root node!\");\n    }\n\n    if (match == null) {\n      if (Path.isPath(at)) {\n        var [parent] = Editor.parent(editor, at);\n\n        match = n => parent.children.includes(n);\n      } else {\n        match = () => true;\n      }\n    }\n\n    var [, next] = Editor.nodes(editor, {\n      at: span,\n      match,\n      mode,\n      voids\n    });\n    return next;\n  },\n\n  /**\r\n   * Get the node at a location.\r\n   */\n  node(editor, at) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var path = Editor.path(editor, at, options);\n    var node = Node.get(editor, path);\n    return [node, path];\n  },\n\n  /**\r\n   * Iterate through all of the nodes in the Editor.\r\n   */\n  *nodes(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      at = editor.selection,\n      mode = 'all',\n      universal = false,\n      reverse = false,\n      voids = false\n    } = options;\n    var {\n      match\n    } = options;\n\n    if (!match) {\n      match = () => true;\n    }\n\n    if (!at) {\n      return;\n    }\n\n    var from;\n    var to;\n\n    if (Span.isSpan(at)) {\n      from = at[0];\n      to = at[1];\n    } else {\n      var first = Editor.path(editor, at, {\n        edge: 'start'\n      });\n      var last = Editor.path(editor, at, {\n        edge: 'end'\n      });\n      from = reverse ? last : first;\n      to = reverse ? first : last;\n    }\n\n    var iterable = Node.nodes(editor, {\n      reverse,\n      from,\n      to,\n      pass: (_ref) => {\n        var [n] = _ref;\n        return voids ? false : Editor.isVoid(editor, n);\n      }\n    });\n    var matches = [];\n    var hit;\n\n    for (var [node, path] of iterable) {\n      var isLower = hit && Path.compare(path, hit[1]) === 0; // In highest mode any node lower than the last hit is not a match.\n\n      if (mode === 'highest' && isLower) {\n        continue;\n      }\n\n      if (!match(node)) {\n        // If we've arrived at a leaf text node that is not lower than the last\n        // hit, then we've found a branch that doesn't include a match, which\n        // means the match is not universal.\n        if (universal && !isLower && Text.isText(node)) {\n          return;\n        } else {\n          continue;\n        }\n      } // If there's a match and it's lower than the last, update the hit.\n\n\n      if (mode === 'lowest' && isLower) {\n        hit = [node, path];\n        continue;\n      } // In lowest mode we emit the last hit, once it's guaranteed lowest.\n\n\n      var emit = mode === 'lowest' ? hit : [node, path];\n\n      if (emit) {\n        if (universal) {\n          matches.push(emit);\n        } else {\n          yield emit;\n        }\n      }\n\n      hit = [node, path];\n    } // Since lowest is always emitting one behind, catch up at the end.\n\n\n    if (mode === 'lowest' && hit) {\n      if (universal) {\n        matches.push(hit);\n      } else {\n        yield hit;\n      }\n    } // Universal defers to ensure that the match occurs in every branch, so we\n    // yield all of the matches after iterating.\n\n\n    if (universal) {\n      yield* matches;\n    }\n  },\n\n  /**\r\n   * Normalize any dirty objects in the editor.\r\n   */\n  normalize(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      force = false\n    } = options;\n\n    var getDirtyPaths = editor => {\n      return DIRTY_PATHS.get(editor) || [];\n    };\n\n    if (!Editor.isNormalizing(editor)) {\n      return;\n    }\n\n    if (force) {\n      var allPaths = Array.from(Node.nodes(editor), (_ref2) => {\n        var [, p] = _ref2;\n        return p;\n      });\n      DIRTY_PATHS.set(editor, allPaths);\n    }\n\n    if (getDirtyPaths(editor).length === 0) {\n      return;\n    }\n\n    Editor.withoutNormalizing(editor, () => {\n      var max = getDirtyPaths(editor).length * 42; // HACK: better way?\n\n      var m = 0;\n\n      while (getDirtyPaths(editor).length !== 0) {\n        if (m > max) {\n          throw new Error(\"\\n            Could not completely normalize the editor after \".concat(max, \" iterations! This is usually due to incorrect normalization logic that leaves a node in an invalid state.\\n          \"));\n        }\n\n        var path = getDirtyPaths(editor).pop();\n        var entry = Editor.node(editor, path);\n        editor.normalizeNode(entry);\n        m++;\n      }\n    });\n  },\n\n  /**\r\n   * Get the parent node of a location.\r\n   */\n  parent(editor, at) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var path = Editor.path(editor, at, options);\n    var parentPath = Path.parent(path);\n    var entry = Editor.node(editor, parentPath);\n    return entry;\n  },\n\n  /**\r\n   * Get the path of a location.\r\n   */\n  path(editor, at) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var {\n      depth,\n      edge\n    } = options;\n\n    if (Path.isPath(at)) {\n      if (edge === 'start') {\n        var [, firstPath] = Node.first(editor, at);\n        at = firstPath;\n      } else if (edge === 'end') {\n        var [, lastPath] = Node.last(editor, at);\n        at = lastPath;\n      }\n    }\n\n    if (Range.isRange(at)) {\n      if (edge === 'start') {\n        at = Range.start(at);\n      } else if (edge === 'end') {\n        at = Range.end(at);\n      } else {\n        at = Path.common(at.anchor.path, at.focus.path);\n      }\n    }\n\n    if (Point.isPoint(at)) {\n      at = at.path;\n    }\n\n    if (depth != null) {\n      at = at.slice(0, depth);\n    }\n\n    return at;\n  },\n\n  /**\r\n   * Create a mutable ref for a `Path` object, which will stay in sync as new\r\n   * operations are applied to the editor.\r\n   */\n  pathRef(editor, path) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var {\n      affinity = 'forward'\n    } = options;\n    var ref = {\n      current: path,\n      affinity,\n\n      unref() {\n        var {\n          current\n        } = ref;\n        var pathRefs = Editor.pathRefs(editor);\n        pathRefs.delete(ref);\n        ref.current = null;\n        return current;\n      }\n\n    };\n    var refs = Editor.pathRefs(editor);\n    refs.add(ref);\n    return ref;\n  },\n\n  /**\r\n   * Get the set of currently tracked path refs of the editor.\r\n   */\n  pathRefs(editor) {\n    var refs = PATH_REFS.get(editor);\n\n    if (!refs) {\n      refs = new Set();\n      PATH_REFS.set(editor, refs);\n    }\n\n    return refs;\n  },\n\n  /**\r\n   * Get the start or end point of a location.\r\n   */\n  point(editor, at) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var {\n      edge = 'start'\n    } = options;\n\n    if (Path.isPath(at)) {\n      var path;\n\n      if (edge === 'end') {\n        var [, lastPath] = Node.last(editor, at);\n        path = lastPath;\n      } else {\n        var [, firstPath] = Node.first(editor, at);\n        path = firstPath;\n      }\n\n      var node = Node.get(editor, path);\n\n      if (!Text.isText(node)) {\n        throw new Error(\"Cannot get the \".concat(edge, \" point in the node at path [\").concat(at, \"] because it has no \").concat(edge, \" text node.\"));\n      }\n\n      return {\n        path,\n        offset: edge === 'end' ? node.text.length : 0\n      };\n    }\n\n    if (Range.isRange(at)) {\n      var [start, end] = Range.edges(at);\n      return edge === 'start' ? start : end;\n    }\n\n    return at;\n  },\n\n  /**\r\n   * Create a mutable ref for a `Point` object, which will stay in sync as new\r\n   * operations are applied to the editor.\r\n   */\n  pointRef(editor, point) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var {\n      affinity = 'forward'\n    } = options;\n    var ref = {\n      current: point,\n      affinity,\n\n      unref() {\n        var {\n          current\n        } = ref;\n        var pointRefs = Editor.pointRefs(editor);\n        pointRefs.delete(ref);\n        ref.current = null;\n        return current;\n      }\n\n    };\n    var refs = Editor.pointRefs(editor);\n    refs.add(ref);\n    return ref;\n  },\n\n  /**\r\n   * Get the set of currently tracked point refs of the editor.\r\n   */\n  pointRefs(editor) {\n    var refs = POINT_REFS.get(editor);\n\n    if (!refs) {\n      refs = new Set();\n      POINT_REFS.set(editor, refs);\n    }\n\n    return refs;\n  },\n\n  /**\r\n   * Iterate through all of the positions in the document where a `Point` can be\r\n   * placed.\r\n   *\r\n   * By default it will move forward by individual offsets at a time,  but you\r\n   * can pass the `unit: 'character'` option to moved forward one character, word,\r\n   * or line at at time.\r\n   *\r\n   * Note: void nodes are treated as a single point, and iteration will not\r\n   * happen inside their content.\r\n   */\n  *positions(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      at = editor.selection,\n      unit = 'offset',\n      reverse: reverse$1 = false\n    } = options;\n\n    if (!at) {\n      return;\n    }\n\n    var range = Editor.range(editor, at);\n    var [start, end] = Range.edges(range);\n    var first = reverse$1 ? end : start;\n    var string = '';\n    var available = 0;\n    var offset = 0;\n    var distance = null;\n    var isNewBlock = false;\n\n    var advance = () => {\n      if (distance == null) {\n        if (unit === 'character') {\n          distance = getCharacterDistance(string);\n        } else if (unit === 'word') {\n          distance = getWordDistance(string);\n        } else if (unit === 'line' || unit === 'block') {\n          distance = string.length;\n        } else {\n          distance = 1;\n        }\n\n        string = string.slice(distance);\n      } // Add or substract the offset.\n\n\n      offset = reverse$1 ? offset - distance : offset + distance; // Subtract the distance traveled from the available text.\n\n      available = available - distance; // If the available had room to spare, reset the distance so that it will\n      // advance again next time. Otherwise, set it to the overflow amount.\n\n      distance = available >= 0 ? null : 0 - available;\n    };\n\n    for (var [node, path] of Editor.nodes(editor, {\n      at,\n      reverse: reverse$1\n    })) {\n      if (Element.isElement(node)) {\n        // Void nodes are a special case, since we don't want to iterate over\n        // their content. We instead always just yield their first point.\n        if (editor.isVoid(node)) {\n          yield Editor.start(editor, path);\n          continue;\n        }\n\n        if (editor.isInline(node)) {\n          continue;\n        }\n\n        if (Editor.hasInlines(editor, node)) {\n          var e = Path.isAncestor(path, end.path) ? end : Editor.end(editor, path);\n          var s = Path.isAncestor(path, start.path) ? start : Editor.start(editor, path);\n          var text = Editor.string(editor, {\n            anchor: s,\n            focus: e\n          });\n          string = reverse$1 ? reverse(text) : text;\n          isNewBlock = true;\n        }\n      }\n\n      if (Text.isText(node)) {\n        var isFirst = Path.equals(path, first.path);\n        available = node.text.length;\n        offset = reverse$1 ? available : 0;\n\n        if (isFirst) {\n          available = reverse$1 ? first.offset : available - first.offset;\n          offset = first.offset;\n        }\n\n        if (isFirst || isNewBlock || unit === 'offset') {\n          yield {\n            path,\n            offset\n          };\n        }\n\n        while (true) {\n          // If there's no more string, continue to the next block.\n          if (string === '') {\n            break;\n          } else {\n            advance();\n          } // If the available space hasn't overflow, we have another point to\n          // yield in the current text node.\n\n\n          if (available >= 0) {\n            yield {\n              path,\n              offset\n            };\n          } else {\n            break;\n          }\n        }\n\n        isNewBlock = false;\n      }\n    }\n  },\n\n  /**\r\n   * Get the matching node in the branch of the document before a location.\r\n   */\n  previous(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      mode = 'lowest',\n      voids = false\n    } = options;\n    var {\n      match,\n      at = editor.selection\n    } = options;\n\n    if (!at) {\n      return;\n    }\n\n    var [, from] = Editor.first(editor, at);\n    var [, to] = Editor.first(editor, []);\n    var span = [from, to];\n\n    if (Path.isPath(at) && at.length === 0) {\n      throw new Error(\"Cannot get the previous node from the root node!\");\n    }\n\n    if (match == null) {\n      if (Path.isPath(at)) {\n        var [parent] = Editor.parent(editor, at);\n\n        match = n => parent.children.includes(n);\n      } else {\n        match = () => true;\n      }\n    }\n\n    var [, previous] = Editor.nodes(editor, {\n      reverse: true,\n      at: span,\n      match,\n      mode,\n      voids\n    });\n    return previous;\n  },\n\n  /**\r\n   * Get a range of a location.\r\n   */\n  range(editor, at, to) {\n    if (Range.isRange(at) && !to) {\n      return at;\n    }\n\n    var start = Editor.start(editor, at);\n    var end = Editor.end(editor, to || at);\n    return {\n      anchor: start,\n      focus: end\n    };\n  },\n\n  /**\r\n   * Create a mutable ref for a `Range` object, which will stay in sync as new\r\n   * operations are applied to the editor.\r\n   */\n  rangeRef(editor, range) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var {\n      affinity = 'forward'\n    } = options;\n    var ref = {\n      current: range,\n      affinity,\n\n      unref() {\n        var {\n          current\n        } = ref;\n        var rangeRefs = Editor.rangeRefs(editor);\n        rangeRefs.delete(ref);\n        ref.current = null;\n        return current;\n      }\n\n    };\n    var refs = Editor.rangeRefs(editor);\n    refs.add(ref);\n    return ref;\n  },\n\n  /**\r\n   * Get the set of currently tracked range refs of the editor.\r\n   */\n  rangeRefs(editor) {\n    var refs = RANGE_REFS.get(editor);\n\n    if (!refs) {\n      refs = new Set();\n      RANGE_REFS.set(editor, refs);\n    }\n\n    return refs;\n  },\n\n  /**\r\n   * Remove a custom property from all of the leaf text nodes in the current\r\n   * selection.\r\n   *\r\n   * If the selection is currently collapsed, the removal will be stored on\r\n   * `editor.marks` and applied to the text inserted next.\r\n   */\n  removeMark(editor, key) {\n    editor.removeMark(key);\n  },\n\n  /**\r\n   * Get the start point of a location.\r\n   */\n  start(editor, at) {\n    return Editor.point(editor, at, {\n      edge: 'start'\n    });\n  },\n\n  /**\r\n   * Get the text string content of a location.\r\n   *\r\n   * Note: the text of void nodes is presumed to be an empty string, regardless\r\n   * of what their actual content is.\r\n   */\n  string(editor, at) {\n    var range = Editor.range(editor, at);\n    var [start, end] = Range.edges(range);\n    var text = '';\n\n    for (var [node, path] of Editor.nodes(editor, {\n      at: range,\n      match: Text.isText\n    })) {\n      var t = node.text;\n\n      if (Path.equals(path, end.path)) {\n        t = t.slice(0, end.offset);\n      }\n\n      if (Path.equals(path, start.path)) {\n        t = t.slice(start.offset);\n      }\n\n      text += t;\n    }\n\n    return text;\n  },\n\n  /**\r\n   * Transform the editor by an operation.\r\n   */\n  transform(editor, op) {\n    editor.children = createDraft(editor.children);\n    var selection = editor.selection && createDraft(editor.selection);\n\n    switch (op.type) {\n      case 'insert_node':\n        {\n          var {\n            path,\n            node\n          } = op;\n          var parent = Node.parent(editor, path);\n          var index = path[path.length - 1];\n          parent.children.splice(index, 0, node);\n\n          if (selection) {\n            for (var [point, key] of Range.points(selection)) {\n              selection[key] = Point.transform(point, op);\n            }\n          }\n\n          break;\n        }\n\n      case 'insert_text':\n        {\n          var {\n            path: _path,\n            offset,\n            text\n          } = op;\n\n          var _node2 = Node.leaf(editor, _path);\n\n          var before = _node2.text.slice(0, offset);\n\n          var after = _node2.text.slice(offset);\n\n          _node2.text = before + text + after;\n\n          if (selection) {\n            for (var [_point, _key] of Range.points(selection)) {\n              selection[_key] = Point.transform(_point, op);\n            }\n          }\n\n          break;\n        }\n\n      case 'merge_node':\n        {\n          var {\n            path: _path2\n          } = op;\n\n          var _node3 = Node.get(editor, _path2);\n\n          var prevPath = Path.previous(_path2);\n          var prev = Node.get(editor, prevPath);\n\n          var _parent = Node.parent(editor, _path2);\n\n          var _index = _path2[_path2.length - 1];\n\n          if (Text.isText(_node3) && Text.isText(prev)) {\n            prev.text += _node3.text;\n          } else if (!Text.isText(_node3) && !Text.isText(prev)) {\n            prev.children.push(..._node3.children);\n          } else {\n            throw new Error(\"Cannot apply a \\\"merge_node\\\" operation at path [\".concat(_path2, \"] to nodes of different interaces: \").concat(_node3, \" \").concat(prev));\n          }\n\n          _parent.children.splice(_index, 1);\n\n          if (selection) {\n            for (var [_point2, _key2] of Range.points(selection)) {\n              selection[_key2] = Point.transform(_point2, op);\n            }\n          }\n\n          break;\n        }\n\n      case 'move_node':\n        {\n          var {\n            path: _path3,\n            newPath\n          } = op;\n\n          if (Path.isAncestor(_path3, newPath)) {\n            throw new Error(\"Cannot move a path [\".concat(_path3, \"] to new path [\").concat(newPath, \"] because the destination is inside itself.\"));\n          }\n\n          var _node4 = Node.get(editor, _path3);\n\n          var _parent2 = Node.parent(editor, _path3);\n\n          var _index2 = _path3[_path3.length - 1]; // This is tricky, but since the `path` and `newPath` both refer to\n          // the same snapshot in time, there's a mismatch. After either\n          // removing the original position, the second step's path can be out\n          // of date. So instead of using the `op.newPath` directly, we\n          // transform `op.path` to ascertain what the `newPath` would be after\n          // the operation was applied.\n\n          _parent2.children.splice(_index2, 1);\n\n          var truePath = Path.transform(_path3, op);\n          var newParent = Node.get(editor, Path.parent(truePath));\n          var newIndex = truePath[truePath.length - 1];\n          newParent.children.splice(newIndex, 0, _node4);\n\n          if (selection) {\n            for (var [_point3, _key3] of Range.points(selection)) {\n              selection[_key3] = Point.transform(_point3, op);\n            }\n          }\n\n          break;\n        }\n\n      case 'remove_node':\n        {\n          var {\n            path: _path4\n          } = op;\n          var _index3 = _path4[_path4.length - 1];\n\n          var _parent3 = Node.parent(editor, _path4);\n\n          _parent3.children.splice(_index3, 1); // Transform all of the points in the value, but if the point was in the\n          // node that was removed we need to update the range or remove it.\n\n\n          if (selection) {\n            for (var [_point4, _key4] of Range.points(selection)) {\n              var result = Point.transform(_point4, op);\n\n              if (selection != null && result != null) {\n                selection[_key4] = result;\n              } else {\n                var _prev = void 0;\n\n                var next = void 0;\n\n                for (var [n, p] of Node.texts(editor)) {\n                  if (Path.compare(p, _path4) === -1) {\n                    _prev = [n, p];\n                  } else {\n                    next = [n, p];\n                    break;\n                  }\n                }\n\n                if (_prev) {\n                  _point4.path = _prev[1];\n                  _point4.offset = _prev[0].text.length;\n                } else if (next) {\n                  _point4.path = next[1];\n                  _point4.offset = 0;\n                } else {\n                  selection = null;\n                }\n              }\n            }\n          }\n\n          break;\n        }\n\n      case 'remove_text':\n        {\n          var {\n            path: _path5,\n            offset: _offset,\n            text: _text2\n          } = op;\n\n          var _node5 = Node.leaf(editor, _path5);\n\n          var _before = _node5.text.slice(0, _offset);\n\n          var _after = _node5.text.slice(_offset + _text2.length);\n\n          _node5.text = _before + _after;\n\n          if (selection) {\n            for (var [_point5, _key5] of Range.points(selection)) {\n              selection[_key5] = Point.transform(_point5, op);\n            }\n          }\n\n          break;\n        }\n\n      case 'set_node':\n        {\n          var {\n            path: _path6,\n            newProperties\n          } = op;\n\n          if (_path6.length === 0) {\n            throw new Error(\"Cannot set properties on the root node!\");\n          }\n\n          var _node6 = Node.get(editor, _path6);\n\n          for (var _key6 in newProperties) {\n            if (_key6 === 'children' || _key6 === 'text') {\n              throw new Error(\"Cannot set the \\\"\".concat(_key6, \"\\\" property of nodes!\"));\n            }\n\n            var value = newProperties[_key6];\n\n            if (value == null) {\n              delete _node6[_key6];\n            } else {\n              _node6[_key6] = value;\n            }\n          }\n\n          break;\n        }\n\n      case 'set_selection':\n        {\n          var {\n            newProperties: _newProperties\n          } = op;\n\n          if (_newProperties == null) {\n            selection = _newProperties;\n          } else if (selection == null) {\n            if (!Range.isRange(_newProperties)) {\n              throw new Error(\"Cannot apply an incomplete \\\"set_selection\\\" operation properties \".concat(JSON.stringify(_newProperties), \" when there is no current selection.\"));\n            }\n\n            selection = _newProperties;\n          } else {\n            Object.assign(selection, _newProperties);\n          }\n\n          break;\n        }\n\n      case 'split_node':\n        {\n          var {\n            path: _path7,\n            position,\n            properties\n          } = op;\n\n          if (_path7.length === 0) {\n            throw new Error(\"Cannot apply a \\\"split_node\\\" operation at path [\".concat(_path7, \"] because the root node cannot be split.\"));\n          }\n\n          var _node7 = Node.get(editor, _path7);\n\n          var _parent4 = Node.parent(editor, _path7);\n\n          var _index4 = _path7[_path7.length - 1];\n          var newNode;\n\n          if (Text.isText(_node7)) {\n            var _before2 = _node7.text.slice(0, position);\n\n            var _after2 = _node7.text.slice(position);\n\n            _node7.text = _before2;\n            newNode = _objectSpread({}, _node7, {}, properties, {\n              text: _after2\n            });\n          } else {\n            var _before3 = _node7.children.slice(0, position);\n\n            var _after3 = _node7.children.slice(position);\n\n            _node7.children = _before3;\n            newNode = _objectSpread({}, _node7, {}, properties, {\n              children: _after3\n            });\n          }\n\n          _parent4.children.splice(_index4 + 1, 0, newNode);\n\n          if (selection) {\n            for (var [_point6, _key7] of Range.points(selection)) {\n              selection[_key7] = Point.transform(_point6, op);\n            }\n          }\n\n          break;\n        }\n    }\n\n    editor.children = finishDraft(editor.children);\n\n    if (selection) {\n      editor.selection = isDraft(selection) ? finishDraft(selection) : selection;\n    } else {\n      editor.selection = null;\n    }\n  },\n\n  /**\r\n   * Convert a range into a non-hanging one.\r\n   */\n  unhangRange(editor, range) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var {\n      voids = false\n    } = options;\n    var [start, end] = Range.edges(range); // PERF: exit early if we can guarantee that the range isn't hanging.\n\n    if (start.offset !== 0 || end.offset !== 0 || Range.isCollapsed(range)) {\n      return range;\n    }\n\n    var endBlock = Editor.above(editor, {\n      at: end,\n      match: n => Editor.isBlock(editor, n)\n    });\n    var blockPath = endBlock ? endBlock[1] : [];\n    var first = Editor.start(editor, []);\n    var before = {\n      anchor: first,\n      focus: end\n    };\n    var skip = true;\n\n    for (var [node, path] of Editor.nodes(editor, {\n      at: before,\n      match: Text.isText,\n      reverse: true,\n      voids\n    })) {\n      if (skip) {\n        skip = false;\n        continue;\n      }\n\n      if (node.text !== '' || Path.isBefore(path, blockPath)) {\n        end = {\n          path,\n          offset: node.text.length\n        };\n        break;\n      }\n    }\n\n    return {\n      anchor: start,\n      focus: end\n    };\n  },\n\n  /**\r\n   * Match a void node in the current branch of the editor.\r\n   */\n  void(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    return Editor.above(editor, _objectSpread({}, options, {\n      match: n => Editor.isVoid(editor, n)\n    }));\n  },\n\n  /**\r\n   * Call a function, deferring normalization until after it completes.\r\n   */\n  withoutNormalizing(editor, fn) {\n    var value = Editor.isNormalizing(editor);\n    NORMALIZING.set(editor, false);\n    fn();\n    NORMALIZING.set(editor, value);\n    Editor.normalize(editor);\n  }\n\n};\n\nvar Element = {\n  /**\r\n   * Check if a value implements the `Element` interface.\r\n   */\n  isElement(value) {\n    return isPlainObject(value) && Node.isNodeList(value.children) && !Editor.isEditor(value);\n  },\n\n  /**\r\n   * Check if a value is an array of `Element` objects.\r\n   */\n  isElementList(value) {\n    return Array.isArray(value) && (value.length === 0 || Element.isElement(value[0]));\n  },\n\n  /**\r\n   * Check if an element matches set of properties.\r\n   *\r\n   * Note: this checks custom properties, and it does not ensure that any\r\n   * children are equivalent.\r\n   */\n  matches(element, props) {\n    for (var key in props) {\n      if (key === 'children') {\n        continue;\n      }\n\n      if (element[key] !== props[key]) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n};\n\nvar Location = {\n  /**\r\n   * Check if a value implements the `Location` interface.\r\n   */\n  isLocation(value) {\n    return Path.isPath(value) || Point.isPoint(value) || Range.isRange(value);\n  }\n\n};\nvar Span = {\n  /**\r\n   * Check if a value implements the `Span` interface.\r\n   */\n  isSpan(value) {\n    return Array.isArray(value) && value.length === 2 && value.every(Path.isPath);\n  }\n\n};\n\nvar Node = {\n  /**\r\n   * Get the node at a specific path, asserting that it's an ancestor node.\r\n   */\n  ancestor(root, path) {\n    var node = Node.get(root, path);\n\n    if (Text.isText(node)) {\n      throw new Error(\"Cannot get the ancestor node at path [\".concat(path, \"] because it refers to a text node instead: \").concat(node));\n    }\n\n    return node;\n  },\n\n  /**\r\n   * Return an iterable of all the ancestor nodes above a specific path.\r\n   *\r\n   * By default the order is bottom-up, from lowest to highest ancestor in\r\n   * the tree, but you can pass the `reverse: true` option to go top-down.\r\n   */\n  *ancestors(root, path) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n    for (var p of Path.ancestors(path, options)) {\n      var n = Node.ancestor(root, p);\n      var entry = [n, p];\n      yield entry;\n    }\n  },\n\n  /**\r\n   * Get the child of a node at a specific index.\r\n   */\n  child(root, index) {\n    if (Text.isText(root)) {\n      throw new Error(\"Cannot get the child of a text node: \".concat(JSON.stringify(root)));\n    }\n\n    var c = root.children[index];\n\n    if (c == null) {\n      throw new Error(\"Cannot get child at index `\".concat(index, \"` in node: \").concat(JSON.stringify(root)));\n    }\n\n    return c;\n  },\n\n  /**\r\n   * Iterate over the children of a node at a specific path.\r\n   */\n  *children(root, path) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var {\n      reverse = false\n    } = options;\n    var ancestor = Node.ancestor(root, path);\n    var {\n      children\n    } = ancestor;\n    var index = reverse ? children.length - 1 : 0;\n\n    while (reverse ? index >= 0 : index < children.length) {\n      var child = Node.child(ancestor, index);\n      var childPath = path.concat(index);\n      yield [child, childPath];\n      index = reverse ? index - 1 : index + 1;\n    }\n  },\n\n  /**\r\n   * Get an entry for the common ancesetor node of two paths.\r\n   */\n  common(root, path, another) {\n    var p = Path.common(path, another);\n    var n = Node.get(root, p);\n    return [n, p];\n  },\n\n  /**\r\n   * Get the node at a specific path, asserting that it's a descendant node.\r\n   */\n  descendant(root, path) {\n    var node = Node.get(root, path);\n\n    if (Editor.isEditor(node)) {\n      throw new Error(\"Cannot get the descendant node at path [\".concat(path, \"] because it refers to the root editor node instead: \").concat(node));\n    }\n\n    return node;\n  },\n\n  /**\r\n   * Return an iterable of all the descendant node entries inside a root node.\r\n   */\n  *descendants(root) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    for (var [node, path] of Node.nodes(root, options)) {\n      if (path.length !== 0) {\n        // NOTE: we have to coerce here because checking the path's length does\n        // guarantee that `node` is not a `Editor`, but TypeScript doesn't know.\n        yield [node, path];\n      }\n    }\n  },\n\n  /**\r\n   * Return an iterable of all the element nodes inside a root node. Each iteration\r\n   * will return an `ElementEntry` tuple consisting of `[Element, Path]`. If the\r\n   * root node is an element it will be included in the iteration as well.\r\n   */\n  *elements(root) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    for (var [node, path] of Node.nodes(root, options)) {\n      if (Element.isElement(node)) {\n        yield [node, path];\n      }\n    }\n  },\n\n  /**\r\n   * Get the first node entry in a root node from a path.\r\n   */\n  first(root, path) {\n    var p = path.slice();\n    var n = Node.get(root, p);\n\n    while (n) {\n      if (Text.isText(n) || n.children.length === 0) {\n        break;\n      } else {\n        n = n.children[0];\n        p.push(0);\n      }\n    }\n\n    return [n, p];\n  },\n\n  /**\r\n   * Get the sliced fragment represented by a range inside a root node.\r\n   */\n  fragment(root, range) {\n    if (Text.isText(root)) {\n      throw new Error(\"Cannot get a fragment starting from a root text node: \".concat(JSON.stringify(root)));\n    }\n\n    var newRoot = produce(root, r => {\n      var [start, end] = Range.edges(range);\n      var iterable = Node.nodes(r, {\n        reverse: true,\n        pass: (_ref) => {\n          var [, path] = _ref;\n          return !Range.includes(range, path);\n        }\n      });\n\n      for (var [, path] of iterable) {\n        if (!Range.includes(range, path)) {\n          var parent = Node.parent(r, path);\n          var index = path[path.length - 1];\n          parent.children.splice(index, 1);\n        }\n\n        if (Path.equals(path, end.path)) {\n          var leaf = Node.leaf(r, path);\n          leaf.text = leaf.text.slice(0, end.offset);\n        }\n\n        if (Path.equals(path, start.path)) {\n          var _leaf = Node.leaf(r, path);\n\n          _leaf.text = _leaf.text.slice(start.offset);\n        }\n      }\n\n      delete r.selection;\n    });\n    return newRoot.children;\n  },\n\n  /**\r\n   * Get the descendant node referred to by a specific path. If the path is an\r\n   * empty array, it refers to the root node itself.\r\n   */\n  get(root, path) {\n    var node = root;\n\n    for (var i = 0; i < path.length; i++) {\n      var p = path[i];\n\n      if (Text.isText(node) || !node.children[p]) {\n        throw new Error(\"Cannot find a descendant at path [\".concat(path, \"] in node: \").concat(JSON.stringify(root)));\n      }\n\n      node = node.children[p];\n    }\n\n    return node;\n  },\n\n  /**\r\n   * Check if a descendant node exists at a specific path.\r\n   */\n  has(root, path) {\n    var node = root;\n\n    for (var i = 0; i < path.length; i++) {\n      var p = path[i];\n\n      if (Text.isText(node) || !node.children[p]) {\n        return false;\n      }\n\n      node = node.children[p];\n    }\n\n    return true;\n  },\n\n  /**\r\n   * Check if a value implements the `Node` interface.\r\n   */\n  isNode(value) {\n    return Text.isText(value) || Element.isElement(value) || Editor.isEditor(value);\n  },\n\n  /**\r\n   * Check if a value is a list of `Node` objects.\r\n   */\n  isNodeList(value) {\n    return Array.isArray(value) && (value.length === 0 || Node.isNode(value[0]));\n  },\n\n  /**\r\n   * Get the lash node entry in a root node from a path.\r\n   */\n  last(root, path) {\n    var p = path.slice();\n    var n = Node.get(root, p);\n\n    while (n) {\n      if (Text.isText(n) || n.children.length === 0) {\n        break;\n      } else {\n        var i = n.children.length - 1;\n        n = n.children[i];\n        p.push(i);\n      }\n    }\n\n    return [n, p];\n  },\n\n  /**\r\n   * Get the node at a specific path, ensuring it's a leaf text node.\r\n   */\n  leaf(root, path) {\n    var node = Node.get(root, path);\n\n    if (!Text.isText(node)) {\n      throw new Error(\"Cannot get the leaf node at path [\".concat(path, \"] because it refers to a non-leaf node: \").concat(node));\n    }\n\n    return node;\n  },\n\n  /**\r\n   * Return an iterable of the in a branch of the tree, from a specific path.\r\n   *\r\n   * By default the order is top-down, from lowest to highest node in the tree,\r\n   * but you can pass the `reverse: true` option to go bottom-up.\r\n   */\n  *levels(root, path) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n    for (var p of Path.levels(path, options)) {\n      var n = Node.get(root, p);\n      yield [n, p];\n    }\n  },\n\n  /**\r\n   * Check if a node matches a set of props.\r\n   */\n  matches(node, props) {\n    return Element.isElement(node) && Element.matches(node, props) || Text.isText(node) && Text.matches(node, props);\n  },\n\n  /**\r\n   * Return an iterable of all the node entries of a root node. Each entry is\r\n   * returned as a `[Node, Path]` tuple, with the path referring to the node's\r\n   * position inside the root node.\r\n   */\n  *nodes(root) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      pass,\n      reverse = false\n    } = options;\n    var {\n      from = [],\n      to\n    } = options;\n    var visited = new Set();\n    var p = [];\n    var n = root;\n\n    while (true) {\n      if (to && (reverse ? Path.isBefore(p, to) : Path.isAfter(p, to))) {\n        break;\n      }\n\n      if (!visited.has(n)) {\n        yield [n, p];\n      } // If we're allowed to go downward and we haven't decsended yet, do.\n\n\n      if (!visited.has(n) && !Text.isText(n) && n.children.length !== 0 && (pass == null || pass([n, p]) === false)) {\n        visited.add(n);\n        var nextIndex = reverse ? n.children.length - 1 : 0;\n\n        if (Path.isAncestor(p, from)) {\n          nextIndex = from[p.length];\n        }\n\n        p = p.concat(nextIndex);\n        n = Node.get(root, p);\n        continue;\n      } // If we're at the root and we can't go down, we're done.\n\n\n      if (p.length === 0) {\n        break;\n      } // If we're going forward...\n\n\n      if (!reverse) {\n        var newPath = Path.next(p);\n\n        if (Node.has(root, newPath)) {\n          p = newPath;\n          n = Node.get(root, p);\n          continue;\n        }\n      } // If we're going backward...\n\n\n      if (reverse && p[p.length - 1] !== 0) {\n        var _newPath = Path.previous(p);\n\n        p = _newPath;\n        n = Node.get(root, p);\n        continue;\n      } // Otherwise we're going upward...\n\n\n      p = Path.parent(p);\n      n = Node.get(root, p);\n      visited.add(n);\n    }\n  },\n\n  /**\r\n   * Get the parent of a node at a specific path.\r\n   */\n  parent(root, path) {\n    var parentPath = Path.parent(path);\n    var p = Node.get(root, parentPath);\n\n    if (Text.isText(p)) {\n      throw new Error(\"Cannot get the parent of path [\".concat(path, \"] because it does not exist in the root.\"));\n    }\n\n    return p;\n  },\n\n  /**\r\n   * Get the concatenated text string of a node's content.\r\n   *\r\n   * Note that this will not include spaces or line breaks between block nodes.\r\n   * It is not a user-facing string, but a string for performing offset-related\r\n   * computations for a node.\r\n   */\n  string(node) {\n    if (Text.isText(node)) {\n      return node.text;\n    } else {\n      return node.children.map(Node.string).join('');\n    }\n  },\n\n  /**\r\n   * Return an iterable of all leaf text nodes in a root node.\r\n   */\n  *texts(root) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    for (var [node, path] of Node.nodes(root, options)) {\n      if (Text.isText(node)) {\n        yield [node, path];\n      }\n    }\n  }\n\n};\n\nfunction ownKeys$1(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$1(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$1(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$1(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\nvar Operation = {\n  /**\r\n   * Check of a value is a `NodeOperation` object.\r\n   */\n  isNodeOperation(value) {\n    return Operation.isOperation(value) && value.type.endsWith('_node');\n  },\n\n  /**\r\n   * Check of a value is an `Operation` object.\r\n   */\n  isOperation(value) {\n    if (!isPlainObject(value)) {\n      return false;\n    }\n\n    switch (value.type) {\n      case 'insert_node':\n        return Path.isPath(value.path) && Node.isNode(value.node);\n\n      case 'insert_text':\n        return typeof value.offset === 'number' && typeof value.text === 'string' && Path.isPath(value.path);\n\n      case 'merge_node':\n        return typeof value.position === 'number' && (typeof value.target === 'number' || value.target === null) && Path.isPath(value.path) && isPlainObject(value.properties);\n\n      case 'move_node':\n        return Path.isPath(value.path) && Path.isPath(value.newPath);\n\n      case 'remove_node':\n        return Path.isPath(value.path) && Node.isNode(value.node);\n\n      case 'remove_text':\n        return typeof value.offset === 'number' && typeof value.text === 'string' && Path.isPath(value.path);\n\n      case 'set_node':\n        return Path.isPath(value.path) && isPlainObject(value.properties) && isPlainObject(value.newProperties);\n\n      case 'set_selection':\n        return value.properties === null && Range.isRange(value.newProperties) || value.newProperties === null && Range.isRange(value.properties) || isPlainObject(value.properties) && isPlainObject(value.newProperties);\n\n      case 'split_node':\n        return Path.isPath(value.path) && typeof value.position === 'number' && (typeof value.target === 'number' || value.target === null) && isPlainObject(value.properties);\n\n      default:\n        return false;\n    }\n  },\n\n  /**\r\n   * Check if a value is a list of `Operation` objects.\r\n   */\n  isOperationList(value) {\n    return Array.isArray(value) && (value.length === 0 || Operation.isOperation(value[0]));\n  },\n\n  /**\r\n   * Check of a value is a `SelectionOperation` object.\r\n   */\n  isSelectionOperation(value) {\n    return Operation.isOperation(value) && value.type.endsWith('_selection');\n  },\n\n  /**\r\n   * Check of a value is a `TextOperation` object.\r\n   */\n  isTextOperation(value) {\n    return Operation.isOperation(value) && value.type.endsWith('_text');\n  },\n\n  /**\r\n   * Invert an operation, returning a new operation that will exactly undo the\r\n   * original when applied.\r\n   */\n  inverse(op) {\n    switch (op.type) {\n      case 'insert_node':\n        {\n          return _objectSpread$1({}, op, {\n            type: 'remove_node'\n          });\n        }\n\n      case 'insert_text':\n        {\n          return _objectSpread$1({}, op, {\n            type: 'remove_text'\n          });\n        }\n\n      case 'merge_node':\n        {\n          return _objectSpread$1({}, op, {\n            type: 'split_node',\n            path: Path.previous(op.path)\n          });\n        }\n\n      case 'move_node':\n        {\n          var {\n            newPath,\n            path\n          } = op; // PERF: in this case the move operation is a no-op anyways.\n\n          if (Path.equals(newPath, path)) {\n            return op;\n          } // If the move happens completely within a single parent the path and\n          // newPath are stable with respect to each other.\n\n\n          if (Path.isSibling(path, newPath)) {\n            return _objectSpread$1({}, op, {\n              path: newPath,\n              newPath: path\n            });\n          } // If the move does not happen within a single parent it is possible\n          // for the move to impact the true path to the location where the node\n          // was removed from and where it was inserted. We have to adjust for this\n          // and find the original path. We can accomplish this (only in non-sibling)\n          // moves by looking at the impact of the move operation on the node\n          // after the original move path.\n\n\n          var inversePath = Path.transform(path, op);\n          var inverseNewPath = Path.transform(Path.next(path), op);\n          return _objectSpread$1({}, op, {\n            path: inversePath,\n            newPath: inverseNewPath\n          });\n        }\n\n      case 'remove_node':\n        {\n          return _objectSpread$1({}, op, {\n            type: 'insert_node'\n          });\n        }\n\n      case 'remove_text':\n        {\n          return _objectSpread$1({}, op, {\n            type: 'insert_text'\n          });\n        }\n\n      case 'set_node':\n        {\n          var {\n            properties,\n            newProperties\n          } = op;\n          return _objectSpread$1({}, op, {\n            properties: newProperties,\n            newProperties: properties\n          });\n        }\n\n      case 'set_selection':\n        {\n          var {\n            properties: _properties,\n            newProperties: _newProperties\n          } = op;\n\n          if (_properties == null) {\n            return _objectSpread$1({}, op, {\n              properties: _newProperties,\n              newProperties: null\n            });\n          } else if (_newProperties == null) {\n            return _objectSpread$1({}, op, {\n              properties: null,\n              newProperties: _properties\n            });\n          } else {\n            return _objectSpread$1({}, op, {\n              properties: _newProperties,\n              newProperties: _properties\n            });\n          }\n        }\n\n      case 'split_node':\n        {\n          return _objectSpread$1({}, op, {\n            type: 'merge_node',\n            path: Path.next(op.path)\n          });\n        }\n    }\n  }\n\n};\n\nvar Path = {\n  /**\r\n   * Get a list of ancestor paths for a given path.\r\n   *\r\n   * The paths are sorted from deepest to shallowest ancestor. However, if the\r\n   * `reverse: true` option is passed, they are reversed.\r\n   */\n  ancestors(path) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      reverse = false\n    } = options;\n    var paths = Path.levels(path, options);\n\n    if (reverse) {\n      paths = paths.slice(1);\n    } else {\n      paths = paths.slice(0, -1);\n    }\n\n    return paths;\n  },\n\n  /**\r\n   * Get the common ancestor path of two paths.\r\n   */\n  common(path, another) {\n    var common = [];\n\n    for (var i = 0; i < path.length && i < another.length; i++) {\n      var av = path[i];\n      var bv = another[i];\n\n      if (av !== bv) {\n        break;\n      }\n\n      common.push(av);\n    }\n\n    return common;\n  },\n\n  /**\r\n   * Compare a path to another, returning an integer indicating whether the path\r\n   * was before, at, or after the other.\r\n   *\r\n   * Note: Two paths of unequal length can still receive a `0` result if one is\r\n   * directly above or below the other. If you want exact matching, use\r\n   * [[Path.equals]] instead.\r\n   */\n  compare(path, another) {\n    var min = Math.min(path.length, another.length);\n\n    for (var i = 0; i < min; i++) {\n      if (path[i] < another[i]) return -1;\n      if (path[i] > another[i]) return 1;\n    }\n\n    return 0;\n  },\n\n  /**\r\n   * Check if a path ends after one of the indexes in another.\r\n   */\n  endsAfter(path, another) {\n    var i = path.length - 1;\n    var as = path.slice(0, i);\n    var bs = another.slice(0, i);\n    var av = path[i];\n    var bv = another[i];\n    return Path.equals(as, bs) && av > bv;\n  },\n\n  /**\r\n   * Check if a path ends at one of the indexes in another.\r\n   */\n  endsAt(path, another) {\n    var i = path.length;\n    var as = path.slice(0, i);\n    var bs = another.slice(0, i);\n    return Path.equals(as, bs);\n  },\n\n  /**\r\n   * Check if a path ends before one of the indexes in another.\r\n   */\n  endsBefore(path, another) {\n    var i = path.length - 1;\n    var as = path.slice(0, i);\n    var bs = another.slice(0, i);\n    var av = path[i];\n    var bv = another[i];\n    return Path.equals(as, bs) && av < bv;\n  },\n\n  /**\r\n   * Check if a path is exactly equal to another.\r\n   */\n  equals(path, another) {\n    return path.length === another.length && path.every((n, i) => n === another[i]);\n  },\n\n  /**\r\n   * Check if a path is after another.\r\n   */\n  isAfter(path, another) {\n    return Path.compare(path, another) === 1;\n  },\n\n  /**\r\n   * Check if a path is an ancestor of another.\r\n   */\n  isAncestor(path, another) {\n    return path.length < another.length && Path.compare(path, another) === 0;\n  },\n\n  /**\r\n   * Check if a path is before another.\r\n   */\n  isBefore(path, another) {\n    return Path.compare(path, another) === -1;\n  },\n\n  /**\r\n   * Check if a path is a child of another.\r\n   */\n  isChild(path, another) {\n    return path.length === another.length + 1 && Path.compare(path, another) === 0;\n  },\n\n  /**\r\n   * Check if a path is equal to or an ancestor of another.\r\n   */\n  isCommon(path, another) {\n    return path.length <= another.length && Path.compare(path, another) === 0;\n  },\n\n  /**\r\n   * Check if a path is a descendant of another.\r\n   */\n  isDescendant(path, another) {\n    return path.length > another.length && Path.compare(path, another) === 0;\n  },\n\n  /**\r\n   * Check if a path is the parent of another.\r\n   */\n  isParent(path, another) {\n    return path.length + 1 === another.length && Path.compare(path, another) === 0;\n  },\n\n  /**\r\n   * Check is a value implements the `Path` interface.\r\n   */\n  isPath(value) {\n    return Array.isArray(value) && (value.length === 0 || typeof value[0] === 'number');\n  },\n\n  /**\r\n   * Check if a path is a sibling of another.\r\n   */\n  isSibling(path, another) {\n    if (path.length !== another.length) {\n      return false;\n    }\n\n    var as = path.slice(0, -1);\n    var bs = another.slice(0, -1);\n    var al = path[path.length - 1];\n    var bl = another[another.length - 1];\n    return al !== bl && Path.equals(as, bs);\n  },\n\n  /**\r\n   * Get a list of paths at every level down to a path. Note: this is the same\r\n   * as `Path.ancestors`, but including the path itself.\r\n   *\r\n   * The paths are sorted from shallowest to deepest. However, if the `reverse:\r\n   * true` option is passed, they are reversed.\r\n   */\n  levels(path) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      reverse = false\n    } = options;\n    var list = [];\n\n    for (var i = 0; i <= path.length; i++) {\n      list.push(path.slice(0, i));\n    }\n\n    if (reverse) {\n      list.reverse();\n    }\n\n    return list;\n  },\n\n  /**\r\n   * Given a path, get the path to the next sibling node.\r\n   */\n  next(path) {\n    if (path.length === 0) {\n      throw new Error(\"Cannot get the next path of a root path [\".concat(path, \"], because it has no next index.\"));\n    }\n\n    var last = path[path.length - 1];\n    return path.slice(0, -1).concat(last + 1);\n  },\n\n  /**\r\n   * Given a path, return a new path referring to the parent node above it.\r\n   */\n  parent(path) {\n    if (path.length === 0) {\n      throw new Error(\"Cannot get the parent path of the root path [\".concat(path, \"].\"));\n    }\n\n    return path.slice(0, -1);\n  },\n\n  /**\r\n   * Given a path, get the path to the previous sibling node.\r\n   */\n  previous(path) {\n    if (path.length === 0) {\n      throw new Error(\"Cannot get the previous path of a root path [\".concat(path, \"], because it has no previous index.\"));\n    }\n\n    var last = path[path.length - 1];\n\n    if (last <= 0) {\n      throw new Error(\"Cannot get the previous path of a first child path [\".concat(path, \"] because it would result in a negative index.\"));\n    }\n\n    return path.slice(0, -1).concat(last - 1);\n  },\n\n  /**\r\n   * Get a path relative to an ancestor.\r\n   */\n  relative(path, ancestor) {\n    if (!Path.isAncestor(ancestor, path) && !Path.equals(path, ancestor)) {\n      throw new Error(\"Cannot get the relative path of [\".concat(path, \"] inside ancestor [\").concat(ancestor, \"], because it is not above or equal to the path.\"));\n    }\n\n    return path.slice(ancestor.length);\n  },\n\n  /**\r\n   * Transform a path by an operation.\r\n   */\n  transform(path, operation) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    return produce(path, p => {\n      var {\n        affinity = 'forward'\n      } = options; // PERF: Exit early if the operation is guaranteed not to have an effect.\n\n      if (path.length === 0) {\n        return;\n      }\n\n      switch (operation.type) {\n        case 'insert_node':\n          {\n            var {\n              path: op\n            } = operation;\n\n            if (Path.equals(op, p) || Path.endsBefore(op, p) || Path.isAncestor(op, p)) {\n              p[op.length - 1] += 1;\n            }\n\n            break;\n          }\n\n        case 'remove_node':\n          {\n            var {\n              path: _op\n            } = operation;\n\n            if (Path.equals(_op, p) || Path.isAncestor(_op, p)) {\n              return null;\n            } else if (Path.endsBefore(_op, p)) {\n              p[_op.length - 1] -= 1;\n            }\n\n            break;\n          }\n\n        case 'merge_node':\n          {\n            var {\n              path: _op2,\n              position\n            } = operation;\n\n            if (Path.equals(_op2, p) || Path.endsBefore(_op2, p)) {\n              p[_op2.length - 1] -= 1;\n            } else if (Path.isAncestor(_op2, p)) {\n              p[_op2.length - 1] -= 1;\n              p[_op2.length] += position;\n            }\n\n            break;\n          }\n\n        case 'split_node':\n          {\n            var {\n              path: _op3,\n              position: _position\n            } = operation;\n\n            if (Path.equals(_op3, p)) {\n              if (affinity === 'forward') {\n                p[p.length - 1] += 1;\n              } else if (affinity === 'backward') ; else {\n                return null;\n              }\n            } else if (Path.endsBefore(_op3, p)) {\n              p[_op3.length - 1] += 1;\n            } else if (Path.isAncestor(_op3, p) && path[_op3.length] >= _position) {\n              p[_op3.length - 1] += 1;\n              p[_op3.length] -= _position;\n            }\n\n            break;\n          }\n\n        case 'move_node':\n          {\n            var {\n              path: _op4,\n              newPath: onp\n            } = operation; // If the old and new path are the same, it's a no-op.\n\n            if (Path.equals(_op4, onp)) {\n              return;\n            }\n\n            if (Path.isAncestor(_op4, p) || Path.equals(_op4, p)) {\n              var copy = onp.slice();\n\n              if (Path.endsBefore(_op4, onp) && _op4.length < onp.length) {\n                copy[_op4.length - 1] -= 1;\n              }\n\n              return copy.concat(p.slice(_op4.length));\n            } else if (Path.isSibling(_op4, onp) && (Path.isAncestor(onp, p) || Path.equals(onp, p))) {\n              if (Path.endsBefore(_op4, p)) {\n                p[_op4.length - 1] -= 1;\n              } else {\n                p[_op4.length - 1] += 1;\n              }\n            } else if (Path.endsBefore(onp, p) || Path.equals(onp, p) || Path.isAncestor(onp, p)) {\n              if (Path.endsBefore(_op4, p)) {\n                p[_op4.length - 1] -= 1;\n              }\n\n              p[onp.length - 1] += 1;\n            } else if (Path.endsBefore(_op4, p)) {\n              if (Path.equals(onp, p)) {\n                p[onp.length - 1] += 1;\n              }\n\n              p[_op4.length - 1] -= 1;\n            }\n\n            break;\n          }\n      }\n    });\n  }\n\n};\n\nvar PathRef = {\n  /**\r\n   * Transform the path ref's current value by an operation.\r\n   */\n  transform(ref, op) {\n    var {\n      current,\n      affinity\n    } = ref;\n\n    if (current == null) {\n      return;\n    }\n\n    var path = Path.transform(current, op, {\n      affinity\n    });\n    ref.current = path;\n\n    if (path == null) {\n      ref.unref();\n    }\n  }\n\n};\n\nfunction ownKeys$2(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$2(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$2(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$2(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\nvar Point = {\n  /**\r\n   * Compare a point to another, returning an integer indicating whether the\r\n   * point was before, at, or after the other.\r\n   */\n  compare(point, another) {\n    var result = Path.compare(point.path, another.path);\n\n    if (result === 0) {\n      if (point.offset < another.offset) return -1;\n      if (point.offset > another.offset) return 1;\n      return 0;\n    }\n\n    return result;\n  },\n\n  /**\r\n   * Check if a point is after another.\r\n   */\n  isAfter(point, another) {\n    return Point.compare(point, another) === 1;\n  },\n\n  /**\r\n   * Check if a point is before another.\r\n   */\n  isBefore(point, another) {\n    return Point.compare(point, another) === -1;\n  },\n\n  /**\r\n   * Check if a point is exactly equal to another.\r\n   */\n  equals(point, another) {\n    // PERF: ensure the offsets are equal first since they are cheaper to check.\n    return point.offset === another.offset && Path.equals(point.path, another.path);\n  },\n\n  /**\r\n   * Check if a value implements the `Point` interface.\r\n   */\n  isPoint(value) {\n    return isPlainObject(value) && typeof value.offset === 'number' && Path.isPath(value.path);\n  },\n\n  /**\r\n   * Transform a point by an operation.\r\n   */\n  transform(point, op) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    return produce(point, p => {\n      var {\n        affinity = 'forward'\n      } = options;\n      var {\n        path,\n        offset\n      } = p;\n\n      switch (op.type) {\n        case 'insert_node':\n        case 'move_node':\n          {\n            p.path = Path.transform(path, op, options);\n            break;\n          }\n\n        case 'insert_text':\n          {\n            if (Path.equals(op.path, path) && op.offset <= offset) {\n              p.offset += op.text.length;\n            }\n\n            break;\n          }\n\n        case 'merge_node':\n          {\n            if (Path.equals(op.path, path)) {\n              p.offset += op.position;\n            }\n\n            p.path = Path.transform(path, op, options);\n            break;\n          }\n\n        case 'remove_text':\n          {\n            if (Path.equals(op.path, path) && op.offset <= offset) {\n              p.offset -= Math.min(offset - op.offset, op.text.length);\n            }\n\n            break;\n          }\n\n        case 'remove_node':\n          {\n            if (Path.equals(op.path, path) || Path.isAncestor(op.path, path)) {\n              return null;\n            }\n\n            p.path = Path.transform(path, op, options);\n            break;\n          }\n\n        case 'split_node':\n          {\n            if (Path.equals(op.path, path)) {\n              if (op.position === offset && affinity == null) {\n                return null;\n              } else if (op.position < offset || op.position === offset && affinity === 'forward') {\n                p.offset -= op.position;\n                p.path = Path.transform(path, op, _objectSpread$2({}, options, {\n                  affinity: 'forward'\n                }));\n              }\n            } else {\n              p.path = Path.transform(path, op, options);\n            }\n\n            break;\n          }\n      }\n    });\n  }\n\n};\n\nvar PointRef = {\n  /**\r\n   * Transform the point ref's current value by an operation.\r\n   */\n  transform(ref, op) {\n    var {\n      current,\n      affinity\n    } = ref;\n\n    if (current == null) {\n      return;\n    }\n\n    var point = Point.transform(current, op, {\n      affinity\n    });\n    ref.current = point;\n\n    if (point == null) {\n      ref.unref();\n    }\n  }\n\n};\n\nfunction ownKeys$3(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$3(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$3(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$3(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\nvar Range = {\n  /**\r\n   * Get the start and end points of a range, in the order in which they appear\r\n   * in the document.\r\n   */\n  edges(range) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      reverse = false\n    } = options;\n    var {\n      anchor,\n      focus\n    } = range;\n    return Range.isBackward(range) === reverse ? [anchor, focus] : [focus, anchor];\n  },\n\n  /**\r\n   * Get the end point of a range.\r\n   */\n  end(range) {\n    var [, end] = Range.edges(range);\n    return end;\n  },\n\n  /**\r\n   * Check if a range is exactly equal to another.\r\n   */\n  equals(range, another) {\n    return Point.equals(range.anchor, another.anchor) && Point.equals(range.focus, another.focus);\n  },\n\n  /**\r\n   * Check if a range includes a path, a point or part of another range.\r\n   */\n  includes(range, target) {\n    if (Range.isRange(target)) {\n      if (Range.includes(range, target.anchor) || Range.includes(range, target.focus)) {\n        return true;\n      }\n\n      var [rs, re] = Range.edges(range);\n      var [ts, te] = Range.edges(target);\n      return Point.isBefore(rs, ts) && Point.isAfter(re, te);\n    }\n\n    var [start, end] = Range.edges(range);\n    var isAfterStart = false;\n    var isBeforeEnd = false;\n\n    if (Point.isPoint(target)) {\n      isAfterStart = Point.compare(target, start) >= 0;\n      isBeforeEnd = Point.compare(target, end) <= 0;\n    } else {\n      isAfterStart = Path.compare(target, start.path) >= 0;\n      isBeforeEnd = Path.compare(target, end.path) <= 0;\n    }\n\n    return isAfterStart && isBeforeEnd;\n  },\n\n  /**\r\n   * Get the intersection of a range with another.\r\n   */\n  intersection(range, another) {\n    var rest = _objectWithoutProperties(range, [\"anchor\", \"focus\"]);\n\n    var [s1, e1] = Range.edges(range);\n    var [s2, e2] = Range.edges(another);\n    var start = Point.isBefore(s1, s2) ? s2 : s1;\n    var end = Point.isBefore(e1, e2) ? e1 : e2;\n\n    if (Point.isBefore(end, start)) {\n      return null;\n    } else {\n      return _objectSpread$3({\n        anchor: start,\n        focus: end\n      }, rest);\n    }\n  },\n\n  /**\r\n   * Check if a range is backward, meaning that its anchor point appears in the\r\n   * document _after_ its focus point.\r\n   */\n  isBackward(range) {\n    var {\n      anchor,\n      focus\n    } = range;\n    return Point.isAfter(anchor, focus);\n  },\n\n  /**\r\n   * Check if a range is collapsed, meaning that both its anchor and focus\r\n   * points refer to the exact same position in the document.\r\n   */\n  isCollapsed(range) {\n    var {\n      anchor,\n      focus\n    } = range;\n    return Point.equals(anchor, focus);\n  },\n\n  /**\r\n   * Check if a range is expanded.\r\n   *\r\n   * This is the opposite of [[Range.isCollapsed]] and is provided for legibility.\r\n   */\n  isExpanded(range) {\n    return !Range.isCollapsed(range);\n  },\n\n  /**\r\n   * Check if a range is forward.\r\n   *\r\n   * This is the opposite of [[Range.isBackward]] and is provided for legibility.\r\n   */\n  isForward(range) {\n    return !Range.isBackward(range);\n  },\n\n  /**\r\n   * Check if a value implements the [[Range]] interface.\r\n   */\n  isRange(value) {\n    return isPlainObject(value) && Point.isPoint(value.anchor) && Point.isPoint(value.focus);\n  },\n\n  /**\r\n   * Iterate through all of the point entries in a range.\r\n   */\n  *points(range) {\n    yield [range.anchor, 'anchor'];\n    yield [range.focus, 'focus'];\n  },\n\n  /**\r\n   * Get the start point of a range.\r\n   */\n  start(range) {\n    var [start] = Range.edges(range);\n    return start;\n  },\n\n  /**\r\n   * Transform a range by an operation.\r\n   */\n  transform(range, op, options) {\n    var {\n      affinity = 'inward'\n    } = options;\n    var affinityAnchor;\n    var affinityFocus;\n\n    if (affinity === 'inward') {\n      if (Range.isForward(range)) {\n        affinityAnchor = 'forward';\n        affinityFocus = 'backward';\n      } else {\n        affinityAnchor = 'backward';\n        affinityFocus = 'forward';\n      }\n    } else if (affinity === 'outward') {\n      if (Range.isForward(range)) {\n        affinityAnchor = 'backward';\n        affinityFocus = 'forward';\n      } else {\n        affinityAnchor = 'forward';\n        affinityFocus = 'backward';\n      }\n    } else {\n      affinityAnchor = affinity;\n      affinityFocus = affinity;\n    }\n\n    return produce(range, r => {\n      var anchor = Point.transform(r.anchor, op, {\n        affinity: affinityAnchor\n      });\n      var focus = Point.transform(r.focus, op, {\n        affinity: affinityFocus\n      });\n\n      if (!anchor || !focus) {\n        return null;\n      }\n\n      r.anchor = anchor;\n      r.focus = focus;\n    });\n  }\n\n};\n\nvar RangeRef = {\n  /**\r\n   * Transform the range ref's current value by an operation.\r\n   */\n  transform(ref, op) {\n    var {\n      current,\n      affinity\n    } = ref;\n\n    if (current == null) {\n      return;\n    }\n\n    var path = Range.transform(current, op, {\n      affinity\n    });\n    ref.current = path;\n\n    if (path == null) {\n      ref.unref();\n    }\n  }\n\n};\n\nfunction ownKeys$4(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$4(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$4(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$4(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\nvar Text = {\n  /**\r\n   * Check if two text nodes are equal.\r\n   */\n  equals(text, another) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var {\n      loose = false\n    } = options;\n\n    for (var key in text) {\n      if (loose && key === 'text') {\n        continue;\n      }\n\n      if (text[key] !== another[key]) {\n        return false;\n      }\n    }\n\n    for (var _key in another) {\n      if (loose && _key === 'text') {\n        continue;\n      }\n\n      if (text[_key] !== another[_key]) {\n        return false;\n      }\n    }\n\n    return true;\n  },\n\n  /**\r\n   * Check if a value implements the `Text` interface.\r\n   */\n  isText(value) {\n    return isPlainObject(value) && typeof value.text === 'string';\n  },\n\n  /**\r\n   * Check if a value is a list of `Text` objects.\r\n   */\n  isTextList(value) {\n    return Array.isArray(value) && (value.length === 0 || Text.isText(value[0]));\n  },\n\n  /**\r\n   * Check if an text matches set of properties.\r\n   *\r\n   * Note: this is for matching custom properties, and it does not ensure that\r\n   * the `text` property are two nodes equal.\r\n   */\n  matches(text, props) {\n    for (var key in props) {\n      if (key === 'text') {\n        continue;\n      }\n\n      if (text[key] !== props[key]) {\n        return false;\n      }\n    }\n\n    return true;\n  },\n\n  /**\r\n   * Get the leaves for a text node given decorations.\r\n   */\n  decorations(node, decorations) {\n    var leaves = [_objectSpread$4({}, node)];\n\n    for (var dec of decorations) {\n      var rest = _objectWithoutProperties(dec, [\"anchor\", \"focus\"]);\n\n      var [start, end] = Range.edges(dec);\n      var next = [];\n      var o = 0;\n\n      for (var leaf of leaves) {\n        var {\n          length\n        } = leaf.text;\n        var offset = o;\n        o += length; // If the range encompases the entire leaf, add the range.\n\n        if (start.offset <= offset && end.offset >= offset + length) {\n          Object.assign(leaf, rest);\n          next.push(leaf);\n          continue;\n        } // If the range starts after the leaf, or ends before it, continue.\n\n\n        if (start.offset > offset + length || end.offset < offset || end.offset === offset && offset !== 0) {\n          next.push(leaf);\n          continue;\n        } // Otherwise we need to split the leaf, at the start, end, or both,\n        // and add the range to the middle intersecting section. Do the end\n        // split first since we don't need to update the offset that way.\n\n\n        var middle = leaf;\n        var before = void 0;\n        var after = void 0;\n\n        if (end.offset < offset + length) {\n          var off = end.offset - offset;\n          after = _objectSpread$4({}, middle, {\n            text: middle.text.slice(off)\n          });\n          middle = _objectSpread$4({}, middle, {\n            text: middle.text.slice(0, off)\n          });\n        }\n\n        if (start.offset > offset) {\n          var _off = start.offset - offset;\n\n          before = _objectSpread$4({}, middle, {\n            text: middle.text.slice(0, _off)\n          });\n          middle = _objectSpread$4({}, middle, {\n            text: middle.text.slice(_off)\n          });\n        }\n\n        Object.assign(middle, rest);\n\n        if (before) {\n          next.push(before);\n        }\n\n        next.push(middle);\n\n        if (after) {\n          next.push(after);\n        }\n      }\n\n      leaves = next;\n    }\n\n    return leaves;\n  }\n\n};\n\nfunction ownKeys$5(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$5(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$5(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$5(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\nvar GeneralTransforms = {\n  /**\r\n   * Transform the editor by an operation.\r\n   */\n  transform(editor, op) {\n    editor.children = createDraft(editor.children);\n    var selection = editor.selection && createDraft(editor.selection);\n\n    switch (op.type) {\n      case 'insert_node':\n        {\n          var {\n            path,\n            node\n          } = op;\n          var parent = Node.parent(editor, path);\n          var index = path[path.length - 1];\n          parent.children.splice(index, 0, node);\n\n          if (selection) {\n            for (var [point, key] of Range.points(selection)) {\n              selection[key] = Point.transform(point, op);\n            }\n          }\n\n          break;\n        }\n\n      case 'insert_text':\n        {\n          var {\n            path: _path,\n            offset,\n            text\n          } = op;\n\n          var _node = Node.leaf(editor, _path);\n\n          var before = _node.text.slice(0, offset);\n\n          var after = _node.text.slice(offset);\n\n          _node.text = before + text + after;\n\n          if (selection) {\n            for (var [_point, _key] of Range.points(selection)) {\n              selection[_key] = Point.transform(_point, op);\n            }\n          }\n\n          break;\n        }\n\n      case 'merge_node':\n        {\n          var {\n            path: _path2\n          } = op;\n\n          var _node2 = Node.get(editor, _path2);\n\n          var prevPath = Path.previous(_path2);\n          var prev = Node.get(editor, prevPath);\n\n          var _parent = Node.parent(editor, _path2);\n\n          var _index = _path2[_path2.length - 1];\n\n          if (Text.isText(_node2) && Text.isText(prev)) {\n            prev.text += _node2.text;\n          } else if (!Text.isText(_node2) && !Text.isText(prev)) {\n            prev.children.push(..._node2.children);\n          } else {\n            throw new Error(\"Cannot apply a \\\"merge_node\\\" operation at path [\".concat(_path2, \"] to nodes of different interaces: \").concat(_node2, \" \").concat(prev));\n          }\n\n          _parent.children.splice(_index, 1);\n\n          if (selection) {\n            for (var [_point2, _key2] of Range.points(selection)) {\n              selection[_key2] = Point.transform(_point2, op);\n            }\n          }\n\n          break;\n        }\n\n      case 'move_node':\n        {\n          var {\n            path: _path3,\n            newPath\n          } = op;\n\n          if (Path.isAncestor(_path3, newPath)) {\n            throw new Error(\"Cannot move a path [\".concat(_path3, \"] to new path [\").concat(newPath, \"] because the destination is inside itself.\"));\n          }\n\n          var _node3 = Node.get(editor, _path3);\n\n          var _parent2 = Node.parent(editor, _path3);\n\n          var _index2 = _path3[_path3.length - 1]; // This is tricky, but since the `path` and `newPath` both refer to\n          // the same snapshot in time, there's a mismatch. After either\n          // removing the original position, the second step's path can be out\n          // of date. So instead of using the `op.newPath` directly, we\n          // transform `op.path` to ascertain what the `newPath` would be after\n          // the operation was applied.\n\n          _parent2.children.splice(_index2, 1);\n\n          var truePath = Path.transform(_path3, op);\n          var newParent = Node.get(editor, Path.parent(truePath));\n          var newIndex = truePath[truePath.length - 1];\n          newParent.children.splice(newIndex, 0, _node3);\n\n          if (selection) {\n            for (var [_point3, _key3] of Range.points(selection)) {\n              selection[_key3] = Point.transform(_point3, op);\n            }\n          }\n\n          break;\n        }\n\n      case 'remove_node':\n        {\n          var {\n            path: _path4\n          } = op;\n          var _index3 = _path4[_path4.length - 1];\n\n          var _parent3 = Node.parent(editor, _path4);\n\n          _parent3.children.splice(_index3, 1); // Transform all of the points in the value, but if the point was in the\n          // node that was removed we need to update the range or remove it.\n\n\n          if (selection) {\n            for (var [_point4, _key4] of Range.points(selection)) {\n              var result = Point.transform(_point4, op);\n\n              if (selection != null && result != null) {\n                selection[_key4] = result;\n              } else {\n                var _prev = void 0;\n\n                var next = void 0;\n\n                for (var [n, p] of Node.texts(editor)) {\n                  if (Path.compare(p, _path4) === -1) {\n                    _prev = [n, p];\n                  } else {\n                    next = [n, p];\n                    break;\n                  }\n                }\n\n                if (_prev) {\n                  _point4.path = _prev[1];\n                  _point4.offset = _prev[0].text.length;\n                } else if (next) {\n                  _point4.path = next[1];\n                  _point4.offset = 0;\n                } else {\n                  selection = null;\n                }\n              }\n            }\n          }\n\n          break;\n        }\n\n      case 'remove_text':\n        {\n          var {\n            path: _path5,\n            offset: _offset,\n            text: _text\n          } = op;\n\n          var _node4 = Node.leaf(editor, _path5);\n\n          var _before = _node4.text.slice(0, _offset);\n\n          var _after = _node4.text.slice(_offset + _text.length);\n\n          _node4.text = _before + _after;\n\n          if (selection) {\n            for (var [_point5, _key5] of Range.points(selection)) {\n              selection[_key5] = Point.transform(_point5, op);\n            }\n          }\n\n          break;\n        }\n\n      case 'set_node':\n        {\n          var {\n            path: _path6,\n            newProperties\n          } = op;\n\n          if (_path6.length === 0) {\n            throw new Error(\"Cannot set properties on the root node!\");\n          }\n\n          var _node5 = Node.get(editor, _path6);\n\n          for (var _key6 in newProperties) {\n            if (_key6 === 'children' || _key6 === 'text') {\n              throw new Error(\"Cannot set the \\\"\".concat(_key6, \"\\\" property of nodes!\"));\n            }\n\n            var value = newProperties[_key6];\n\n            if (value == null) {\n              delete _node5[_key6];\n            } else {\n              _node5[_key6] = value;\n            }\n          }\n\n          break;\n        }\n\n      case 'set_selection':\n        {\n          var {\n            newProperties: _newProperties\n          } = op;\n\n          if (_newProperties == null) {\n            selection = _newProperties;\n          } else if (selection == null) {\n            if (!Range.isRange(_newProperties)) {\n              throw new Error(\"Cannot apply an incomplete \\\"set_selection\\\" operation properties \".concat(JSON.stringify(_newProperties), \" when there is no current selection.\"));\n            }\n\n            selection = _newProperties;\n          } else {\n            Object.assign(selection, _newProperties);\n          }\n\n          break;\n        }\n\n      case 'split_node':\n        {\n          var {\n            path: _path7,\n            position,\n            properties\n          } = op;\n\n          if (_path7.length === 0) {\n            throw new Error(\"Cannot apply a \\\"split_node\\\" operation at path [\".concat(_path7, \"] because the root node cannot be split.\"));\n          }\n\n          var _node6 = Node.get(editor, _path7);\n\n          var _parent4 = Node.parent(editor, _path7);\n\n          var _index4 = _path7[_path7.length - 1];\n          var newNode;\n\n          if (Text.isText(_node6)) {\n            var _before2 = _node6.text.slice(0, position);\n\n            var _after2 = _node6.text.slice(position);\n\n            _node6.text = _before2;\n            newNode = _objectSpread$5({}, _node6, {}, properties, {\n              text: _after2\n            });\n          } else {\n            var _before3 = _node6.children.slice(0, position);\n\n            var _after3 = _node6.children.slice(position);\n\n            _node6.children = _before3;\n            newNode = _objectSpread$5({}, _node6, {}, properties, {\n              children: _after3\n            });\n          }\n\n          _parent4.children.splice(_index4 + 1, 0, newNode);\n\n          if (selection) {\n            for (var [_point6, _key7] of Range.points(selection)) {\n              selection[_key7] = Point.transform(_point6, op);\n            }\n          }\n\n          break;\n        }\n    }\n\n    editor.children = finishDraft(editor.children);\n\n    if (selection) {\n      editor.selection = isDraft(selection) ? finishDraft(selection) : selection;\n    } else {\n      editor.selection = null;\n    }\n  }\n\n};\n\nfunction ownKeys$6(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$6(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$6(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$6(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\nvar NodeTransforms = {\n  /**\r\n   * Insert nodes at a specific location in the Editor.\r\n   */\n  insertNodes(editor, nodes) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        hanging = false,\n        voids = false,\n        mode = 'lowest'\n      } = options;\n      var {\n        at,\n        match,\n        select\n      } = options;\n\n      if (Node.isNode(nodes)) {\n        nodes = [nodes];\n      }\n\n      if (nodes.length === 0) {\n        return;\n      }\n\n      var [node] = nodes; // By default, use the selection as the target location. But if there is\n      // no selection, insert at the end of the document since that is such a\n      // common use case when inserting from a non-selected state.\n\n      if (!at) {\n        if (editor.selection) {\n          at = editor.selection;\n        } else if (editor.children.length > 0) {\n          at = Editor.end(editor, []);\n        } else {\n          at = [0];\n        }\n\n        select = true;\n      }\n\n      if (select == null) {\n        select = false;\n      }\n\n      if (Range.isRange(at)) {\n        if (!hanging) {\n          at = Editor.unhangRange(editor, at);\n        }\n\n        if (Range.isCollapsed(at)) {\n          at = at.anchor;\n        } else {\n          var [, end] = Range.edges(at);\n          var pointRef = Editor.pointRef(editor, end);\n          Transforms.delete(editor, {\n            at\n          });\n          at = pointRef.unref();\n        }\n      }\n\n      if (Point.isPoint(at)) {\n        if (match == null) {\n          if (Text.isText(node)) {\n            match = n => Text.isText(n);\n          } else if (editor.isInline(node)) {\n            match = n => Text.isText(n) || Editor.isInline(editor, n);\n          } else {\n            match = n => Editor.isBlock(editor, n);\n          }\n        }\n\n        var [entry] = Editor.nodes(editor, {\n          at: at.path,\n          match,\n          mode,\n          voids\n        });\n\n        if (entry) {\n          var [, _matchPath] = entry;\n          var pathRef = Editor.pathRef(editor, _matchPath);\n          var isAtEnd = Editor.isEnd(editor, at, _matchPath);\n          Transforms.splitNodes(editor, {\n            at,\n            match,\n            mode,\n            voids\n          });\n          var path = pathRef.unref();\n          at = isAtEnd ? Path.next(path) : path;\n        } else {\n          return;\n        }\n      }\n\n      var parentPath = Path.parent(at);\n      var index = at[at.length - 1];\n\n      if (!voids && Editor.void(editor, {\n        at: parentPath\n      })) {\n        return;\n      }\n\n      for (var _node of nodes) {\n        var _path = parentPath.concat(index);\n\n        index++;\n        editor.apply({\n          type: 'insert_node',\n          path: _path,\n          node: _node\n        });\n      }\n\n      if (select) {\n        var point = Editor.end(editor, at);\n\n        if (point) {\n          Transforms.select(editor, point);\n        }\n      }\n    });\n  },\n\n  /**\r\n   * Lift nodes at a specific location upwards in the document tree, splitting\r\n   * their parent in two if necessary.\r\n   */\n  liftNodes(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        at = editor.selection,\n        mode = 'lowest',\n        voids = false\n      } = options;\n      var {\n        match\n      } = options;\n\n      if (match == null) {\n        match = Path.isPath(at) ? matchPath(editor, at) : n => Editor.isBlock(editor, n);\n      }\n\n      if (!at) {\n        return;\n      }\n\n      var matches = Editor.nodes(editor, {\n        at,\n        match,\n        mode,\n        voids\n      });\n      var pathRefs = Array.from(matches, (_ref) => {\n        var [, p] = _ref;\n        return Editor.pathRef(editor, p);\n      });\n\n      for (var pathRef of pathRefs) {\n        var path = pathRef.unref();\n\n        if (path.length < 2) {\n          throw new Error(\"Cannot lift node at a path [\".concat(path, \"] because it has a depth of less than `2`.\"));\n        }\n\n        var parentNodeEntry = Editor.node(editor, Path.parent(path));\n        var [parent, parentPath] = parentNodeEntry;\n        var index = path[path.length - 1];\n        var {\n          length\n        } = parent.children;\n\n        if (length === 1) {\n          var toPath = Path.next(parentPath);\n          Transforms.moveNodes(editor, {\n            at: path,\n            to: toPath,\n            voids\n          });\n          Transforms.removeNodes(editor, {\n            at: parentPath,\n            voids\n          });\n        } else if (index === 0) {\n          Transforms.moveNodes(editor, {\n            at: path,\n            to: parentPath,\n            voids\n          });\n        } else if (index === length - 1) {\n          var _toPath = Path.next(parentPath);\n\n          Transforms.moveNodes(editor, {\n            at: path,\n            to: _toPath,\n            voids\n          });\n        } else {\n          var splitPath = Path.next(path);\n\n          var _toPath2 = Path.next(parentPath);\n\n          Transforms.splitNodes(editor, {\n            at: splitPath,\n            voids\n          });\n          Transforms.moveNodes(editor, {\n            at: path,\n            to: _toPath2,\n            voids\n          });\n        }\n      }\n    });\n  },\n\n  /**\r\n   * Merge a node at a location with the previous node of the same depth,\r\n   * removing any empty containing nodes after the merge if necessary.\r\n   */\n  mergeNodes(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        match,\n        at = editor.selection\n      } = options;\n      var {\n        hanging = false,\n        voids = false,\n        mode = 'lowest'\n      } = options;\n\n      if (!at) {\n        return;\n      }\n\n      if (match == null) {\n        if (Path.isPath(at)) {\n          var [parent] = Editor.parent(editor, at);\n\n          match = n => parent.children.includes(n);\n        } else {\n          match = n => Editor.isBlock(editor, n);\n        }\n      }\n\n      if (!hanging && Range.isRange(at)) {\n        at = Editor.unhangRange(editor, at);\n      }\n\n      if (Range.isRange(at)) {\n        if (Range.isCollapsed(at)) {\n          at = at.anchor;\n        } else {\n          var [, end] = Range.edges(at);\n          var pointRef = Editor.pointRef(editor, end);\n          Transforms.delete(editor, {\n            at\n          });\n          at = pointRef.unref();\n\n          if (options.at == null) {\n            Transforms.select(editor, at);\n          }\n        }\n      }\n\n      var [current] = Editor.nodes(editor, {\n        at,\n        match,\n        voids,\n        mode\n      });\n      var prev = Editor.previous(editor, {\n        at,\n        match,\n        voids,\n        mode\n      });\n\n      if (!current || !prev) {\n        return;\n      }\n\n      var [node, path] = current;\n      var [prevNode, prevPath] = prev;\n\n      if (path.length === 0 || prevPath.length === 0) {\n        return;\n      }\n\n      var newPath = Path.next(prevPath);\n      var commonPath = Path.common(path, prevPath);\n      var isPreviousSibling = Path.isSibling(path, prevPath);\n      var levels = Array.from(Editor.levels(editor, {\n        at: path\n      }), (_ref2) => {\n        var [n] = _ref2;\n        return n;\n      }).slice(commonPath.length).slice(0, -1); // Determine if the merge will leave an ancestor of the path empty as a\n      // result, in which case we'll want to remove it after merging.\n\n      var emptyAncestor = Editor.above(editor, {\n        at: path,\n        mode: 'highest',\n        match: n => levels.includes(n) && Element.isElement(n) && n.children.length === 1\n      });\n      var emptyRef = emptyAncestor && Editor.pathRef(editor, emptyAncestor[1]);\n      var properties;\n      var position; // Ensure that the nodes are equivalent, and figure out what the position\n      // and extra properties of the merge will be.\n\n      if (Text.isText(node) && Text.isText(prevNode)) {\n        var rest = _objectWithoutProperties(node, [\"text\"]);\n\n        position = prevNode.text.length;\n        properties = rest;\n      } else if (Element.isElement(node) && Element.isElement(prevNode)) {\n        var rest = _objectWithoutProperties(node, [\"children\"]);\n\n        position = prevNode.children.length;\n        properties = rest;\n      } else {\n        throw new Error(\"Cannot merge the node at path [\".concat(path, \"] with the previous sibling because it is not the same kind: \").concat(JSON.stringify(node), \" \").concat(JSON.stringify(prevNode)));\n      } // If the node isn't already the next sibling of the previous node, move\n      // it so that it is before merging.\n\n\n      if (!isPreviousSibling) {\n        Transforms.moveNodes(editor, {\n          at: path,\n          to: newPath,\n          voids\n        });\n      } // If there was going to be an empty ancestor of the node that was merged,\n      // we remove it from the tree.\n\n\n      if (emptyRef) {\n        Transforms.removeNodes(editor, {\n          at: emptyRef.current,\n          voids\n        });\n      } // If the target node that we're merging with is empty, remove it instead\n      // of merging the two. This is a common rich text editor behavior to\n      // prevent losing formatting when deleting entire nodes when you have a\n      // hanging selection.\n\n\n      if (Element.isElement(prevNode) && Editor.isEmpty(editor, prevNode) || Text.isText(prevNode) && prevNode.text === '') {\n        Transforms.removeNodes(editor, {\n          at: prevPath,\n          voids\n        });\n      } else {\n        editor.apply({\n          type: 'merge_node',\n          path: newPath,\n          position,\n          target: null,\n          properties\n        });\n      }\n\n      if (emptyRef) {\n        emptyRef.unref();\n      }\n    });\n  },\n\n  /**\r\n   * Move the nodes at a location to a new location.\r\n   */\n  moveNodes(editor, options) {\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        to,\n        at = editor.selection,\n        mode = 'lowest',\n        voids = false\n      } = options;\n      var {\n        match\n      } = options;\n\n      if (!at) {\n        return;\n      }\n\n      if (match == null) {\n        match = Path.isPath(at) ? matchPath(editor, at) : n => Editor.isBlock(editor, n);\n      }\n\n      var toRef = Editor.pathRef(editor, to);\n      var targets = Editor.nodes(editor, {\n        at,\n        match,\n        mode,\n        voids\n      });\n      var pathRefs = Array.from(targets, (_ref3) => {\n        var [, p] = _ref3;\n        return Editor.pathRef(editor, p);\n      });\n\n      for (var pathRef of pathRefs) {\n        var path = pathRef.unref();\n        var newPath = toRef.current;\n\n        if (path.length !== 0) {\n          editor.apply({\n            type: 'move_node',\n            path,\n            newPath\n          });\n        }\n      }\n\n      toRef.unref();\n    });\n  },\n\n  /**\r\n   * Remove the nodes at a specific location in the document.\r\n   */\n  removeNodes(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        hanging = false,\n        voids = false,\n        mode = 'lowest'\n      } = options;\n      var {\n        at = editor.selection,\n        match\n      } = options;\n\n      if (!at) {\n        return;\n      }\n\n      if (match == null) {\n        match = Path.isPath(at) ? matchPath(editor, at) : n => Editor.isBlock(editor, n);\n      }\n\n      if (!hanging && Range.isRange(at)) {\n        at = Editor.unhangRange(editor, at);\n      }\n\n      var depths = Editor.nodes(editor, {\n        at,\n        match,\n        mode,\n        voids\n      });\n      var pathRefs = Array.from(depths, (_ref4) => {\n        var [, p] = _ref4;\n        return Editor.pathRef(editor, p);\n      });\n\n      for (var pathRef of pathRefs) {\n        var path = pathRef.unref();\n\n        if (path) {\n          var [node] = Editor.node(editor, path);\n          editor.apply({\n            type: 'remove_node',\n            path,\n            node\n          });\n        }\n      }\n    });\n  },\n\n  /**\r\n   * Set new properties on the nodes at a location.\r\n   */\n  setNodes(editor, props) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        match,\n        at = editor.selection\n      } = options;\n      var {\n        hanging = false,\n        mode = 'lowest',\n        split = false,\n        voids = false\n      } = options;\n\n      if (!at) {\n        return;\n      }\n\n      if (match == null) {\n        match = Path.isPath(at) ? matchPath(editor, at) : n => Editor.isBlock(editor, n);\n      }\n\n      if (!hanging && Range.isRange(at)) {\n        at = Editor.unhangRange(editor, at);\n      }\n\n      if (split && Range.isRange(at)) {\n        var rangeRef = Editor.rangeRef(editor, at, {\n          affinity: 'inward'\n        });\n        var [start, end] = Range.edges(at);\n        var splitMode = mode === 'lowest' ? 'lowest' : 'highest';\n        Transforms.splitNodes(editor, {\n          at: end,\n          match,\n          mode: splitMode,\n          voids\n        });\n        Transforms.splitNodes(editor, {\n          at: start,\n          match,\n          mode: splitMode,\n          voids\n        });\n        at = rangeRef.unref();\n\n        if (options.at == null) {\n          Transforms.select(editor, at);\n        }\n      }\n\n      for (var [node, path] of Editor.nodes(editor, {\n        at,\n        match,\n        mode,\n        voids\n      })) {\n        var properties = {};\n        var newProperties = {}; // You can't set properties on the editor node.\n\n        if (path.length === 0) {\n          continue;\n        }\n\n        for (var k in props) {\n          if (k === 'children' || k === 'text') {\n            continue;\n          }\n\n          if (props[k] !== node[k]) {\n            properties[k] = node[k];\n            newProperties[k] = props[k];\n          }\n        }\n\n        if (Object.keys(newProperties).length !== 0) {\n          editor.apply({\n            type: 'set_node',\n            path,\n            properties,\n            newProperties\n          });\n        }\n      }\n    });\n  },\n\n  /**\r\n   * Split the nodes at a specific location.\r\n   */\n  splitNodes(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        mode = 'lowest',\n        voids = false\n      } = options;\n      var {\n        match,\n        at = editor.selection,\n        height = 0,\n        always = false\n      } = options;\n\n      if (match == null) {\n        match = n => Editor.isBlock(editor, n);\n      }\n\n      if (Range.isRange(at)) {\n        at = deleteRange(editor, at);\n      } // If the target is a path, the default height-skipping and position\n      // counters need to account for us potentially splitting at a non-leaf.\n\n\n      if (Path.isPath(at)) {\n        var path = at;\n        var point = Editor.point(editor, path);\n        var [parent] = Editor.parent(editor, path);\n\n        match = n => n === parent;\n\n        height = point.path.length - path.length + 1;\n        at = point;\n        always = true;\n      }\n\n      if (!at) {\n        return;\n      }\n\n      var beforeRef = Editor.pointRef(editor, at, {\n        affinity: 'backward'\n      });\n      var [highest] = Editor.nodes(editor, {\n        at,\n        match,\n        mode,\n        voids\n      });\n\n      if (!highest) {\n        return;\n      }\n\n      var voidMatch = Editor.void(editor, {\n        at,\n        mode: 'highest'\n      });\n      var nudge = 0;\n\n      if (!voids && voidMatch) {\n        var [voidNode, voidPath] = voidMatch;\n\n        if (Element.isElement(voidNode) && editor.isInline(voidNode)) {\n          var after = Editor.after(editor, voidPath);\n\n          if (!after) {\n            var text = {\n              text: ''\n            };\n            var afterPath = Path.next(voidPath);\n            Transforms.insertNodes(editor, text, {\n              at: afterPath,\n              voids\n            });\n            after = Editor.point(editor, afterPath);\n          }\n\n          at = after;\n          always = true;\n        }\n\n        var siblingHeight = at.path.length - voidPath.length;\n        height = siblingHeight + 1;\n        always = true;\n      }\n\n      var afterRef = Editor.pointRef(editor, at);\n      var depth = at.path.length - height;\n      var [, highestPath] = highest;\n      var lowestPath = at.path.slice(0, depth);\n      var position = height === 0 ? at.offset : at.path[depth] + nudge;\n      var target = null;\n\n      for (var [node, _path2] of Editor.levels(editor, {\n        at: lowestPath,\n        reverse: true,\n        voids\n      })) {\n        var split = false;\n\n        if (_path2.length < highestPath.length || _path2.length === 0 || !voids && Editor.isVoid(editor, node)) {\n          break;\n        }\n\n        var _point = beforeRef.current;\n        var isEnd = Editor.isEnd(editor, _point, _path2);\n\n        if (always || !beforeRef || !Editor.isEdge(editor, _point, _path2)) {\n          split = true;\n\n          var properties = _objectWithoutProperties(node, [\"text\", \"children\"]);\n\n          editor.apply({\n            type: 'split_node',\n            path: _path2,\n            position,\n            target,\n            properties\n          });\n        }\n\n        target = position;\n        position = _path2[_path2.length - 1] + (split || isEnd ? 1 : 0);\n      }\n\n      if (options.at == null) {\n        var _point2 = afterRef.current || Editor.end(editor, []);\n\n        Transforms.select(editor, _point2);\n      }\n\n      beforeRef.unref();\n      afterRef.unref();\n    });\n  },\n\n  /**\r\n   * Unset properties on the nodes at a location.\r\n   */\n  unsetNodes(editor, props) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n    if (!Array.isArray(props)) {\n      props = [props];\n    }\n\n    var obj = {};\n\n    for (var key of props) {\n      obj[key] = null;\n    }\n\n    Transforms.setNodes(editor, obj, options);\n  },\n\n  /**\r\n   * Unwrap the nodes at a location from a parent node, splitting the parent if\r\n   * necessary to ensure that only the content in the range is unwrapped.\r\n   */\n  unwrapNodes(editor, options) {\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        mode = 'lowest',\n        split = false,\n        voids = false\n      } = options;\n      var {\n        at = editor.selection,\n        match\n      } = options;\n\n      if (!at) {\n        return;\n      }\n\n      if (match == null) {\n        match = Path.isPath(at) ? matchPath(editor, at) : n => Editor.isBlock(editor, n);\n      }\n\n      if (Path.isPath(at)) {\n        at = Editor.range(editor, at);\n      }\n\n      var rangeRef = Range.isRange(at) ? Editor.rangeRef(editor, at) : null;\n      var matches = Editor.nodes(editor, {\n        at,\n        match,\n        mode,\n        voids\n      });\n      var pathRefs = Array.from(matches, (_ref5) => {\n        var [, p] = _ref5;\n        return Editor.pathRef(editor, p);\n      });\n\n      var _loop = function _loop(pathRef) {\n        var path = pathRef.unref();\n        var [node] = Editor.node(editor, path);\n        var range = Editor.range(editor, path);\n\n        if (split && rangeRef) {\n          range = Range.intersection(rangeRef.current, range);\n        }\n\n        Transforms.liftNodes(editor, {\n          at: range,\n          match: n => node.children.includes(n),\n          voids\n        });\n      };\n\n      for (var pathRef of pathRefs) {\n        _loop(pathRef);\n      }\n\n      if (rangeRef) {\n        rangeRef.unref();\n      }\n    });\n  },\n\n  /**\r\n   * Wrap the nodes at a location in a new container node, splitting the edges\r\n   * of the range first to ensure that only the content in the range is wrapped.\r\n   */\n  wrapNodes(editor, element) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        mode = 'lowest',\n        split = false,\n        voids = false\n      } = options;\n      var {\n        match,\n        at = editor.selection\n      } = options;\n\n      if (!at) {\n        return;\n      }\n\n      if (match == null) {\n        if (Path.isPath(at)) {\n          match = matchPath(editor, at);\n        } else if (editor.isInline(element)) {\n          match = n => Editor.isInline(editor, n) || Text.isText(n);\n        } else {\n          match = n => Editor.isBlock(editor, n);\n        }\n      }\n\n      if (split && Range.isRange(at)) {\n        var [start, end] = Range.edges(at);\n        var rangeRef = Editor.rangeRef(editor, at, {\n          affinity: 'inward'\n        });\n        Transforms.splitNodes(editor, {\n          at: end,\n          match,\n          voids\n        });\n        Transforms.splitNodes(editor, {\n          at: start,\n          match,\n          voids\n        });\n        at = rangeRef.unref();\n\n        if (options.at == null) {\n          Transforms.select(editor, at);\n        }\n      }\n\n      var roots = Array.from(Editor.nodes(editor, {\n        at,\n        match: editor.isInline(element) ? n => Editor.isBlock(editor, n) : n => Editor.isEditor(n),\n        mode: 'lowest',\n        voids\n      }));\n\n      for (var [, rootPath] of roots) {\n        var a = Range.isRange(at) ? Range.intersection(at, Editor.range(editor, rootPath)) : at;\n\n        if (!a) {\n          continue;\n        }\n\n        var matches = Array.from(Editor.nodes(editor, {\n          at: a,\n          match,\n          mode,\n          voids\n        }));\n\n        if (matches.length > 0) {\n          (function () {\n            var [first] = matches;\n            var last = matches[matches.length - 1];\n            var [, firstPath] = first;\n            var [, lastPath] = last;\n            var commonPath = Path.equals(firstPath, lastPath) ? Path.parent(firstPath) : Path.common(firstPath, lastPath);\n            var range = Editor.range(editor, firstPath, lastPath);\n            var commonNodeEntry = Editor.node(editor, commonPath);\n            var [commonNode] = commonNodeEntry;\n            var depth = commonPath.length + 1;\n            var wrapperPath = Path.next(lastPath.slice(0, depth));\n\n            var wrapper = _objectSpread$6({}, element, {\n              children: []\n            });\n\n            Transforms.insertNodes(editor, wrapper, {\n              at: wrapperPath,\n              voids\n            });\n            Transforms.moveNodes(editor, {\n              at: range,\n              match: n => commonNode.children.includes(n),\n              to: wrapperPath.concat(0),\n              voids\n            });\n          })();\n        }\n      }\n    });\n  }\n\n};\n/**\r\n * Convert a range into a point by deleting it's content.\r\n */\n\nvar deleteRange = (editor, range) => {\n  if (Range.isCollapsed(range)) {\n    return range.anchor;\n  } else {\n    var [, end] = Range.edges(range);\n    var pointRef = Editor.pointRef(editor, end);\n    Transforms.delete(editor, {\n      at: range\n    });\n    return pointRef.unref();\n  }\n};\n\nvar matchPath = (editor, path) => {\n  var [node] = Editor.node(editor, path);\n  return n => n === node;\n};\n\nfunction ownKeys$7(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$7(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$7(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$7(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\nvar SelectionTransforms = {\n  /**\r\n   * Collapse the selection.\r\n   */\n  collapse(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      edge = 'anchor'\n    } = options;\n    var {\n      selection\n    } = editor;\n\n    if (!selection) {\n      return;\n    } else if (edge === 'anchor') {\n      Transforms.select(editor, selection.anchor);\n    } else if (edge === 'focus') {\n      Transforms.select(editor, selection.focus);\n    } else if (edge === 'start') {\n      var [start] = Range.edges(selection);\n      Transforms.select(editor, start);\n    } else if (edge === 'end') {\n      var [, end] = Range.edges(selection);\n      Transforms.select(editor, end);\n    }\n  },\n\n  /**\r\n   * Unset the selection.\r\n   */\n  deselect(editor) {\n    var {\n      selection\n    } = editor;\n\n    if (selection) {\n      editor.apply({\n        type: 'set_selection',\n        properties: selection,\n        newProperties: null\n      });\n    }\n  },\n\n  /**\r\n   * Move the selection's point forward or backward.\r\n   */\n  move(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      selection\n    } = editor;\n    var {\n      distance = 1,\n      unit = 'character',\n      reverse = false\n    } = options;\n    var {\n      edge = null\n    } = options;\n\n    if (!selection) {\n      return;\n    }\n\n    if (edge === 'start') {\n      edge = Range.isBackward(selection) ? 'focus' : 'anchor';\n    }\n\n    if (edge === 'end') {\n      edge = Range.isBackward(selection) ? 'anchor' : 'focus';\n    }\n\n    var {\n      anchor,\n      focus\n    } = selection;\n    var opts = {\n      distance,\n      unit\n    };\n    var props = {};\n\n    if (edge == null || edge === 'anchor') {\n      var point = reverse ? Editor.before(editor, anchor, opts) : Editor.after(editor, anchor, opts);\n\n      if (point) {\n        props.anchor = point;\n      }\n    }\n\n    if (edge == null || edge === 'focus') {\n      var _point = reverse ? Editor.before(editor, focus, opts) : Editor.after(editor, focus, opts);\n\n      if (_point) {\n        props.focus = _point;\n      }\n    }\n\n    Transforms.setSelection(editor, props);\n  },\n\n  /**\r\n   * Set the selection to a new value.\r\n   */\n  select(editor, target) {\n    var {\n      selection\n    } = editor;\n    target = Editor.range(editor, target);\n\n    if (selection) {\n      Transforms.setSelection(editor, target);\n      return;\n    }\n\n    if (!Range.isRange(target)) {\n      throw new Error(\"When setting the selection and the current selection is `null` you must provide at least an `anchor` and `focus`, but you passed: \".concat(JSON.stringify(target)));\n    }\n\n    editor.apply({\n      type: 'set_selection',\n      properties: selection,\n      newProperties: target\n    });\n  },\n\n  /**\r\n   * Set new properties on one of the selection's points.\r\n   */\n  setPoint(editor, props, options) {\n    var {\n      selection\n    } = editor;\n    var {\n      edge = 'both'\n    } = options;\n\n    if (!selection) {\n      return;\n    }\n\n    if (edge === 'start') {\n      edge = Range.isBackward(selection) ? 'focus' : 'anchor';\n    }\n\n    if (edge === 'end') {\n      edge = Range.isBackward(selection) ? 'anchor' : 'focus';\n    }\n\n    var {\n      anchor,\n      focus\n    } = selection;\n    var point = edge === 'anchor' ? anchor : focus;\n    Transforms.setSelection(editor, {\n      [edge === 'anchor' ? 'anchor' : 'focus']: _objectSpread$7({}, point, {}, props)\n    });\n  },\n\n  /**\r\n   * Set new properties on the selection.\r\n   */\n  setSelection(editor, props) {\n    var {\n      selection\n    } = editor;\n    var oldProps = {};\n    var newProps = {};\n\n    if (!selection) {\n      return;\n    }\n\n    for (var k in props) {\n      if (k === 'anchor' && props.anchor != null && !Point.equals(props.anchor, selection.anchor) || k === 'focus' && props.focus != null && !Point.equals(props.focus, selection.focus) || k !== 'anchor' && k !== 'focus' && props[k] !== selection[k]) {\n        oldProps[k] = selection[k];\n        newProps[k] = props[k];\n      }\n    }\n\n    if (Object.keys(oldProps).length > 0) {\n      editor.apply({\n        type: 'set_selection',\n        properties: oldProps,\n        newProperties: newProps\n      });\n    }\n  }\n\n};\n\nvar TextTransforms = {\n  /**\r\n   * Delete content in the editor.\r\n   */\n  delete(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        reverse = false,\n        unit = 'character',\n        distance = 1,\n        voids = false\n      } = options;\n      var {\n        at = editor.selection,\n        hanging = false\n      } = options;\n\n      if (!at) {\n        return;\n      }\n\n      if (Range.isRange(at) && Range.isCollapsed(at)) {\n        at = at.anchor;\n      }\n\n      if (Point.isPoint(at)) {\n        var furthestVoid = Editor.void(editor, {\n          at,\n          mode: 'highest'\n        });\n\n        if (!voids && furthestVoid) {\n          var [, voidPath] = furthestVoid;\n          at = voidPath;\n        } else {\n          var opts = {\n            unit,\n            distance\n          };\n          var target = reverse ? Editor.before(editor, at, opts) || Editor.start(editor, []) : Editor.after(editor, at, opts) || Editor.end(editor, []);\n          at = {\n            anchor: at,\n            focus: target\n          };\n          hanging = true;\n        }\n      }\n\n      if (Path.isPath(at)) {\n        Transforms.removeNodes(editor, {\n          at,\n          voids\n        });\n        return;\n      }\n\n      if (Range.isCollapsed(at)) {\n        return;\n      }\n\n      if (!hanging) {\n        at = Editor.unhangRange(editor, at, {\n          voids\n        });\n      }\n\n      var [start, end] = Range.edges(at);\n      var startBlock = Editor.above(editor, {\n        match: n => Editor.isBlock(editor, n),\n        at: start,\n        voids\n      });\n      var endBlock = Editor.above(editor, {\n        match: n => Editor.isBlock(editor, n),\n        at: end,\n        voids\n      });\n      var isAcrossBlocks = startBlock && endBlock && !Path.equals(startBlock[1], endBlock[1]);\n      var isSingleText = Path.equals(start.path, end.path);\n      var startVoid = voids ? null : Editor.void(editor, {\n        at: start,\n        mode: 'highest'\n      });\n      var endVoid = voids ? null : Editor.void(editor, {\n        at: end,\n        mode: 'highest'\n      }); // If the start or end points are inside an inline void, nudge them out.\n\n      if (startVoid) {\n        var before = Editor.before(editor, start);\n\n        if (before && startBlock && Path.isAncestor(startBlock[1], before.path)) {\n          start = before;\n        }\n      }\n\n      if (endVoid) {\n        var after = Editor.after(editor, end);\n\n        if (after && endBlock && Path.isAncestor(endBlock[1], after.path)) {\n          end = after;\n        }\n      } // Get the highest nodes that are completely inside the range, as well as\n      // the start and end nodes.\n\n\n      var matches = [];\n      var lastPath;\n\n      for (var entry of Editor.nodes(editor, {\n        at,\n        voids\n      })) {\n        var [node, path] = entry;\n\n        if (lastPath && Path.compare(path, lastPath) === 0) {\n          continue;\n        }\n\n        if (!voids && Editor.isVoid(editor, node) || !Path.isCommon(path, start.path) && !Path.isCommon(path, end.path)) {\n          matches.push(entry);\n          lastPath = path;\n        }\n      }\n\n      var pathRefs = Array.from(matches, (_ref) => {\n        var [, p] = _ref;\n        return Editor.pathRef(editor, p);\n      });\n      var startRef = Editor.pointRef(editor, start);\n      var endRef = Editor.pointRef(editor, end);\n\n      if (!isSingleText && !startVoid) {\n        var _point = startRef.current;\n        var [_node] = Editor.leaf(editor, _point);\n        var {\n          path: _path\n        } = _point;\n        var {\n          offset\n        } = start;\n\n        var text = _node.text.slice(offset);\n\n        editor.apply({\n          type: 'remove_text',\n          path: _path,\n          offset,\n          text\n        });\n      }\n\n      for (var pathRef of pathRefs) {\n        var _path2 = pathRef.unref();\n\n        Transforms.removeNodes(editor, {\n          at: _path2,\n          voids\n        });\n      }\n\n      if (!endVoid) {\n        var _point2 = endRef.current;\n        var [_node2] = Editor.leaf(editor, _point2);\n        var {\n          path: _path3\n        } = _point2;\n\n        var _offset = isSingleText ? start.offset : 0;\n\n        var _text = _node2.text.slice(_offset, end.offset);\n\n        editor.apply({\n          type: 'remove_text',\n          path: _path3,\n          offset: _offset,\n          text: _text\n        });\n      }\n\n      if (!isSingleText && isAcrossBlocks && endRef.current && startRef.current) {\n        Transforms.mergeNodes(editor, {\n          at: endRef.current,\n          hanging: true,\n          voids\n        });\n      }\n\n      var point = endRef.unref() || startRef.unref();\n\n      if (options.at == null && point) {\n        Transforms.select(editor, point);\n      }\n    });\n  },\n\n  /**\r\n   * Insert a fragment at a specific location in the editor.\r\n   */\n  insertFragment(editor, fragment) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        hanging = false,\n        voids = false\n      } = options;\n      var {\n        at = editor.selection\n      } = options;\n\n      if (!fragment.length) {\n        return;\n      }\n\n      if (!at) {\n        return;\n      } else if (Range.isRange(at)) {\n        if (!hanging) {\n          at = Editor.unhangRange(editor, at);\n        }\n\n        if (Range.isCollapsed(at)) {\n          at = at.anchor;\n        } else {\n          var [, end] = Range.edges(at);\n\n          if (!voids && Editor.void(editor, {\n            at: end\n          })) {\n            return;\n          }\n\n          var pointRef = Editor.pointRef(editor, end);\n          Transforms.delete(editor, {\n            at\n          });\n          at = pointRef.unref();\n        }\n      } else if (Path.isPath(at)) {\n        at = Editor.start(editor, at);\n      }\n\n      if (!voids && Editor.void(editor, {\n        at\n      })) {\n        return;\n      } // If the insert point is at the edge of an inline node, move it outside\n      // instead since it will need to be split otherwise.\n\n\n      var inlineElementMatch = Editor.above(editor, {\n        at,\n        match: n => Editor.isInline(editor, n),\n        mode: 'highest',\n        voids\n      });\n\n      if (inlineElementMatch) {\n        var [, _inlinePath] = inlineElementMatch;\n\n        if (Editor.isEnd(editor, at, _inlinePath)) {\n          var after = Editor.after(editor, _inlinePath);\n          at = after;\n        } else if (Editor.isStart(editor, at, _inlinePath)) {\n          var before = Editor.before(editor, _inlinePath);\n          at = before;\n        }\n      }\n\n      var blockMatch = Editor.above(editor, {\n        match: n => Editor.isBlock(editor, n),\n        at,\n        voids\n      });\n      var [, blockPath] = blockMatch;\n      var isBlockStart = Editor.isStart(editor, at, blockPath);\n      var isBlockEnd = Editor.isEnd(editor, at, blockPath);\n      var mergeStart = !isBlockStart || isBlockStart && isBlockEnd;\n      var mergeEnd = !isBlockEnd;\n      var [, firstPath] = Node.first({\n        children: fragment\n      }, []);\n      var [, lastPath] = Node.last({\n        children: fragment\n      }, []);\n      var matches = [];\n\n      var matcher = (_ref2) => {\n        var [n, p] = _ref2;\n\n        if (mergeStart && Path.isAncestor(p, firstPath) && Element.isElement(n) && !editor.isVoid(n) && !editor.isInline(n)) {\n          return false;\n        }\n\n        if (mergeEnd && Path.isAncestor(p, lastPath) && Element.isElement(n) && !editor.isVoid(n) && !editor.isInline(n)) {\n          return false;\n        }\n\n        return true;\n      };\n\n      for (var entry of Node.nodes({\n        children: fragment\n      }, {\n        pass: matcher\n      })) {\n        if (entry[1].length > 0 && matcher(entry)) {\n          matches.push(entry);\n        }\n      }\n\n      var starts = [];\n      var middles = [];\n      var ends = [];\n      var starting = true;\n      var hasBlocks = false;\n\n      for (var [node] of matches) {\n        if (Element.isElement(node) && !editor.isInline(node)) {\n          starting = false;\n          hasBlocks = true;\n          middles.push(node);\n        } else if (starting) {\n          starts.push(node);\n        } else {\n          ends.push(node);\n        }\n      }\n\n      var [inlineMatch] = Editor.nodes(editor, {\n        at,\n        match: n => Text.isText(n) || Editor.isInline(editor, n),\n        mode: 'highest',\n        voids\n      });\n      var [, inlinePath] = inlineMatch;\n      var isInlineStart = Editor.isStart(editor, at, inlinePath);\n      var isInlineEnd = Editor.isEnd(editor, at, inlinePath);\n      var middleRef = Editor.pathRef(editor, isBlockEnd ? Path.next(blockPath) : blockPath);\n      var endRef = Editor.pathRef(editor, isInlineEnd ? Path.next(inlinePath) : inlinePath);\n      Transforms.splitNodes(editor, {\n        at,\n        match: n => hasBlocks ? Editor.isBlock(editor, n) : Text.isText(n) || Editor.isInline(editor, n),\n        mode: hasBlocks ? 'lowest' : 'highest',\n        voids\n      });\n      var startRef = Editor.pathRef(editor, !isInlineStart || isInlineStart && isInlineEnd ? Path.next(inlinePath) : inlinePath);\n      Transforms.insertNodes(editor, starts, {\n        at: startRef.current,\n        match: n => Text.isText(n) || Editor.isInline(editor, n),\n        mode: 'highest',\n        voids\n      });\n      Transforms.insertNodes(editor, middles, {\n        at: middleRef.current,\n        match: n => Editor.isBlock(editor, n),\n        mode: 'lowest',\n        voids\n      });\n      Transforms.insertNodes(editor, ends, {\n        at: endRef.current,\n        match: n => Text.isText(n) || Editor.isInline(editor, n),\n        mode: 'highest',\n        voids\n      });\n\n      if (!options.at) {\n        var path;\n\n        if (ends.length > 0) {\n          path = Path.previous(endRef.current);\n        } else if (middles.length > 0) {\n          path = Path.previous(middleRef.current);\n        } else {\n          path = Path.previous(startRef.current);\n        }\n\n        var _end = Editor.end(editor, path);\n\n        Transforms.select(editor, _end);\n      }\n\n      startRef.unref();\n      middleRef.unref();\n      endRef.unref();\n    });\n  },\n\n  /**\r\n   * Insert a string of text in the Editor.\r\n   */\n  insertText(editor, text) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        voids = false\n      } = options;\n      var {\n        at = editor.selection\n      } = options;\n\n      if (!at) {\n        return;\n      }\n\n      if (Path.isPath(at)) {\n        at = Editor.range(editor, at);\n      }\n\n      if (Range.isRange(at)) {\n        if (Range.isCollapsed(at)) {\n          at = at.anchor;\n        } else {\n          var end = Range.end(at);\n\n          if (!voids && Editor.void(editor, {\n            at: end\n          })) {\n            return;\n          }\n\n          var pointRef = Editor.pointRef(editor, end);\n          Transforms.delete(editor, {\n            at,\n            voids\n          });\n          at = pointRef.unref();\n          Transforms.setSelection(editor, {\n            anchor: at,\n            focus: at\n          });\n        }\n      }\n\n      if (!voids && Editor.void(editor, {\n        at\n      })) {\n        return;\n      }\n\n      var {\n        path,\n        offset\n      } = at;\n      editor.apply({\n        type: 'insert_text',\n        path,\n        offset,\n        text\n      });\n    });\n  }\n\n};\n\nfunction ownKeys$8(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$8(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$8(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$8(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\nvar Transforms = _objectSpread$8({}, GeneralTransforms, {}, NodeTransforms, {}, SelectionTransforms, {}, TextTransforms);\n\nfunction ownKeys$9(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$9(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$9(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$9(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n/**\r\n * Create a new Slate `Editor` object.\r\n */\n\nvar createEditor = () => {\n  var editor = {\n    children: [],\n    operations: [],\n    selection: null,\n    marks: null,\n    isInline: () => false,\n    isVoid: () => false,\n    onChange: () => {},\n    apply: op => {\n      for (var ref of Editor.pathRefs(editor)) {\n        PathRef.transform(ref, op);\n      }\n\n      for (var _ref of Editor.pointRefs(editor)) {\n        PointRef.transform(_ref, op);\n      }\n\n      for (var _ref2 of Editor.rangeRefs(editor)) {\n        RangeRef.transform(_ref2, op);\n      }\n\n      var set = new Set();\n      var dirtyPaths = [];\n\n      var add = path => {\n        if (path) {\n          var key = path.join(',');\n\n          if (!set.has(key)) {\n            set.add(key);\n            dirtyPaths.push(path);\n          }\n        }\n      };\n\n      var oldDirtyPaths = DIRTY_PATHS.get(editor) || [];\n      var newDirtyPaths = getDirtyPaths(op);\n\n      for (var path of oldDirtyPaths) {\n        var newPath = Path.transform(path, op);\n        add(newPath);\n      }\n\n      for (var _path of newDirtyPaths) {\n        add(_path);\n      }\n\n      DIRTY_PATHS.set(editor, dirtyPaths);\n      Editor.transform(editor, op);\n      editor.operations.push(op);\n      Editor.normalize(editor); // Clear any formats applied to the cursor if the selection changes.\n\n      if (op.type === 'set_selection') {\n        editor.marks = null;\n      }\n\n      if (!FLUSHING.get(editor)) {\n        FLUSHING.set(editor, true);\n        Promise.resolve().then(() => {\n          FLUSHING.set(editor, false);\n          editor.onChange();\n          editor.operations = [];\n        });\n      }\n    },\n    addMark: (key, value) => {\n      var {\n        selection\n      } = editor;\n\n      if (selection) {\n        if (Range.isExpanded(selection)) {\n          Transforms.setNodes(editor, {\n            [key]: value\n          }, {\n            match: Text.isText,\n            split: true\n          });\n        } else {\n          var marks = _objectSpread$9({}, Editor.marks(editor) || {}, {\n            [key]: value\n          });\n\n          editor.marks = marks;\n          editor.onChange();\n        }\n      }\n    },\n    deleteBackward: unit => {\n      var {\n        selection\n      } = editor;\n\n      if (selection && Range.isCollapsed(selection)) {\n        Transforms.delete(editor, {\n          unit,\n          reverse: true\n        });\n      }\n    },\n    deleteForward: unit => {\n      var {\n        selection\n      } = editor;\n\n      if (selection && Range.isCollapsed(selection)) {\n        Transforms.delete(editor, {\n          unit\n        });\n      }\n    },\n    deleteFragment: () => {\n      var {\n        selection\n      } = editor;\n\n      if (selection && Range.isExpanded(selection)) {\n        Transforms.delete(editor);\n      }\n    },\n    getFragment: () => {\n      var {\n        selection\n      } = editor;\n\n      if (selection) {\n        return Node.fragment(editor, selection);\n      }\n\n      return [];\n    },\n    insertBreak: () => {\n      Transforms.splitNodes(editor, {\n        always: true\n      });\n    },\n    insertFragment: fragment => {\n      Transforms.insertFragment(editor, fragment);\n    },\n    insertNode: node => {\n      Transforms.insertNodes(editor, node);\n    },\n    insertText: text => {\n      var {\n        selection,\n        marks\n      } = editor;\n\n      if (selection) {\n        // If the cursor is at the end of an inline, move it outside of\n        // the inline before inserting\n        if (Range.isCollapsed(selection)) {\n          var inline = Editor.above(editor, {\n            match: n => Editor.isInline(editor, n),\n            mode: 'highest'\n          });\n\n          if (inline) {\n            var [, inlinePath] = inline;\n\n            if (Editor.isEnd(editor, selection.anchor, inlinePath)) {\n              var point = Editor.after(editor, inlinePath);\n              Transforms.setSelection(editor, {\n                anchor: point,\n                focus: point\n              });\n            }\n          }\n        }\n\n        if (marks) {\n          var node = _objectSpread$9({\n            text\n          }, marks);\n\n          Transforms.insertNodes(editor, node);\n        } else {\n          Transforms.insertText(editor, text);\n        }\n\n        editor.marks = null;\n      }\n    },\n    normalizeNode: entry => {\n      var [node, path] = entry; // There are no core normalizations for text nodes.\n\n      if (Text.isText(node)) {\n        return;\n      } // Ensure that block and inline nodes have at least one text child.\n\n\n      if (Element.isElement(node) && node.children.length === 0) {\n        var child = {\n          text: ''\n        };\n        Transforms.insertNodes(editor, child, {\n          at: path.concat(0),\n          voids: true\n        });\n        return;\n      } // Determine whether the node should have block or inline children.\n\n\n      var shouldHaveInlines = Editor.isEditor(node) ? false : Element.isElement(node) && (editor.isInline(node) || node.children.length === 0 || Text.isText(node.children[0]) || editor.isInline(node.children[0])); // Since we'll be applying operations while iterating, keep track of an\n      // index that accounts for any added/removed nodes.\n\n      var n = 0;\n\n      for (var i = 0; i < node.children.length; i++, n++) {\n        var _child = node.children[i];\n        var prev = node.children[i - 1];\n        var isLast = i === node.children.length - 1;\n        var isInlineOrText = Text.isText(_child) || Element.isElement(_child) && editor.isInline(_child); // Only allow block nodes in the top-level children and parent blocks\n        // that only contain block nodes. Similarly, only allow inline nodes in\n        // other inline nodes, or parent blocks that only contain inlines and\n        // text.\n\n        if (isInlineOrText !== shouldHaveInlines) {\n          Transforms.removeNodes(editor, {\n            at: path.concat(n),\n            voids: true\n          });\n          n--;\n        } else if (Element.isElement(_child)) {\n          // Ensure that inline nodes are surrounded by text nodes.\n          if (editor.isInline(_child)) {\n            if (prev == null || !Text.isText(prev)) {\n              var newChild = {\n                text: ''\n              };\n              Transforms.insertNodes(editor, newChild, {\n                at: path.concat(n),\n                voids: true\n              });\n              n++;\n            } else if (isLast) {\n              var _newChild = {\n                text: ''\n              };\n              Transforms.insertNodes(editor, _newChild, {\n                at: path.concat(n + 1),\n                voids: true\n              });\n              n++;\n            }\n          }\n        } else {\n          // Merge adjacent text nodes that are empty or match.\n          if (prev != null && Text.isText(prev)) {\n            if (Text.equals(_child, prev, {\n              loose: true\n            })) {\n              Transforms.mergeNodes(editor, {\n                at: path.concat(n),\n                voids: true\n              });\n              n--;\n            } else if (prev.text === '') {\n              Transforms.removeNodes(editor, {\n                at: path.concat(n - 1),\n                voids: true\n              });\n              n--;\n            } else if (isLast && _child.text === '') {\n              Transforms.removeNodes(editor, {\n                at: path.concat(n),\n                voids: true\n              });\n              n--;\n            }\n          }\n        }\n      }\n    },\n    removeMark: key => {\n      var {\n        selection\n      } = editor;\n\n      if (selection) {\n        if (Range.isExpanded(selection)) {\n          Transforms.unsetNodes(editor, key, {\n            match: Text.isText,\n            split: true\n          });\n        } else {\n          var marks = _objectSpread$9({}, Editor.marks(editor) || {});\n\n          delete marks[key];\n          editor.marks = marks;\n          editor.onChange();\n        }\n      }\n    }\n  };\n  return editor;\n};\n/**\r\n * Get the \"dirty\" paths generated from an operation.\r\n */\n\nvar getDirtyPaths = op => {\n  switch (op.type) {\n    case 'insert_text':\n    case 'remove_text':\n    case 'set_node':\n      {\n        var {\n          path\n        } = op;\n        return Path.levels(path);\n      }\n\n    case 'insert_node':\n      {\n        var {\n          node,\n          path: _path2\n        } = op;\n        var levels = Path.levels(_path2);\n        var descendants = Text.isText(node) ? [] : Array.from(Node.nodes(node), (_ref3) => {\n          var [, p] = _ref3;\n          return _path2.concat(p);\n        });\n        return [...levels, ...descendants];\n      }\n\n    case 'merge_node':\n      {\n        var {\n          path: _path3\n        } = op;\n        var ancestors = Path.ancestors(_path3);\n        var previousPath = Path.previous(_path3);\n        return [...ancestors, previousPath];\n      }\n\n    case 'move_node':\n      {\n        var {\n          path: _path4,\n          newPath\n        } = op;\n\n        if (Path.equals(_path4, newPath)) {\n          return [];\n        }\n\n        var oldAncestors = [];\n        var newAncestors = [];\n\n        for (var ancestor of Path.ancestors(_path4)) {\n          var p = Path.transform(ancestor, op);\n          oldAncestors.push(p);\n        }\n\n        for (var _ancestor of Path.ancestors(newPath)) {\n          var _p = Path.transform(_ancestor, op);\n\n          newAncestors.push(_p);\n        }\n\n        return [...oldAncestors, ...newAncestors];\n      }\n\n    case 'remove_node':\n      {\n        var {\n          path: _path5\n        } = op;\n\n        var _ancestors = Path.ancestors(_path5);\n\n        return [..._ancestors];\n      }\n\n    case 'split_node':\n      {\n        var {\n          path: _path6\n        } = op;\n\n        var _levels = Path.levels(_path6);\n\n        var nextPath = Path.next(_path6);\n        return [..._levels, nextPath];\n      }\n\n    default:\n      {\n        return [];\n      }\n  }\n};\n\nexport { Editor, Element, Location, Node, Operation, Path, PathRef, Point, PointRef, Range, RangeRef, Span, Text, Transforms, createEditor };\n//# sourceMappingURL=index.es.js.map\n","function isElement(el) {\n  return el != null && typeof el === 'object' && el.nodeType === 1;\n}\n\nfunction canOverflow(overflow, skipOverflowHiddenElements) {\n  if (skipOverflowHiddenElements && overflow === 'hidden') {\n    return false;\n  }\n\n  return overflow !== 'visible' && overflow !== 'clip';\n}\n\nfunction getFrameElement(el) {\n  if (!el.ownerDocument || !el.ownerDocument.defaultView) {\n    return null;\n  }\n\n  try {\n    return el.ownerDocument.defaultView.frameElement;\n  } catch (e) {\n    return null;\n  }\n}\n\nfunction isHiddenByFrame(el) {\n  var frame = getFrameElement(el);\n\n  if (!frame) {\n    return false;\n  }\n\n  return frame.clientHeight < el.scrollHeight || frame.clientWidth < el.scrollWidth;\n}\n\nfunction isScrollable(el, skipOverflowHiddenElements) {\n  if (el.clientHeight < el.scrollHeight || el.clientWidth < el.scrollWidth) {\n    var style = getComputedStyle(el, null);\n    return canOverflow(style.overflowY, skipOverflowHiddenElements) || canOverflow(style.overflowX, skipOverflowHiddenElements) || isHiddenByFrame(el);\n  }\n\n  return false;\n}\n\nfunction alignNearest(scrollingEdgeStart, scrollingEdgeEnd, scrollingSize, scrollingBorderStart, scrollingBorderEnd, elementEdgeStart, elementEdgeEnd, elementSize) {\n  if (elementEdgeStart < scrollingEdgeStart && elementEdgeEnd > scrollingEdgeEnd || elementEdgeStart > scrollingEdgeStart && elementEdgeEnd < scrollingEdgeEnd) {\n    return 0;\n  }\n\n  if (elementEdgeStart <= scrollingEdgeStart && elementSize <= scrollingSize || elementEdgeEnd >= scrollingEdgeEnd && elementSize >= scrollingSize) {\n    return elementEdgeStart - scrollingEdgeStart - scrollingBorderStart;\n  }\n\n  if (elementEdgeEnd > scrollingEdgeEnd && elementSize < scrollingSize || elementEdgeStart < scrollingEdgeStart && elementSize > scrollingSize) {\n    return elementEdgeEnd - scrollingEdgeEnd + scrollingBorderEnd;\n  }\n\n  return 0;\n}\n\nexport default (function (target, options) {\n  var scrollMode = options.scrollMode,\n      block = options.block,\n      inline = options.inline,\n      boundary = options.boundary,\n      skipOverflowHiddenElements = options.skipOverflowHiddenElements;\n  var checkBoundary = typeof boundary === 'function' ? boundary : function (node) {\n    return node !== boundary;\n  };\n\n  if (!isElement(target)) {\n    throw new TypeError('Invalid target');\n  }\n\n  var scrollingElement = document.scrollingElement || document.documentElement;\n  var frames = [];\n  var cursor = target;\n\n  while (isElement(cursor) && checkBoundary(cursor)) {\n    cursor = cursor.parentNode;\n\n    if (cursor === scrollingElement) {\n      frames.push(cursor);\n      break;\n    }\n\n    if (cursor === document.body && isScrollable(cursor) && !isScrollable(document.documentElement)) {\n      continue;\n    }\n\n    if (isScrollable(cursor, skipOverflowHiddenElements)) {\n      frames.push(cursor);\n    }\n  }\n\n  var viewportWidth = window.visualViewport ? visualViewport.width : innerWidth;\n  var viewportHeight = window.visualViewport ? visualViewport.height : innerHeight;\n  var viewportX = window.scrollX || pageXOffset;\n  var viewportY = window.scrollY || pageYOffset;\n\n  var _target$getBoundingCl = target.getBoundingClientRect(),\n      targetHeight = _target$getBoundingCl.height,\n      targetWidth = _target$getBoundingCl.width,\n      targetTop = _target$getBoundingCl.top,\n      targetRight = _target$getBoundingCl.right,\n      targetBottom = _target$getBoundingCl.bottom,\n      targetLeft = _target$getBoundingCl.left;\n\n  var targetBlock = block === 'start' || block === 'nearest' ? targetTop : block === 'end' ? targetBottom : targetTop + targetHeight / 2;\n  var targetInline = inline === 'center' ? targetLeft + targetWidth / 2 : inline === 'end' ? targetRight : targetLeft;\n  var computations = [];\n\n  for (var index = 0; index < frames.length; index++) {\n    var frame = frames[index];\n\n    var _frame$getBoundingCli = frame.getBoundingClientRect(),\n        height = _frame$getBoundingCli.height,\n        width = _frame$getBoundingCli.width,\n        top = _frame$getBoundingCli.top,\n        right = _frame$getBoundingCli.right,\n        bottom = _frame$getBoundingCli.bottom,\n        left = _frame$getBoundingCli.left;\n\n    if (scrollMode === 'if-needed' && targetTop >= 0 && targetLeft >= 0 && targetBottom <= viewportHeight && targetRight <= viewportWidth && targetTop >= top && targetBottom <= bottom && targetLeft >= left && targetRight <= right) {\n      return computations;\n    }\n\n    var frameStyle = getComputedStyle(frame);\n    var borderLeft = parseInt(frameStyle.borderLeftWidth, 10);\n    var borderTop = parseInt(frameStyle.borderTopWidth, 10);\n    var borderRight = parseInt(frameStyle.borderRightWidth, 10);\n    var borderBottom = parseInt(frameStyle.borderBottomWidth, 10);\n    var blockScroll = 0;\n    var inlineScroll = 0;\n    var scrollbarWidth = 'offsetWidth' in frame ? frame.offsetWidth - frame.clientWidth - borderLeft - borderRight : 0;\n    var scrollbarHeight = 'offsetHeight' in frame ? frame.offsetHeight - frame.clientHeight - borderTop - borderBottom : 0;\n\n    if (scrollingElement === frame) {\n      if (block === 'start') {\n        blockScroll = targetBlock;\n      } else if (block === 'end') {\n        blockScroll = targetBlock - viewportHeight;\n      } else if (block === 'nearest') {\n        blockScroll = alignNearest(viewportY, viewportY + viewportHeight, viewportHeight, borderTop, borderBottom, viewportY + targetBlock, viewportY + targetBlock + targetHeight, targetHeight);\n      } else {\n        blockScroll = targetBlock - viewportHeight / 2;\n      }\n\n      if (inline === 'start') {\n        inlineScroll = targetInline;\n      } else if (inline === 'center') {\n        inlineScroll = targetInline - viewportWidth / 2;\n      } else if (inline === 'end') {\n        inlineScroll = targetInline - viewportWidth;\n      } else {\n        inlineScroll = alignNearest(viewportX, viewportX + viewportWidth, viewportWidth, borderLeft, borderRight, viewportX + targetInline, viewportX + targetInline + targetWidth, targetWidth);\n      }\n\n      blockScroll = Math.max(0, blockScroll + viewportY);\n      inlineScroll = Math.max(0, inlineScroll + viewportX);\n    } else {\n      if (block === 'start') {\n        blockScroll = targetBlock - top - borderTop;\n      } else if (block === 'end') {\n        blockScroll = targetBlock - bottom + borderBottom + scrollbarHeight;\n      } else if (block === 'nearest') {\n        blockScroll = alignNearest(top, bottom, height, borderTop, borderBottom + scrollbarHeight, targetBlock, targetBlock + targetHeight, targetHeight);\n      } else {\n        blockScroll = targetBlock - (top + height / 2) + scrollbarHeight / 2;\n      }\n\n      if (inline === 'start') {\n        inlineScroll = targetInline - left - borderLeft;\n      } else if (inline === 'center') {\n        inlineScroll = targetInline - (left + width / 2) + scrollbarWidth / 2;\n      } else if (inline === 'end') {\n        inlineScroll = targetInline - right + borderRight + scrollbarWidth;\n      } else {\n        inlineScroll = alignNearest(left, right, width, borderLeft, borderRight + scrollbarWidth, targetInline, targetInline + targetWidth, targetWidth);\n      }\n\n      var scrollLeft = frame.scrollLeft,\n          scrollTop = frame.scrollTop;\n      blockScroll = Math.max(0, Math.min(scrollTop + blockScroll, frame.scrollHeight - height + scrollbarHeight));\n      inlineScroll = Math.max(0, Math.min(scrollLeft + inlineScroll, frame.scrollWidth - width + scrollbarWidth));\n      targetBlock += scrollTop - blockScroll;\n      targetInline += scrollLeft - inlineScroll;\n    }\n\n    computations.push({\n      el: frame,\n      top: blockScroll,\n      left: inlineScroll\n    });\n  }\n\n  return computations;\n});","import compute from 'compute-scroll-into-view';\n\nfunction isOptionsObject(options) {\n  return options === Object(options) && Object.keys(options).length !== 0;\n}\n\nfunction defaultBehavior(actions, behavior) {\n  if (behavior === void 0) {\n    behavior = 'auto';\n  }\n\n  var canSmoothScroll = ('scrollBehavior' in document.body.style);\n  actions.forEach(function (_ref) {\n    var el = _ref.el,\n        top = _ref.top,\n        left = _ref.left;\n\n    if (el.scroll && canSmoothScroll) {\n      el.scroll({\n        top: top,\n        left: left,\n        behavior: behavior\n      });\n    } else {\n      el.scrollTop = top;\n      el.scrollLeft = left;\n    }\n  });\n}\n\nfunction getOptions(options) {\n  if (options === false) {\n    return {\n      block: 'end',\n      inline: 'nearest'\n    };\n  }\n\n  if (isOptionsObject(options)) {\n    return options;\n  }\n\n  return {\n    block: 'start',\n    inline: 'nearest'\n  };\n}\n\nfunction scrollIntoView(target, options) {\n  var targetIsDetached = !target.ownerDocument.documentElement.contains(target);\n\n  if (isOptionsObject(options) && typeof options.behavior === 'function') {\n    return options.behavior(targetIsDetached ? [] : compute(target, options));\n  }\n\n  if (targetIsDetached) {\n    return;\n  }\n\n  var computeOptions = getOptions(options);\n  return defaultBehavior(compute(target, computeOptions), computeOptions.behavior);\n}\n\nexport default scrollIntoView;","import React, { createContext, useContext, useState, useMemo, useCallback, useEffect, useLayoutEffect, useRef } from 'react';\nimport { Editor, Transforms, Range, Path, Node as Node$1, Text as Text$1, Element as Element$1 } from 'slate';\nimport throttle from 'lodash/throttle';\nimport scrollIntoView from 'scroll-into-view-if-needed';\nimport getDirection from 'direction';\nimport ReactDOM from 'react-dom';\nimport { isKeyHotkey } from 'is-hotkey';\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\n/**\r\n * An auto-incrementing identifier for keys.\r\n */\nvar n = 0;\n/**\r\n * A class that keeps track of a key string. We use a full class here because we\r\n * want to be able to use them as keys in `WeakMap` objects.\r\n */\n\nclass Key {\n  constructor() {\n    this.id = \"\".concat(n++);\n  }\n\n}\n\n/**\r\n * Two weak maps that allow us rebuild a path given a node. They are populated\r\n * at render time such that after a render occurs we can always backtrack.\r\n */\nvar NODE_TO_INDEX = new WeakMap();\nvar NODE_TO_PARENT = new WeakMap();\n/**\r\n * Weak maps that allow us to go between Slate nodes and DOM nodes. These\r\n * are used to resolve DOM event-related logic into Slate actions.\r\n */\n\nvar EDITOR_TO_ELEMENT = new WeakMap();\nvar ELEMENT_TO_NODE = new WeakMap();\nvar KEY_TO_ELEMENT = new WeakMap();\nvar NODE_TO_ELEMENT = new WeakMap();\nvar NODE_TO_KEY = new WeakMap();\n/**\r\n * Weak maps for storing editor-related state.\r\n */\n\nvar IS_READ_ONLY = new WeakMap();\nvar IS_FOCUSED = new WeakMap();\n/**\r\n * Weak map for associating the context `onChange` context with the plugin.\r\n */\n\nvar EDITOR_TO_ON_CHANGE = new WeakMap();\n/**\r\n * Symbols.\r\n */\n\nvar PLACEHOLDER_SYMBOL = Symbol('placeholder');\n\n/**\r\n * Types.\r\n */\n/**\r\n * Check if a DOM node is a comment node.\r\n */\n\nvar isDOMComment = value => {\n  return isDOMNode(value) && value.nodeType === 8;\n};\n/**\r\n * Check if a DOM node is an element node.\r\n */\n\nvar isDOMElement = value => {\n  return isDOMNode(value) && value.nodeType === 1;\n};\n/**\r\n * Check if a value is a DOM node.\r\n */\n\nvar isDOMNode = value => {\n  return value instanceof Node;\n};\n/**\r\n * Check if a DOM node is an element node.\r\n */\n\nvar isDOMText = value => {\n  return isDOMNode(value) && value.nodeType === 3;\n};\n/**\r\n * Checks whether a paste event is a plaintext-only event.\r\n */\n\nvar isPlainTextOnlyPaste = event => {\n  return event.clipboardData && event.clipboardData.getData('text/plain') !== '' && event.clipboardData.types.length === 1;\n};\n/**\r\n * Normalize a DOM point so that it always refers to a text node.\r\n */\n\nvar normalizeDOMPoint = domPoint => {\n  var [node, offset] = domPoint; // If it's an element node, its offset refers to the index of its children\n  // including comment nodes, so try to find the right text child node.\n\n  if (isDOMElement(node) && node.childNodes.length) {\n    var isLast = offset === node.childNodes.length;\n    var direction = isLast ? 'backward' : 'forward';\n    var index = isLast ? offset - 1 : offset;\n    node = getEditableChild(node, index, direction); // If the node has children, traverse until we have a leaf node. Leaf nodes\n    // can be either text nodes, or other void DOM nodes.\n\n    while (isDOMElement(node) && node.childNodes.length) {\n      var i = isLast ? node.childNodes.length - 1 : 0;\n      node = getEditableChild(node, i, direction);\n    } // Determine the new offset inside the text node.\n\n\n    offset = isLast && node.textContent != null ? node.textContent.length : 0;\n  } // Return the node and offset.\n\n\n  return [node, offset];\n};\n/**\r\n * Get the nearest editable child at `index` in a `parent`, preferring\r\n * `direction`.\r\n */\n\nvar getEditableChild = (parent, index, direction) => {\n  var {\n    childNodes\n  } = parent;\n  var child = childNodes[index];\n  var i = index;\n  var triedForward = false;\n  var triedBackward = false; // While the child is a comment node, or an element node with no children,\n  // keep iterating to find a sibling non-void, non-comment node.\n\n  while (isDOMComment(child) || isDOMElement(child) && child.childNodes.length === 0 || isDOMElement(child) && child.getAttribute('contenteditable') === 'false') {\n    if (triedForward && triedBackward) {\n      break;\n    }\n\n    if (i >= childNodes.length) {\n      triedForward = true;\n      i = index - 1;\n      direction = 'backward';\n      continue;\n    }\n\n    if (i < 0) {\n      triedBackward = true;\n      i = index + 1;\n      direction = 'forward';\n      continue;\n    }\n\n    child = childNodes[i];\n    i += direction === 'forward' ? 1 : -1;\n  }\n\n  return child;\n};\n/**\r\n * Get a plaintext representation of the content of a node, accounting for block\r\n * elements which get a newline appended.\r\n *\r\n * The domNode must be attached to the DOM.\r\n */\n\nvar getPlainText = domNode => {\n  var text = '';\n\n  if (isDOMText(domNode) && domNode.nodeValue) {\n    return domNode.nodeValue;\n  }\n\n  if (isDOMElement(domNode)) {\n    for (var childNode of Array.from(domNode.childNodes)) {\n      text += getPlainText(childNode);\n    }\n\n    var display = getComputedStyle(domNode).getPropertyValue('display');\n\n    if (display === 'block' || display === 'list' || domNode.tagName === 'BR') {\n      text += '\\n';\n    }\n  }\n\n  return text;\n};\n\nvar ReactEditor = {\n  /**\r\n   * Find a key for a Slate node.\r\n   */\n  findKey(editor, node) {\n    var key = NODE_TO_KEY.get(node);\n\n    if (!key) {\n      key = new Key();\n      NODE_TO_KEY.set(node, key);\n    }\n\n    return key;\n  },\n\n  /**\r\n   * Find the path of Slate node.\r\n   */\n  findPath(editor, node) {\n    var path = [];\n    var child = node;\n\n    while (true) {\n      var parent = NODE_TO_PARENT.get(child);\n\n      if (parent == null) {\n        if (Editor.isEditor(child)) {\n          return path;\n        } else {\n          break;\n        }\n      }\n\n      var i = NODE_TO_INDEX.get(child);\n\n      if (i == null) {\n        break;\n      }\n\n      path.unshift(i);\n      child = parent;\n    }\n\n    throw new Error(\"Unable to find the path for Slate node: \".concat(JSON.stringify(node)));\n  },\n\n  /**\r\n   * Check if the editor is focused.\r\n   */\n  isFocused(editor) {\n    return !!IS_FOCUSED.get(editor);\n  },\n\n  /**\r\n   * Check if the editor is in read-only mode.\r\n   */\n  isReadOnly(editor) {\n    return !!IS_READ_ONLY.get(editor);\n  },\n\n  /**\r\n   * Blur the editor.\r\n   */\n  blur(editor) {\n    var el = ReactEditor.toDOMNode(editor, editor);\n    IS_FOCUSED.set(editor, false);\n\n    if (window.document.activeElement === el) {\n      el.blur();\n    }\n  },\n\n  /**\r\n   * Focus the editor.\r\n   */\n  focus(editor) {\n    var el = ReactEditor.toDOMNode(editor, editor);\n    IS_FOCUSED.set(editor, true);\n\n    if (window.document.activeElement !== el) {\n      el.focus({\n        preventScroll: true\n      });\n    }\n  },\n\n  /**\r\n   * Deselect the editor.\r\n   */\n  deselect(editor) {\n    var {\n      selection\n    } = editor;\n    var domSelection = window.getSelection();\n\n    if (domSelection && domSelection.rangeCount > 0) {\n      domSelection.removeAllRanges();\n    }\n\n    if (selection) {\n      Transforms.deselect(editor);\n    }\n  },\n\n  /**\r\n   * Check if a DOM node is within the editor.\r\n   */\n  hasDOMNode(editor, target) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var {\n      editable = false\n    } = options;\n    var editorEl = ReactEditor.toDOMNode(editor, editor);\n    var targetEl; // COMPAT: In Firefox, reading `target.nodeType` will throw an error if\n    // target is originating from an internal \"restricted\" element (e.g. a\n    // stepper arrow on a number input). (2018/05/04)\n    // https://github.com/ianstormtaylor/slate/issues/1819\n\n    try {\n      targetEl = isDOMElement(target) ? target : target.parentElement;\n    } catch (err) {\n      if (!err.message.includes('Permission denied to access property \"nodeType\"')) {\n        throw err;\n      }\n    }\n\n    if (!targetEl) {\n      return false;\n    }\n\n    return targetEl.closest(\"[data-slate-editor]\") === editorEl && (!editable || targetEl.isContentEditable || !!targetEl.getAttribute('data-slate-zero-width'));\n  },\n\n  /**\r\n   * Insert data from a `DataTransfer` into the editor.\r\n   */\n  insertData(editor, data) {\n    editor.insertData(data);\n  },\n\n  /**\r\n   * Sets data from the currently selected fragment on a `DataTransfer`.\r\n   */\n  setFragmentData(editor, data) {\n    editor.setFragmentData(data);\n  },\n\n  /**\r\n   * Find the native DOM element from a Slate node.\r\n   */\n  toDOMNode(editor, node) {\n    var domNode = Editor.isEditor(node) ? EDITOR_TO_ELEMENT.get(editor) : KEY_TO_ELEMENT.get(ReactEditor.findKey(editor, node));\n\n    if (!domNode) {\n      throw new Error(\"Cannot resolve a DOM node from Slate node: \".concat(JSON.stringify(node)));\n    }\n\n    return domNode;\n  },\n\n  /**\r\n   * Find a native DOM selection point from a Slate point.\r\n   */\n  toDOMPoint(editor, point) {\n    var [node] = Editor.node(editor, point.path);\n    var el = ReactEditor.toDOMNode(editor, node);\n    var domPoint; // If we're inside a void node, force the offset to 0, otherwise the zero\n    // width spacing character will result in an incorrect offset of 1\n\n    if (Editor.void(editor, {\n      at: point\n    })) {\n      point = {\n        path: point.path,\n        offset: 0\n      };\n    } // For each leaf, we need to isolate its content, which means filtering\n    // to its direct text and zero-width spans. (We have to filter out any\n    // other siblings that may have been rendered alongside them.)\n\n\n    var selector = \"[data-slate-string], [data-slate-zero-width]\";\n    var texts = Array.from(el.querySelectorAll(selector));\n    var start = 0;\n\n    for (var text of texts) {\n      var domNode = text.childNodes[0];\n\n      if (domNode == null || domNode.textContent == null) {\n        continue;\n      }\n\n      var {\n        length\n      } = domNode.textContent;\n      var attr = text.getAttribute('data-slate-length');\n      var trueLength = attr == null ? length : parseInt(attr, 10);\n      var end = start + trueLength;\n\n      if (point.offset <= end) {\n        var offset = Math.min(length, Math.max(0, point.offset - start));\n        domPoint = [domNode, offset];\n        break;\n      }\n\n      start = end;\n    }\n\n    if (!domPoint) {\n      throw new Error(\"Cannot resolve a DOM point from Slate point: \".concat(JSON.stringify(point)));\n    }\n\n    return domPoint;\n  },\n\n  /**\r\n   * Find a native DOM range from a Slate `range`.\r\n   */\n  toDOMRange(editor, range) {\n    var {\n      anchor,\n      focus\n    } = range;\n    var isBackward = Range.isBackward(range);\n    var domAnchor = ReactEditor.toDOMPoint(editor, anchor);\n    var domFocus = Range.isCollapsed(range) ? domAnchor : ReactEditor.toDOMPoint(editor, focus);\n    var domRange = window.document.createRange();\n    var [startNode, startOffset] = isBackward ? domFocus : domAnchor;\n    var [endNode, endOffset] = isBackward ? domAnchor : domFocus; // A slate Point at zero-width Leaf always has an offset of 0 but a native DOM selection at\n    // zero-width node has an offset of 1 so we have to check if we are in a zero-width node and\n    // adjust the offset accordingly.\n\n    var startEl = isDOMElement(startNode) ? startNode : startNode.parentElement;\n    var isStartAtZeroWidth = !!startEl.getAttribute('data-slate-zero-width');\n    var endEl = isDOMElement(endNode) ? endNode : endNode.parentElement;\n    var isEndAtZeroWidth = !!endEl.getAttribute('data-slate-zero-width');\n    domRange.setStart(startNode, isStartAtZeroWidth ? 1 : startOffset);\n    domRange.setEnd(endNode, isEndAtZeroWidth ? 1 : endOffset);\n    return domRange;\n  },\n\n  /**\r\n   * Find a Slate node from a native DOM `element`.\r\n   */\n  toSlateNode(editor, domNode) {\n    var domEl = isDOMElement(domNode) ? domNode : domNode.parentElement;\n\n    if (domEl && !domEl.hasAttribute('data-slate-node')) {\n      domEl = domEl.closest(\"[data-slate-node]\");\n    }\n\n    var node = domEl ? ELEMENT_TO_NODE.get(domEl) : null;\n\n    if (!node) {\n      throw new Error(\"Cannot resolve a Slate node from DOM node: \".concat(domEl));\n    }\n\n    return node;\n  },\n\n  /**\r\n   * Get the target range from a DOM `event`.\r\n   */\n  findEventRange(editor, event) {\n    if ('nativeEvent' in event) {\n      event = event.nativeEvent;\n    }\n\n    var {\n      clientX: x,\n      clientY: y,\n      target\n    } = event;\n\n    if (x == null || y == null) {\n      throw new Error(\"Cannot resolve a Slate range from a DOM event: \".concat(event));\n    }\n\n    var node = ReactEditor.toSlateNode(editor, event.target);\n    var path = ReactEditor.findPath(editor, node); // If the drop target is inside a void node, move it into either the\n    // next or previous node, depending on which side the `x` and `y`\n    // coordinates are closest to.\n\n    if (Editor.isVoid(editor, node)) {\n      var rect = target.getBoundingClientRect();\n      var isPrev = editor.isInline(node) ? x - rect.left < rect.left + rect.width - x : y - rect.top < rect.top + rect.height - y;\n      var edge = Editor.point(editor, path, {\n        edge: isPrev ? 'start' : 'end'\n      });\n      var point = isPrev ? Editor.before(editor, edge) : Editor.after(editor, edge);\n\n      if (point) {\n        var _range = Editor.range(editor, point);\n\n        return _range;\n      }\n    } // Else resolve a range from the caret position where the drop occured.\n\n\n    var domRange;\n    var {\n      document\n    } = window; // COMPAT: In Firefox, `caretRangeFromPoint` doesn't exist. (2016/07/25)\n\n    if (document.caretRangeFromPoint) {\n      domRange = document.caretRangeFromPoint(x, y);\n    } else {\n      var position = document.caretPositionFromPoint(x, y);\n\n      if (position) {\n        domRange = document.createRange();\n        domRange.setStart(position.offsetNode, position.offset);\n        domRange.setEnd(position.offsetNode, position.offset);\n      }\n    }\n\n    if (!domRange) {\n      throw new Error(\"Cannot resolve a Slate range from a DOM event: \".concat(event));\n    } // Resolve a Slate range from the DOM range.\n\n\n    var range = ReactEditor.toSlateRange(editor, domRange);\n    return range;\n  },\n\n  /**\r\n   * Find a Slate point from a DOM selection's `domNode` and `domOffset`.\r\n   */\n  toSlatePoint(editor, domPoint) {\n    var [nearestNode, nearestOffset] = normalizeDOMPoint(domPoint);\n    var parentNode = nearestNode.parentNode;\n    var textNode = null;\n    var offset = 0;\n\n    if (parentNode) {\n      var voidNode = parentNode.closest('[data-slate-void=\"true\"]');\n      var leafNode = parentNode.closest('[data-slate-leaf]');\n      var domNode = null; // Calculate how far into the text node the `nearestNode` is, so that we\n      // can determine what the offset relative to the text node is.\n\n      if (leafNode) {\n        textNode = leafNode.closest('[data-slate-node=\"text\"]');\n        var range = window.document.createRange();\n        range.setStart(textNode, 0);\n        range.setEnd(nearestNode, nearestOffset);\n        var contents = range.cloneContents();\n        var removals = [...contents.querySelectorAll('[data-slate-zero-width]'), ...contents.querySelectorAll('[contenteditable=false]')];\n        removals.forEach(el => {\n          el.parentNode.removeChild(el);\n        }); // COMPAT: Edge has a bug where Range.prototype.toString() will\n        // convert \\n into \\r\\n. The bug causes a loop when slate-react\n        // attempts to reposition its cursor to match the native position. Use\n        // textContent.length instead.\n        // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/10291116/\n\n        offset = contents.textContent.length;\n        domNode = textNode;\n      } else if (voidNode) {\n        // For void nodes, the element with the offset key will be a cousin, not an\n        // ancestor, so find it by going down from the nearest void parent.\n        leafNode = voidNode.querySelector('[data-slate-leaf]');\n        textNode = leafNode.closest('[data-slate-node=\"text\"]');\n        domNode = leafNode;\n        offset = domNode.textContent.length;\n      } // COMPAT: If the parent node is a Slate zero-width space, editor is\n      // because the text node should have no characters. However, during IME\n      // composition the ASCII characters will be prepended to the zero-width\n      // space, so subtract 1 from the offset to account for the zero-width\n      // space character.\n\n\n      if (domNode && offset === domNode.textContent.length && parentNode.hasAttribute('data-slate-zero-width')) {\n        offset--;\n      }\n    }\n\n    if (!textNode) {\n      throw new Error(\"Cannot resolve a Slate point from DOM point: \".concat(domPoint));\n    } // COMPAT: If someone is clicking from one Slate editor into another,\n    // the select event fires twice, once for the old editor's `element`\n    // first, and then afterwards for the correct `element`. (2017/03/03)\n\n\n    var slateNode = ReactEditor.toSlateNode(editor, textNode);\n    var path = ReactEditor.findPath(editor, slateNode);\n    return {\n      path,\n      offset\n    };\n  },\n\n  /**\r\n   * Find a Slate range from a DOM range or selection.\r\n   */\n  toSlateRange(editor, domRange) {\n    var el = domRange instanceof Selection ? domRange.anchorNode : domRange.startContainer;\n    var anchorNode;\n    var anchorOffset;\n    var focusNode;\n    var focusOffset;\n    var isCollapsed;\n\n    if (el) {\n      if (domRange instanceof Selection) {\n        anchorNode = domRange.anchorNode;\n        anchorOffset = domRange.anchorOffset;\n        focusNode = domRange.focusNode;\n        focusOffset = domRange.focusOffset;\n        isCollapsed = domRange.isCollapsed;\n      } else {\n        anchorNode = domRange.startContainer;\n        anchorOffset = domRange.startOffset;\n        focusNode = domRange.endContainer;\n        focusOffset = domRange.endOffset;\n        isCollapsed = domRange.collapsed;\n      }\n    }\n\n    if (anchorNode == null || focusNode == null || anchorOffset == null || focusOffset == null) {\n      throw new Error(\"Cannot resolve a Slate range from DOM range: \".concat(domRange));\n    }\n\n    var anchor = ReactEditor.toSlatePoint(editor, [anchorNode, anchorOffset]);\n    var focus = isCollapsed ? anchor : ReactEditor.toSlatePoint(editor, [focusNode, focusOffset]);\n    return {\n      anchor,\n      focus\n    };\n  }\n\n};\n\n/**\r\n * A React context for sharing the `focused` state of the editor.\r\n */\n\nvar FocusedContext = createContext(false);\n/**\r\n * Get the current `focused` state of the editor.\r\n */\n\nvar useFocused = () => {\n  return useContext(FocusedContext);\n};\n\n/**\r\n * A React context for sharing the editor object.\r\n */\n\nvar EditorContext = createContext(null);\n/**\r\n * Get the current editor object from the React context.\r\n */\n\nvar useEditor = () => {\n  var editor = useContext(EditorContext);\n\n  if (!editor) {\n    throw new Error(\"The `useEditor` hook must be used inside the <Slate> component's context.\");\n  }\n\n  return editor;\n};\n\n/**\r\n * A React context for sharing the editor object, in a way that re-renders the\r\n * context whenever changes occur.\r\n */\n\nvar SlateContext = createContext(null);\n/**\r\n * Get the current editor object from the React context.\r\n */\n\nvar useSlate = () => {\n  var context = useContext(SlateContext);\n\n  if (!context) {\n    throw new Error(\"The `useSlate` hook must be used inside the <SlateProvider> component's context.\");\n  }\n\n  var [editor] = context;\n  return editor;\n};\n\n/**\r\n * A wrapper around the provider to handle `onChange` events, because the editor\r\n * is a mutable singleton so it won't ever register as \"changed\" otherwise.\r\n */\n\nvar Slate = props => {\n  var {\n    editor,\n    children,\n    onChange,\n    value\n  } = props,\n      rest = _objectWithoutProperties(props, [\"editor\", \"children\", \"onChange\", \"value\"]);\n\n  var [key, setKey] = useState(0);\n  var context = useMemo(() => {\n    editor.children = value;\n    Object.assign(editor, rest);\n    return [editor];\n  }, [key, value, ...Object.values(rest)]);\n  var onContextChange = useCallback(() => {\n    onChange(editor.children);\n    setKey(key + 1);\n  }, [key, onChange]);\n  EDITOR_TO_ON_CHANGE.set(editor, onContextChange);\n  useEffect(() => {\n    return () => {\n      EDITOR_TO_ON_CHANGE.set(editor, () => {});\n    };\n  }, []);\n  return React.createElement(SlateContext.Provider, {\n    value: context\n  }, React.createElement(EditorContext.Provider, {\n    value: editor\n  }, React.createElement(FocusedContext.Provider, {\n    value: ReactEditor.isFocused(editor)\n  }, children)));\n};\n\n/**\r\n * A React context for sharing the `readOnly` state of the editor.\r\n */\n\nvar ReadOnlyContext = createContext(false);\n/**\r\n * Get the current `readOnly` state of the editor.\r\n */\n\nvar useReadOnly = () => {\n  return useContext(ReadOnlyContext);\n};\n\n/**\r\n * A React context for sharing the `selected` state of an element.\r\n */\n\nvar SelectedContext = createContext(false);\n/**\r\n * Get the current `selected` state of an element.\r\n */\n\nvar useSelected = () => {\n  return useContext(SelectedContext);\n};\n\n/**\r\n * `withReact` adds React and DOM specific behaviors to the editor.\r\n */\n\nvar withReact = editor => {\n  var e = editor;\n  var {\n    apply,\n    onChange\n  } = e;\n\n  e.apply = op => {\n    var matches = [];\n\n    switch (op.type) {\n      case 'insert_text':\n      case 'remove_text':\n      case 'set_node':\n        {\n          for (var [node, path] of Editor.levels(e, {\n            at: op.path\n          })) {\n            var key = ReactEditor.findKey(e, node);\n            matches.push([path, key]);\n          }\n\n          break;\n        }\n\n      case 'insert_node':\n      case 'remove_node':\n      case 'merge_node':\n      case 'split_node':\n        {\n          for (var [_node, _path] of Editor.levels(e, {\n            at: Path.parent(op.path)\n          })) {\n            var _key = ReactEditor.findKey(e, _node);\n\n            matches.push([_path, _key]);\n          }\n\n          break;\n        }\n    }\n\n    apply(op);\n\n    for (var [_path2, _key2] of matches) {\n      var [_node2] = Editor.node(e, _path2);\n      NODE_TO_KEY.set(_node2, _key2);\n    }\n  };\n\n  e.setFragmentData = data => {\n    var {\n      selection\n    } = e;\n\n    if (!selection) {\n      return;\n    }\n\n    var [start, end] = Range.edges(selection);\n    var startVoid = Editor.void(e, {\n      at: start.path\n    });\n    var endVoid = Editor.void(e, {\n      at: end.path\n    });\n\n    if (Range.isCollapsed(selection) && !startVoid) {\n      return;\n    } // Create a fake selection so that we can add a Base64-encoded copy of the\n    // fragment to the HTML, to decode on future pastes.\n\n\n    var domRange = ReactEditor.toDOMRange(e, selection);\n    var contents = domRange.cloneContents();\n    var attach = contents.childNodes[0]; // Make sure attach is non-empty, since empty nodes will not get copied.\n\n    contents.childNodes.forEach(node => {\n      if (node.textContent && node.textContent.trim() !== '') {\n        attach = node;\n      }\n    }); // COMPAT: If the end node is a void node, we need to move the end of the\n    // range from the void node's spacer span, to the end of the void node's\n    // content, since the spacer is before void's content in the DOM.\n\n    if (endVoid) {\n      var [voidNode] = endVoid;\n      var r = domRange.cloneRange();\n      var domNode = ReactEditor.toDOMNode(e, voidNode);\n      r.setEndAfter(domNode);\n      contents = r.cloneContents();\n    } // COMPAT: If the start node is a void node, we need to attach the encoded\n    // fragment to the void node's content node instead of the spacer, because\n    // attaching it to empty `<div>/<span>` nodes will end up having it erased by\n    // most browsers. (2018/04/27)\n\n\n    if (startVoid) {\n      attach = contents.querySelector('[data-slate-spacer]');\n    } // Remove any zero-width space spans from the cloned DOM so that they don't\n    // show up elsewhere when pasted.\n\n\n    Array.from(contents.querySelectorAll('[data-slate-zero-width]')).forEach(zw => {\n      var isNewline = zw.getAttribute('data-slate-zero-width') === 'n';\n      zw.textContent = isNewline ? '\\n' : '';\n    }); // Set a `data-slate-fragment` attribute on a non-empty node, so it shows up\n    // in the HTML, and can be used for intra-Slate pasting. If it's a text\n    // node, wrap it in a `<span>` so we have something to set an attribute on.\n\n    if (isDOMText(attach)) {\n      var span = document.createElement('span'); // COMPAT: In Chrome and Safari, if we don't add the `white-space` style\n      // then leading and trailing spaces will be ignored. (2017/09/21)\n\n      span.style.whiteSpace = 'pre';\n      span.appendChild(attach);\n      contents.appendChild(span);\n      attach = span;\n    }\n\n    var fragment = e.getFragment();\n    var string = JSON.stringify(fragment);\n    var encoded = window.btoa(encodeURIComponent(string));\n    attach.setAttribute('data-slate-fragment', encoded);\n    data.setData('application/x-slate-fragment', encoded); // Add the content to a <div> so that we can get its inner HTML.\n\n    var div = document.createElement('div');\n    div.appendChild(contents);\n    div.setAttribute('hidden', 'true');\n    document.body.appendChild(div);\n    data.setData('text/html', div.innerHTML);\n    data.setData('text/plain', getPlainText(div));\n    document.body.removeChild(div);\n  };\n\n  e.insertData = data => {\n    var fragment = data.getData('application/x-slate-fragment');\n\n    if (fragment) {\n      var decoded = decodeURIComponent(window.atob(fragment));\n      var parsed = JSON.parse(decoded);\n      Transforms.insertFragment(e, parsed);\n      return;\n    }\n\n    var text = data.getData('text/plain');\n\n    if (text) {\n      var lines = text.split(/\\r\\n|\\r|\\n/);\n      var split = false;\n\n      for (var line of lines) {\n        if (split) {\n          Transforms.splitNodes(e, {\n            always: true\n          });\n        }\n\n        Transforms.insertText(e, line);\n        split = true;\n      }\n    }\n  };\n\n  e.onChange = () => {\n    // COMPAT: React doesn't batch `setState` hook calls, which means that the\n    // children and selection can get out of sync for one render pass. So we\n    // have to use this unstable API to ensure it batches them. (2019/12/03)\n    // https://github.com/facebook/react/issues/14259#issuecomment-439702367\n    ReactDOM.unstable_batchedUpdates(() => {\n      var onContextChange = EDITOR_TO_ON_CHANGE.get(e);\n\n      if (onContextChange) {\n        onContextChange();\n      }\n\n      onChange();\n    });\n  };\n\n  return e;\n};\n\n/**\r\n * Leaf content strings.\r\n */\n\nvar String = props => {\n  var {\n    isLast,\n    leaf,\n    parent,\n    text\n  } = props;\n  var editor = useEditor();\n  var path = ReactEditor.findPath(editor, text);\n  var parentPath = Path.parent(path); // COMPAT: Render text inside void nodes with a zero-width space.\n  // So the node can contain selection but the text is not visible.\n\n  if (editor.isVoid(parent)) {\n    return React.createElement(ZeroWidthString, {\n      length: Node$1.string(parent).length\n    });\n  } // COMPAT: If this is the last text node in an empty block, render a zero-\n  // width space that will convert into a line break when copying and pasting\n  // to support expected plain text.\n\n\n  if (leaf.text === '' && parent.children[parent.children.length - 1] === text && !editor.isInline(parent) && Editor.string(editor, parentPath) === '') {\n    return React.createElement(ZeroWidthString, {\n      isLineBreak: true\n    });\n  } // COMPAT: If the text is empty, it's because it's on the edge of an inline\n  // node, so we render a zero-width space so that the selection can be\n  // inserted next to it still.\n\n\n  if (leaf.text === '') {\n    return React.createElement(ZeroWidthString, null);\n  } // COMPAT: Browsers will collapse trailing new lines at the end of blocks,\n  // so we need to add an extra trailing new lines to prevent that.\n\n\n  if (isLast && leaf.text.slice(-1) === '\\n') {\n    return React.createElement(TextString, {\n      isTrailing: true,\n      text: leaf.text\n    });\n  }\n\n  return React.createElement(TextString, {\n    text: leaf.text\n  });\n};\n/**\r\n * Leaf strings with text in them.\r\n */\n\n\nvar TextString = props => {\n  var {\n    text,\n    isTrailing = false\n  } = props;\n  return React.createElement(\"span\", {\n    \"data-slate-string\": true\n  }, text, isTrailing ? '\\n' : null);\n};\n/**\r\n * Leaf strings without text, render as zero-width strings.\r\n */\n\n\nvar ZeroWidthString = props => {\n  var {\n    length = 0,\n    isLineBreak = false\n  } = props;\n  return React.createElement(\"span\", {\n    \"data-slate-zero-width\": isLineBreak ? 'n' : 'z',\n    \"data-slate-length\": length\n  }, '\\uFEFF', isLineBreak ? React.createElement(\"br\", null) : null);\n};\n\n/**\r\n * Individual leaves in a text node with unique formatting.\r\n */\n\nvar Leaf = props => {\n  var {\n    leaf,\n    isLast,\n    text,\n    parent,\n    renderLeaf = props => React.createElement(DefaultLeaf, Object.assign({}, props))\n  } = props;\n  var children = React.createElement(String, {\n    isLast: isLast,\n    leaf: leaf,\n    parent: parent,\n    text: text\n  });\n\n  if (leaf[PLACEHOLDER_SYMBOL]) {\n    children = React.createElement(React.Fragment, null, React.createElement(\"span\", {\n      contentEditable: false,\n      style: {\n        pointerEvents: 'none',\n        display: 'inline-block',\n        verticalAlign: 'text-top',\n        width: '0',\n        maxWidth: '100%',\n        whiteSpace: 'nowrap',\n        opacity: '0.333',\n        userSelect: 'none',\n        fontStyle: 'normal',\n        fontWeight: 'normal',\n        textDecoration: 'none'\n      }\n    }, leaf.placeholder), children);\n  } // COMPAT: Having the `data-` attributes on these leaf elements ensures that\n  // in certain misbehaving browsers they aren't weirdly cloned/destroyed by\n  // contenteditable behaviors. (2019/05/08)\n\n\n  var attributes = {\n    'data-slate-leaf': true\n  };\n  return renderLeaf({\n    attributes,\n    children,\n    leaf,\n    text\n  });\n};\n\nvar MemoizedLeaf = React.memo(Leaf, (prev, next) => {\n  return next.parent === prev.parent && next.isLast === prev.isLast && next.renderLeaf === prev.renderLeaf && next.text === prev.text && Text$1.matches(next.leaf, prev.leaf);\n});\n/**\r\n * The default custom leaf renderer.\r\n */\n\nvar DefaultLeaf = props => {\n  var {\n    attributes,\n    children\n  } = props;\n  return React.createElement(\"span\", Object.assign({}, attributes), children);\n};\n\n/**\r\n * Prevent warning on SSR by falling back to useEffect when window is not defined\r\n */\n\nvar useIsomorphicLayoutEffect = typeof window !== 'undefined' ? useLayoutEffect : useEffect;\n\n/**\r\n * Text.\r\n */\n\nvar Text = props => {\n  var {\n    decorations,\n    isLast,\n    parent,\n    renderLeaf,\n    text\n  } = props;\n  var editor = useEditor();\n  var ref = useRef(null);\n  var leaves = Text$1.decorations(text, decorations);\n  var key = ReactEditor.findKey(editor, text);\n  var children = [];\n\n  for (var i = 0; i < leaves.length; i++) {\n    var leaf = leaves[i];\n    children.push(React.createElement(MemoizedLeaf, {\n      isLast: isLast && i === leaves.length - 1,\n      key: \"\".concat(key.id, \"-\").concat(i),\n      leaf: leaf,\n      text: text,\n      parent: parent,\n      renderLeaf: renderLeaf\n    }));\n  } // Update element-related weak maps with the DOM element ref.\n\n\n  useIsomorphicLayoutEffect(() => {\n    if (ref.current) {\n      KEY_TO_ELEMENT.set(key, ref.current);\n      NODE_TO_ELEMENT.set(text, ref.current);\n      ELEMENT_TO_NODE.set(ref.current, text);\n    } else {\n      KEY_TO_ELEMENT.delete(key);\n      NODE_TO_ELEMENT.delete(text);\n    }\n  });\n  return React.createElement(\"span\", {\n    \"data-slate-node\": \"text\",\n    ref: ref\n  }, children);\n};\n\nvar MemoizedText = React.memo(Text, (prev, next) => {\n  return next.parent === prev.parent && next.isLast === prev.isLast && next.renderLeaf === prev.renderLeaf && next.text === prev.text;\n});\n\n/**\r\n * Element.\r\n */\n\nvar Element = props => {\n  var {\n    decorate,\n    decorations,\n    element,\n    renderElement = p => React.createElement(DefaultElement, Object.assign({}, p)),\n    renderLeaf,\n    selection\n  } = props;\n  var ref = useRef(null);\n  var editor = useEditor();\n  var readOnly = useReadOnly();\n  var isInline = editor.isInline(element);\n  var key = ReactEditor.findKey(editor, element);\n  var children = React.createElement(Children, {\n    decorate: decorate,\n    decorations: decorations,\n    node: element,\n    renderElement: renderElement,\n    renderLeaf: renderLeaf,\n    selection: selection\n  }); // Attributes that the developer must mix into the element in their\n  // custom node renderer component.\n\n  var attributes = {\n    'data-slate-node': 'element',\n    ref\n  };\n\n  if (isInline) {\n    attributes['data-slate-inline'] = true;\n  } // If it's a block node with inline children, add the proper `dir` attribute\n  // for text direction.\n\n\n  if (!isInline && Editor.hasInlines(editor, element)) {\n    var text = Node$1.string(element);\n    var dir = getDirection(text);\n\n    if (dir === 'rtl') {\n      attributes.dir = dir;\n    }\n  } // If it's a void node, wrap the children in extra void-specific elements.\n\n\n  if (Editor.isVoid(editor, element)) {\n    attributes['data-slate-void'] = true;\n\n    if (!readOnly && isInline) {\n      attributes.contentEditable = false;\n    }\n\n    var Tag = isInline ? 'span' : 'div';\n    var [[_text]] = Node$1.texts(element);\n    children = readOnly ? null : React.createElement(Tag, {\n      \"data-slate-spacer\": true,\n      style: {\n        height: '0',\n        color: 'transparent',\n        outline: 'none',\n        position: 'absolute'\n      }\n    }, React.createElement(MemoizedText, {\n      decorations: [],\n      isLast: false,\n      parent: element,\n      text: _text\n    }));\n    NODE_TO_INDEX.set(_text, 0);\n    NODE_TO_PARENT.set(_text, element);\n  } // Update element-related weak maps with the DOM element ref.\n\n\n  useIsomorphicLayoutEffect(() => {\n    if (ref.current) {\n      KEY_TO_ELEMENT.set(key, ref.current);\n      NODE_TO_ELEMENT.set(element, ref.current);\n      ELEMENT_TO_NODE.set(ref.current, element);\n    } else {\n      KEY_TO_ELEMENT.delete(key);\n      NODE_TO_ELEMENT.delete(element);\n    }\n  });\n  return React.createElement(SelectedContext.Provider, {\n    value: !!selection\n  }, renderElement({\n    attributes,\n    children,\n    element\n  }));\n};\n\nvar MemoizedElement = React.memo(Element, (prev, next) => {\n  return prev.decorate === next.decorate && prev.element === next.element && prev.renderElement === next.renderElement && prev.renderLeaf === next.renderLeaf && isRangeListEqual(prev.decorations, next.decorations) && (prev.selection === next.selection || !!prev.selection && !!next.selection && Range.equals(prev.selection, next.selection));\n});\n/**\r\n * The default element renderer.\r\n */\n\nvar DefaultElement = props => {\n  var {\n    attributes,\n    children,\n    element\n  } = props;\n  var editor = useEditor();\n  var Tag = editor.isInline(element) ? 'span' : 'div';\n  return React.createElement(Tag, Object.assign({}, attributes, {\n    style: {\n      position: 'relative'\n    }\n  }), children);\n};\n/**\r\n * Check if a list of ranges is equal to another.\r\n *\r\n * PERF: this requires the two lists to also have the ranges inside them in the\r\n * same order, but this is an okay constraint for us since decorations are\r\n * kept in order, and the odd case where they aren't is okay to re-render for.\r\n */\n\nvar isRangeListEqual = (list, another) => {\n  if (list.length !== another.length) {\n    return false;\n  }\n\n  for (var i = 0; i < list.length; i++) {\n    var range = list[i];\n    var other = another[i];\n\n    if (!Range.equals(range, other)) {\n      return false;\n    }\n  }\n\n  return true;\n};\n\n/**\r\n * Children.\r\n */\n\nvar Children = props => {\n  var {\n    decorate,\n    decorations,\n    node,\n    renderElement,\n    renderLeaf,\n    selection\n  } = props;\n  var editor = useEditor();\n  var path = ReactEditor.findPath(editor, node);\n  var children = [];\n  var isLeafBlock = Element$1.isElement(node) && !editor.isInline(node) && Editor.hasInlines(editor, node);\n\n  for (var i = 0; i < node.children.length; i++) {\n    var p = path.concat(i);\n    var n = node.children[i];\n    var key = ReactEditor.findKey(editor, n);\n    var range = Editor.range(editor, p);\n    var sel = selection && Range.intersection(range, selection);\n    var ds = decorate([n, p]);\n\n    for (var dec of decorations) {\n      var d = Range.intersection(dec, range);\n\n      if (d) {\n        ds.push(d);\n      }\n    }\n\n    if (Element$1.isElement(n)) {\n      children.push(React.createElement(MemoizedElement, {\n        decorate: decorate,\n        decorations: ds,\n        element: n,\n        key: key.id,\n        renderElement: renderElement,\n        renderLeaf: renderLeaf,\n        selection: sel\n      }));\n    } else {\n      children.push(React.createElement(MemoizedText, {\n        decorations: ds,\n        key: key.id,\n        isLast: isLeafBlock && i === node.children.length - 1,\n        parent: node,\n        renderLeaf: renderLeaf,\n        text: n\n      }));\n    }\n\n    NODE_TO_INDEX.set(n, i);\n    NODE_TO_PARENT.set(n, node);\n  }\n\n  return React.createElement(React.Fragment, null, children);\n};\n\nvar IS_IOS = typeof navigator !== 'undefined' && typeof window !== 'undefined' && /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\nvar IS_APPLE = typeof navigator !== 'undefined' && /Mac OS X/.test(navigator.userAgent);\nvar IS_FIREFOX = typeof navigator !== 'undefined' && /^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent);\nvar IS_SAFARI = typeof navigator !== 'undefined' && /Version\\/[\\d\\.]+.*Safari/.test(navigator.userAgent); // \"modern\" Edge was released at 79.x\n\nvar IS_EDGE_LEGACY = typeof navigator !== 'undefined' && /Edge?\\/(?:[0-6][0-9]|[0-7][0-8])/i.test(navigator.userAgent);\n\n/**\r\n * Hotkey mappings for each platform.\r\n */\n\nvar HOTKEYS = {\n  bold: 'mod+b',\n  compose: ['down', 'left', 'right', 'up', 'backspace', 'enter'],\n  moveBackward: 'left',\n  moveForward: 'right',\n  moveWordBackward: 'ctrl+left',\n  moveWordForward: 'ctrl+right',\n  deleteBackward: 'shift?+backspace',\n  deleteForward: 'shift?+delete',\n  extendBackward: 'shift+left',\n  extendForward: 'shift+right',\n  italic: 'mod+i',\n  splitBlock: 'shift?+enter',\n  undo: 'mod+z'\n};\nvar APPLE_HOTKEYS = {\n  moveLineBackward: 'opt+up',\n  moveLineForward: 'opt+down',\n  moveWordBackward: 'opt+left',\n  moveWordForward: 'opt+right',\n  deleteBackward: ['ctrl+backspace', 'ctrl+h'],\n  deleteForward: ['ctrl+delete', 'ctrl+d'],\n  deleteLineBackward: 'cmd+shift?+backspace',\n  deleteLineForward: ['cmd+shift?+delete', 'ctrl+k'],\n  deleteWordBackward: 'opt+shift?+backspace',\n  deleteWordForward: 'opt+shift?+delete',\n  extendLineBackward: 'opt+shift+up',\n  extendLineForward: 'opt+shift+down',\n  redo: 'cmd+shift+z',\n  transposeCharacter: 'ctrl+t'\n};\nvar WINDOWS_HOTKEYS = {\n  deleteWordBackward: 'ctrl+shift?+backspace',\n  deleteWordForward: 'ctrl+shift?+delete',\n  redo: ['ctrl+y', 'ctrl+shift+z']\n};\n/**\r\n * Create a platform-aware hotkey checker.\r\n */\n\nvar create = key => {\n  var generic = HOTKEYS[key];\n  var apple = APPLE_HOTKEYS[key];\n  var windows = WINDOWS_HOTKEYS[key];\n  var isGeneric = generic && isKeyHotkey(generic);\n  var isApple = apple && isKeyHotkey(apple);\n  var isWindows = windows && isKeyHotkey(windows);\n  return event => {\n    if (isGeneric && isGeneric(event)) return true;\n    if (IS_APPLE && isApple && isApple(event)) return true;\n    if (!IS_APPLE && isWindows && isWindows(event)) return true;\n    return false;\n  };\n};\n/**\r\n * Hotkeys.\r\n */\n\n\nvar Hotkeys = {\n  isBold: create('bold'),\n  isCompose: create('compose'),\n  isMoveBackward: create('moveBackward'),\n  isMoveForward: create('moveForward'),\n  isDeleteBackward: create('deleteBackward'),\n  isDeleteForward: create('deleteForward'),\n  isDeleteLineBackward: create('deleteLineBackward'),\n  isDeleteLineForward: create('deleteLineForward'),\n  isDeleteWordBackward: create('deleteWordBackward'),\n  isDeleteWordForward: create('deleteWordForward'),\n  isExtendBackward: create('extendBackward'),\n  isExtendForward: create('extendForward'),\n  isExtendLineBackward: create('extendLineBackward'),\n  isExtendLineForward: create('extendLineForward'),\n  isItalic: create('italic'),\n  isMoveLineBackward: create('moveLineBackward'),\n  isMoveLineForward: create('moveLineForward'),\n  isMoveWordBackward: create('moveWordBackward'),\n  isMoveWordForward: create('moveWordForward'),\n  isRedo: create('redo'),\n  isSplitBlock: create('splitBlock'),\n  isTransposeCharacter: create('transposeCharacter'),\n  isUndo: create('undo')\n};\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nvar HAS_BEFORE_INPUT_SUPPORT = !(IS_FIREFOX || IS_EDGE_LEGACY);\n/**\r\n * Editable.\r\n */\n\nvar Editable = props => {\n  var {\n    autoFocus,\n    decorate = defaultDecorate,\n    onDOMBeforeInput: propsOnDOMBeforeInput,\n    placeholder,\n    readOnly = false,\n    renderElement,\n    renderLeaf,\n    style = {},\n    as: Component = 'div'\n  } = props,\n      attributes = _objectWithoutProperties(props, [\"autoFocus\", \"decorate\", \"onDOMBeforeInput\", \"placeholder\", \"readOnly\", \"renderElement\", \"renderLeaf\", \"style\", \"as\"]);\n\n  var editor = useSlate();\n  var ref = useRef(null); // Update internal state on each render.\n\n  IS_READ_ONLY.set(editor, readOnly); // Keep track of some state for the event handler logic.\n\n  var state = useMemo(() => ({\n    isComposing: false,\n    isUpdatingSelection: false,\n    latestElement: null\n  }), []); // Update element-related weak maps with the DOM element ref.\n\n  useIsomorphicLayoutEffect(() => {\n    if (ref.current) {\n      EDITOR_TO_ELEMENT.set(editor, ref.current);\n      NODE_TO_ELEMENT.set(editor, ref.current);\n      ELEMENT_TO_NODE.set(ref.current, editor);\n    } else {\n      NODE_TO_ELEMENT.delete(editor);\n    }\n  }); // Whenever the editor updates, make sure the DOM selection state is in sync.\n\n  useIsomorphicLayoutEffect(() => {\n    var {\n      selection\n    } = editor;\n    var domSelection = window.getSelection();\n\n    if (state.isComposing || !domSelection || !ReactEditor.isFocused(editor)) {\n      return;\n    }\n\n    var hasDomSelection = domSelection.type !== 'None'; // If the DOM selection is properly unset, we're done.\n\n    if (!selection && !hasDomSelection) {\n      return;\n    } // verify that the dom selection is in the editor\n\n\n    var editorElement = EDITOR_TO_ELEMENT.get(editor);\n    var hasDomSelectionInEditor = false;\n\n    if (editorElement.contains(domSelection.anchorNode) && editorElement.contains(domSelection.focusNode)) {\n      hasDomSelectionInEditor = true;\n    } // If the DOM selection is in the editor and the editor selection is already correct, we're done.\n\n\n    if (hasDomSelection && hasDomSelectionInEditor && selection && Range.equals(ReactEditor.toSlateRange(editor, domSelection), selection)) {\n      return;\n    } // Otherwise the DOM selection is out of sync, so update it.\n\n\n    var el = ReactEditor.toDOMNode(editor, editor);\n    state.isUpdatingSelection = true;\n    domSelection.removeAllRanges();\n    var newDomRange = selection && ReactEditor.toDOMRange(editor, selection);\n\n    if (newDomRange) {\n      domSelection.addRange(newDomRange);\n      var leafEl = newDomRange.startContainer.parentElement;\n      scrollIntoView(leafEl, {\n        scrollMode: 'if-needed',\n        boundary: el\n      });\n    }\n\n    setTimeout(() => {\n      // COMPAT: In Firefox, it's not enough to create a range, you also need\n      // to focus the contenteditable element too. (2016/11/16)\n      if (newDomRange && IS_FIREFOX) {\n        el.focus();\n      }\n\n      state.isUpdatingSelection = false;\n    });\n  }); // The autoFocus TextareaHTMLAttribute doesn't do anything on a div, so it\n  // needs to be manually focused.\n\n  useEffect(() => {\n    if (ref.current && autoFocus) {\n      ref.current.focus();\n    }\n  }, [autoFocus]); // Listen on the native `beforeinput` event to get real \"Level 2\" events. This\n  // is required because React's `beforeinput` is fake and never really attaches\n  // to the real event sadly. (2019/11/01)\n  // https://github.com/facebook/react/issues/11211\n\n  var onDOMBeforeInput = useCallback(event => {\n    if (!readOnly && hasEditableTarget(editor, event.target) && !isDOMEventHandled(event, propsOnDOMBeforeInput)) {\n      var {\n        selection\n      } = editor;\n      var {\n        inputType: type\n      } = event;\n      var data = event.dataTransfer || event.data || undefined; // These two types occur while a user is composing text and can't be\n      // cancelled. Let them through and wait for the composition to end.\n\n      if (type === 'insertCompositionText' || type === 'deleteCompositionText') {\n        return;\n      }\n\n      event.preventDefault(); // COMPAT: For the deleting forward/backward input types we don't want\n      // to change the selection because it is the range that will be deleted,\n      // and those commands determine that for themselves.\n\n      if (!type.startsWith('delete') || type.startsWith('deleteBy')) {\n        var [targetRange] = event.getTargetRanges();\n\n        if (targetRange) {\n          var range = ReactEditor.toSlateRange(editor, targetRange);\n\n          if (!selection || !Range.equals(selection, range)) {\n            Transforms.select(editor, range);\n          }\n        }\n      } // COMPAT: If the selection is expanded, even if the command seems like\n      // a delete forward/backward command it should delete the selection.\n\n\n      if (selection && Range.isExpanded(selection) && type.startsWith('delete')) {\n        Editor.deleteFragment(editor);\n        return;\n      }\n\n      switch (type) {\n        case 'deleteByComposition':\n        case 'deleteByCut':\n        case 'deleteByDrag':\n          {\n            Editor.deleteFragment(editor);\n            break;\n          }\n\n        case 'deleteContent':\n        case 'deleteContentForward':\n          {\n            Editor.deleteForward(editor);\n            break;\n          }\n\n        case 'deleteContentBackward':\n          {\n            Editor.deleteBackward(editor);\n            break;\n          }\n\n        case 'deleteEntireSoftLine':\n          {\n            Editor.deleteBackward(editor, {\n              unit: 'line'\n            });\n            Editor.deleteForward(editor, {\n              unit: 'line'\n            });\n            break;\n          }\n\n        case 'deleteHardLineBackward':\n          {\n            Editor.deleteBackward(editor, {\n              unit: 'block'\n            });\n            break;\n          }\n\n        case 'deleteSoftLineBackward':\n          {\n            Editor.deleteBackward(editor, {\n              unit: 'line'\n            });\n            break;\n          }\n\n        case 'deleteHardLineForward':\n          {\n            Editor.deleteForward(editor, {\n              unit: 'block'\n            });\n            break;\n          }\n\n        case 'deleteSoftLineForward':\n          {\n            Editor.deleteForward(editor, {\n              unit: 'line'\n            });\n            break;\n          }\n\n        case 'deleteWordBackward':\n          {\n            Editor.deleteBackward(editor, {\n              unit: 'word'\n            });\n            break;\n          }\n\n        case 'deleteWordForward':\n          {\n            Editor.deleteForward(editor, {\n              unit: 'word'\n            });\n            break;\n          }\n\n        case 'insertLineBreak':\n        case 'insertParagraph':\n          {\n            Editor.insertBreak(editor);\n            break;\n          }\n\n        case 'insertFromComposition':\n        case 'insertFromDrop':\n        case 'insertFromPaste':\n        case 'insertFromYank':\n        case 'insertReplacementText':\n        case 'insertText':\n          {\n            if (data instanceof DataTransfer) {\n              ReactEditor.insertData(editor, data);\n            } else if (typeof data === 'string') {\n              Editor.insertText(editor, data);\n            }\n\n            break;\n          }\n      }\n    }\n  }, [readOnly]); // Attach a native DOM event handler for `beforeinput` events, because React's\n  // built-in `onBeforeInput` is actually a leaky polyfill that doesn't expose\n  // real `beforeinput` events sadly... (2019/11/04)\n  // https://github.com/facebook/react/issues/11211\n\n  useIsomorphicLayoutEffect(() => {\n    if (ref.current) {\n      // @ts-ignore The `beforeinput` event isn't recognized.\n      ref.current.addEventListener('beforeinput', onDOMBeforeInput);\n    }\n\n    return () => {\n      if (ref.current) {\n        // @ts-ignore The `beforeinput` event isn't recognized.\n        ref.current.removeEventListener('beforeinput', onDOMBeforeInput);\n      }\n    };\n  }, [onDOMBeforeInput]); // Listen on the native `selectionchange` event to be able to update any time\n  // the selection changes. This is required because React's `onSelect` is leaky\n  // and non-standard so it doesn't fire until after a selection has been\n  // released. This causes issues in situations where another change happens\n  // while a selection is being dragged.\n\n  var onDOMSelectionChange = useCallback(throttle(() => {\n    if (!readOnly && !state.isComposing && !state.isUpdatingSelection) {\n      var {\n        activeElement\n      } = window.document;\n      var el = ReactEditor.toDOMNode(editor, editor);\n      var domSelection = window.getSelection();\n\n      if (activeElement === el) {\n        state.latestElement = activeElement;\n        IS_FOCUSED.set(editor, true);\n      } else {\n        IS_FOCUSED.delete(editor);\n      }\n\n      if (!domSelection) {\n        return Transforms.deselect(editor);\n      }\n\n      var {\n        anchorNode,\n        focusNode\n      } = domSelection;\n      var anchorNodeSelectable = hasEditableTarget(editor, anchorNode) || isTargetInsideVoid(editor, anchorNode);\n      var focusNodeSelectable = hasEditableTarget(editor, focusNode) || isTargetInsideVoid(editor, focusNode);\n\n      if (anchorNodeSelectable && focusNodeSelectable) {\n        var range = ReactEditor.toSlateRange(editor, domSelection);\n        Transforms.select(editor, range);\n      } else {\n        Transforms.deselect(editor);\n      }\n    }\n  }, 100), [readOnly]); // Attach a native DOM event handler for `selectionchange`, because React's\n  // built-in `onSelect` handler doesn't fire for all selection changes. It's a\n  // leaky polyfill that only fires on keypresses or clicks. Instead, we want to\n  // fire for any change to the selection inside the editor. (2019/11/04)\n  // https://github.com/facebook/react/issues/5785\n\n  useIsomorphicLayoutEffect(() => {\n    window.document.addEventListener('selectionchange', onDOMSelectionChange);\n    return () => {\n      window.document.removeEventListener('selectionchange', onDOMSelectionChange);\n    };\n  }, [onDOMSelectionChange]);\n  var decorations = decorate([editor, []]);\n\n  if (placeholder && editor.children.length === 1 && Array.from(Node$1.texts(editor)).length === 1 && Node$1.string(editor) === '') {\n    var start = Editor.start(editor, []);\n    decorations.push({\n      [PLACEHOLDER_SYMBOL]: true,\n      placeholder,\n      anchor: start,\n      focus: start\n    });\n  }\n\n  return React.createElement(ReadOnlyContext.Provider, {\n    value: readOnly\n  }, React.createElement(Component // COMPAT: The Grammarly Chrome extension works by changing the DOM\n  // out from under `contenteditable` elements, which leads to weird\n  // behaviors so we have to disable it like editor. (2017/04/24)\n  , Object.assign({\n    \"data-gramm\": false,\n    role: readOnly ? undefined : 'textbox'\n  }, attributes, {\n    // COMPAT: Certain browsers don't support the `beforeinput` event, so we'd\n    // have to use hacks to make these replacement-based features work.\n    spellCheck: !HAS_BEFORE_INPUT_SUPPORT ? undefined : attributes.spellCheck,\n    autoCorrect: !HAS_BEFORE_INPUT_SUPPORT ? undefined : attributes.autoCorrect,\n    autoCapitalize: !HAS_BEFORE_INPUT_SUPPORT ? undefined : attributes.autoCapitalize,\n    \"data-slate-editor\": true,\n    \"data-slate-node\": \"value\",\n    contentEditable: readOnly ? undefined : true,\n    suppressContentEditableWarning: true,\n    ref: ref,\n    style: _objectSpread({\n      // Prevent the default outline styles.\n      outline: 'none',\n      // Preserve adjacent whitespace and new lines.\n      whiteSpace: 'pre-wrap',\n      // Allow words to break if they are too long.\n      wordWrap: 'break-word'\n    }, style),\n    onBeforeInput: useCallback(event => {\n      // COMPAT: Certain browsers don't support the `beforeinput` event, so we\n      // fall back to React's leaky polyfill instead just for it. It\n      // only works for the `insertText` input type.\n      if (!HAS_BEFORE_INPUT_SUPPORT && !readOnly && !isEventHandled(event, attributes.onBeforeInput) && hasEditableTarget(editor, event.target)) {\n        event.preventDefault();\n        var text = event.data;\n        Editor.insertText(editor, text);\n      }\n    }, [readOnly]),\n    onBlur: useCallback(event => {\n      if (readOnly || state.isUpdatingSelection || !hasEditableTarget(editor, event.target) || isEventHandled(event, attributes.onBlur)) {\n        return;\n      } // COMPAT: If the current `activeElement` is still the previous\n      // one, this is due to the window being blurred when the tab\n      // itself becomes unfocused, so we want to abort early to allow to\n      // editor to stay focused when the tab becomes focused again.\n\n\n      if (state.latestElement === window.document.activeElement) {\n        return;\n      }\n\n      var {\n        relatedTarget\n      } = event;\n      var el = ReactEditor.toDOMNode(editor, editor); // COMPAT: The event should be ignored if the focus is returning\n      // to the editor from an embedded editable element (eg. an <input>\n      // element inside a void node).\n\n      if (relatedTarget === el) {\n        return;\n      } // COMPAT: The event should be ignored if the focus is moving from\n      // the editor to inside a void node's spacer element.\n\n\n      if (isDOMElement(relatedTarget) && relatedTarget.hasAttribute('data-slate-spacer')) {\n        return;\n      } // COMPAT: The event should be ignored if the focus is moving to a\n      // non- editable section of an element that isn't a void node (eg.\n      // a list item of the check list example).\n\n\n      if (relatedTarget != null && isDOMNode(relatedTarget) && ReactEditor.hasDOMNode(editor, relatedTarget)) {\n        var node = ReactEditor.toSlateNode(editor, relatedTarget);\n\n        if (Element$1.isElement(node) && !editor.isVoid(node)) {\n          return;\n        }\n      }\n\n      IS_FOCUSED.delete(editor);\n    }, [readOnly, attributes.onBlur]),\n    onClick: useCallback(event => {\n      if (!readOnly && hasTarget(editor, event.target) && !isEventHandled(event, attributes.onClick) && isDOMNode(event.target)) {\n        var node = ReactEditor.toSlateNode(editor, event.target);\n        var path = ReactEditor.findPath(editor, node);\n\n        var _start = Editor.start(editor, path);\n\n        var end = Editor.end(editor, path);\n        var startVoid = Editor.void(editor, {\n          at: _start\n        });\n        var endVoid = Editor.void(editor, {\n          at: end\n        });\n\n        if (startVoid && endVoid && Path.equals(startVoid[1], endVoid[1])) {\n          var range = Editor.range(editor, _start);\n          Transforms.select(editor, range);\n        }\n      }\n    }, [readOnly, attributes.onClick]),\n    onCompositionEnd: useCallback(event => {\n      if (hasEditableTarget(editor, event.target) && !isEventHandled(event, attributes.onCompositionEnd)) {\n        state.isComposing = false; // COMPAT: In Chrome, `beforeinput` events for compositions\n        // aren't correct and never fire the \"insertFromComposition\"\n        // type that we need. So instead, insert whenever a composition\n        // ends since it will already have been committed to the DOM.\n\n        if (!IS_SAFARI && !IS_FIREFOX && event.data) {\n          Editor.insertText(editor, event.data);\n        }\n      }\n    }, [attributes.onCompositionEnd]),\n    onCompositionStart: useCallback(event => {\n      if (hasEditableTarget(editor, event.target) && !isEventHandled(event, attributes.onCompositionStart)) {\n        state.isComposing = true;\n      }\n    }, [attributes.onCompositionStart]),\n    onCopy: useCallback(event => {\n      if (hasEditableTarget(editor, event.target) && !isEventHandled(event, attributes.onCopy)) {\n        event.preventDefault();\n        ReactEditor.setFragmentData(editor, event.clipboardData);\n      }\n    }, [attributes.onCopy]),\n    onCut: useCallback(event => {\n      if (!readOnly && hasEditableTarget(editor, event.target) && !isEventHandled(event, attributes.onCut)) {\n        event.preventDefault();\n        ReactEditor.setFragmentData(editor, event.clipboardData);\n        var {\n          selection\n        } = editor;\n\n        if (selection && Range.isExpanded(selection)) {\n          Editor.deleteFragment(editor);\n        }\n      }\n    }, [readOnly, attributes.onCut]),\n    onDragOver: useCallback(event => {\n      if (hasTarget(editor, event.target) && !isEventHandled(event, attributes.onDragOver)) {\n        // Only when the target is void, call `preventDefault` to signal\n        // that drops are allowed. Editable content is droppable by\n        // default, and calling `preventDefault` hides the cursor.\n        var node = ReactEditor.toSlateNode(editor, event.target);\n\n        if (Editor.isVoid(editor, node)) {\n          event.preventDefault();\n        }\n      }\n    }, [attributes.onDragOver]),\n    onDragStart: useCallback(event => {\n      if (hasTarget(editor, event.target) && !isEventHandled(event, attributes.onDragStart)) {\n        var node = ReactEditor.toSlateNode(editor, event.target);\n        var path = ReactEditor.findPath(editor, node);\n        var voidMatch = Editor.void(editor, {\n          at: path\n        }); // If starting a drag on a void node, make sure it is selected\n        // so that it shows up in the selection's fragment.\n\n        if (voidMatch) {\n          var range = Editor.range(editor, path);\n          Transforms.select(editor, range);\n        }\n\n        ReactEditor.setFragmentData(editor, event.dataTransfer);\n      }\n    }, [attributes.onDragStart]),\n    onDrop: useCallback(event => {\n      if (hasTarget(editor, event.target) && !readOnly && !isEventHandled(event, attributes.onDrop)) {\n        // COMPAT: Certain browsers don't fire `beforeinput` events at all, and\n        // Chromium browsers don't properly fire them for files being\n        // dropped into a `contenteditable`. (2019/11/26)\n        // https://bugs.chromium.org/p/chromium/issues/detail?id=1028668\n        if (!HAS_BEFORE_INPUT_SUPPORT || !IS_SAFARI && event.dataTransfer.files.length > 0) {\n          event.preventDefault();\n          var range = ReactEditor.findEventRange(editor, event);\n          var data = event.dataTransfer;\n          Transforms.select(editor, range);\n          ReactEditor.insertData(editor, data);\n        }\n      }\n    }, [readOnly, attributes.onDrop]),\n    onFocus: useCallback(event => {\n      if (!readOnly && !state.isUpdatingSelection && hasEditableTarget(editor, event.target) && !isEventHandled(event, attributes.onFocus)) {\n        var el = ReactEditor.toDOMNode(editor, editor);\n        state.latestElement = window.document.activeElement; // COMPAT: If the editor has nested editable elements, the focus\n        // can go to them. In Firefox, this must be prevented because it\n        // results in issues with keyboard navigation. (2017/03/30)\n\n        if (IS_FIREFOX && event.target !== el) {\n          el.focus();\n          return;\n        }\n\n        IS_FOCUSED.set(editor, true);\n      }\n    }, [readOnly, attributes.onFocus]),\n    onKeyDown: useCallback(event => {\n      if (!readOnly && hasEditableTarget(editor, event.target) && !isEventHandled(event, attributes.onKeyDown)) {\n        var {\n          nativeEvent\n        } = event;\n        var {\n          selection\n        } = editor; // COMPAT: Since we prevent the default behavior on\n        // `beforeinput` events, the browser doesn't think there's ever\n        // any history stack to undo or redo, so we have to manage these\n        // hotkeys ourselves. (2019/11/06)\n\n        if (Hotkeys.isRedo(nativeEvent)) {\n          event.preventDefault();\n\n          if (typeof editor.redo === 'function') {\n            editor.redo();\n          }\n\n          return;\n        }\n\n        if (Hotkeys.isUndo(nativeEvent)) {\n          event.preventDefault();\n\n          if (typeof editor.undo === 'function') {\n            editor.undo();\n          }\n\n          return;\n        } // COMPAT: Certain browsers don't handle the selection updates\n        // properly. In Chrome, the selection isn't properly extended.\n        // And in Firefox, the selection isn't properly collapsed.\n        // (2017/10/17)\n\n\n        if (Hotkeys.isMoveLineBackward(nativeEvent)) {\n          event.preventDefault();\n          Transforms.move(editor, {\n            unit: 'line',\n            reverse: true\n          });\n          return;\n        }\n\n        if (Hotkeys.isMoveLineForward(nativeEvent)) {\n          event.preventDefault();\n          Transforms.move(editor, {\n            unit: 'line'\n          });\n          return;\n        }\n\n        if (Hotkeys.isExtendLineBackward(nativeEvent)) {\n          event.preventDefault();\n          Transforms.move(editor, {\n            unit: 'line',\n            edge: 'focus',\n            reverse: true\n          });\n          return;\n        }\n\n        if (Hotkeys.isExtendLineForward(nativeEvent)) {\n          event.preventDefault();\n          Transforms.move(editor, {\n            unit: 'line',\n            edge: 'focus'\n          });\n          return;\n        } // COMPAT: If a void node is selected, or a zero-width text node\n        // adjacent to an inline is selected, we need to handle these\n        // hotkeys manually because browsers won't be able to skip over\n        // the void node with the zero-width space not being an empty\n        // string.\n\n\n        if (Hotkeys.isMoveBackward(nativeEvent)) {\n          event.preventDefault();\n\n          if (selection && Range.isCollapsed(selection)) {\n            Transforms.move(editor, {\n              reverse: true\n            });\n          } else {\n            Transforms.collapse(editor, {\n              edge: 'start'\n            });\n          }\n\n          return;\n        }\n\n        if (Hotkeys.isMoveForward(nativeEvent)) {\n          event.preventDefault();\n\n          if (selection && Range.isCollapsed(selection)) {\n            Transforms.move(editor);\n          } else {\n            Transforms.collapse(editor, {\n              edge: 'end'\n            });\n          }\n\n          return;\n        }\n\n        if (Hotkeys.isMoveWordBackward(nativeEvent)) {\n          event.preventDefault();\n          Transforms.move(editor, {\n            unit: 'word',\n            reverse: true\n          });\n          return;\n        }\n\n        if (Hotkeys.isMoveWordForward(nativeEvent)) {\n          event.preventDefault();\n          Transforms.move(editor, {\n            unit: 'word'\n          });\n          return;\n        } // COMPAT: Certain browsers don't support the `beforeinput` event, so we\n        // fall back to guessing at the input intention for hotkeys.\n        // COMPAT: In iOS, some of these hotkeys are handled in the\n\n\n        if (!HAS_BEFORE_INPUT_SUPPORT) {\n          // We don't have a core behavior for these, but they change the\n          // DOM if we don't prevent them, so we have to.\n          if (Hotkeys.isBold(nativeEvent) || Hotkeys.isItalic(nativeEvent) || Hotkeys.isTransposeCharacter(nativeEvent)) {\n            event.preventDefault();\n            return;\n          }\n\n          if (Hotkeys.isSplitBlock(nativeEvent)) {\n            event.preventDefault();\n            Editor.insertBreak(editor);\n            return;\n          }\n\n          if (Hotkeys.isDeleteBackward(nativeEvent)) {\n            event.preventDefault();\n\n            if (selection && Range.isExpanded(selection)) {\n              Editor.deleteFragment(editor);\n            } else {\n              Editor.deleteBackward(editor);\n            }\n\n            return;\n          }\n\n          if (Hotkeys.isDeleteForward(nativeEvent)) {\n            event.preventDefault();\n\n            if (selection && Range.isExpanded(selection)) {\n              Editor.deleteFragment(editor);\n            } else {\n              Editor.deleteForward(editor);\n            }\n\n            return;\n          }\n\n          if (Hotkeys.isDeleteLineBackward(nativeEvent)) {\n            event.preventDefault();\n\n            if (selection && Range.isExpanded(selection)) {\n              Editor.deleteFragment(editor);\n            } else {\n              Editor.deleteBackward(editor, {\n                unit: 'line'\n              });\n            }\n\n            return;\n          }\n\n          if (Hotkeys.isDeleteLineForward(nativeEvent)) {\n            event.preventDefault();\n\n            if (selection && Range.isExpanded(selection)) {\n              Editor.deleteFragment(editor);\n            } else {\n              Editor.deleteForward(editor, {\n                unit: 'line'\n              });\n            }\n\n            return;\n          }\n\n          if (Hotkeys.isDeleteWordBackward(nativeEvent)) {\n            event.preventDefault();\n\n            if (selection && Range.isExpanded(selection)) {\n              Editor.deleteFragment(editor);\n            } else {\n              Editor.deleteBackward(editor, {\n                unit: 'word'\n              });\n            }\n\n            return;\n          }\n\n          if (Hotkeys.isDeleteWordForward(nativeEvent)) {\n            event.preventDefault();\n\n            if (selection && Range.isExpanded(selection)) {\n              Editor.deleteFragment(editor);\n            } else {\n              Editor.deleteForward(editor, {\n                unit: 'word'\n              });\n            }\n\n            return;\n          }\n        }\n      }\n    }, [readOnly, attributes.onKeyDown]),\n    onPaste: useCallback(event => {\n      // COMPAT: Certain browsers don't support the `beforeinput` event, so we\n      // fall back to React's `onPaste` here instead.\n      // COMPAT: Firefox, Chrome and Safari are not emitting `beforeinput` events\n      // when \"paste without formatting\" option is used.\n      // This unfortunately needs to be handled with paste events instead.\n      if (!isEventHandled(event, attributes.onPaste) && (!HAS_BEFORE_INPUT_SUPPORT || isPlainTextOnlyPaste(event.nativeEvent)) && !readOnly && hasEditableTarget(editor, event.target)) {\n        event.preventDefault();\n        ReactEditor.insertData(editor, event.clipboardData);\n      }\n    }, [readOnly, attributes.onPaste])\n  }), React.createElement(Children, {\n    decorate: decorate,\n    decorations: decorations,\n    node: editor,\n    renderElement: renderElement,\n    renderLeaf: renderLeaf,\n    selection: editor.selection\n  })));\n};\n/**\r\n * A default memoized decorate function.\r\n */\n\nvar defaultDecorate = () => [];\n/**\r\n * Check if the target is in the editor.\r\n */\n\n\nvar hasTarget = (editor, target) => {\n  return isDOMNode(target) && ReactEditor.hasDOMNode(editor, target);\n};\n/**\r\n * Check if the target is editable and in the editor.\r\n */\n\n\nvar hasEditableTarget = (editor, target) => {\n  return isDOMNode(target) && ReactEditor.hasDOMNode(editor, target, {\n    editable: true\n  });\n};\n/**\r\n * Check if the target is inside void and in the editor.\r\n */\n\n\nvar isTargetInsideVoid = (editor, target) => {\n  var slateNode = hasTarget(editor, target) && ReactEditor.toSlateNode(editor, target);\n  return Editor.isVoid(editor, slateNode);\n};\n/**\r\n * Check if an event is overrided by a handler.\r\n */\n\n\nvar isEventHandled = (event, handler) => {\n  if (!handler) {\n    return false;\n  }\n\n  handler(event);\n  return event.isDefaultPrevented() || event.isPropagationStopped();\n};\n/**\r\n * Check if a DOM event is overrided by a handler.\r\n */\n\n\nvar isDOMEventHandled = (event, handler) => {\n  if (!handler) {\n    return false;\n  }\n\n  handler(event);\n  return event.defaultPrevented;\n};\n\nexport { DefaultElement, DefaultLeaf, Editable, ReactEditor, Slate, useEditor, useFocused, useReadOnly, useSelected, useSlate, withReact };\n//# sourceMappingURL=index.es.js.map\n","const compose = (...funcs) => (arg) =>\n  funcs.reduceRight((composed, f) => (f ? f(composed) : composed), arg);\n\nexport default compose;\n","const flow = (...funcs) => (arg) =>\n  funcs.reduce((composed, f) => (f ? f(composed) : composed), arg);\n\nexport default flow;\n","const map = (iteratee) => (collection) => collection.map(iteratee);\n\nexport default map;\n","const get = (path) => (object) => object[path];\n\nexport default get;\n","const apply = (args = []) => (func) => func(...args);\n\nexport default apply;\n","const createPlugin = (configs) => {\n  const defaultPlugin = {\n    name: '',\n    renderLeaf: (next) => (props) => next(props),\n    renderElement: (next) => (props) => next(props),\n    ToolbarButton: () => null,\n    renderCustom: () => null,\n    handleMessage: () => () => {},\n    enhanceEditor: (editor) => editor,\n  };\n  return { ...defaultPlugin, ...configs };\n};\n\nexport default createPlugin;\n","const withId = (id) => (editor) => {\n  editor.id = id;\n  return editor;\n};\n\nexport default withId;\n","import { useState, useRef } from 'react';\n\nconst useForceUpdate = () => {\n  const prev = useRef(0);\n  const [curr, setCurr] = useState(0);\n  const isForceUpdated = prev.current !== curr;\n  prev.current = curr;\n  return { isForceUpdated, forceUpdate: () => setCurr(curr + 1) };\n};\n\nexport default useForceUpdate;\n","import React from 'react';\nimport { Editor } from 'slate';\nimport compose from './compose';\n\nconst isMarkActive = (editor, format) => {\n  const marks = Editor.marks(editor);\n  return marks ? marks[format] === true : false;\n};\n\nconst toggleMark = (editor, format) => {\n  const isActive = isMarkActive(editor, format);\n  if (isActive) {\n    Editor.removeMark(editor, format);\n  } else {\n    Editor.addMark(editor, format, true);\n  }\n};\n\nconst DefaultLeaf = 'span';\n\nconst renderDefaultLeaf = ({ attributes, children }) => (\n  <DefaultLeaf {...attributes}>{children}</DefaultLeaf>\n);\n\nconst makeRenderLeaf = (mark, CustomLeaf) => (next) => (props) => {\n  if (props.leaf[mark]) {\n    const children = <CustomLeaf {...props} />;\n    return next({ ...props, children });\n  }\n  return next(props);\n};\n\nconst composeRenderLeaf = (plugins) =>\n  compose(...plugins.map((plugin) => plugin.renderLeaf))(renderDefaultLeaf);\n\nexport {\n  isMarkActive,\n  toggleMark,\n  renderDefaultLeaf,\n  makeRenderLeaf,\n  composeRenderLeaf,\n};\n","// Blocks\nconst BULLETED_LIST = 'bulleted-list';\nconst NUMBERED_LIST = 'numbered-list';\nconst LIST_ITEM = 'list-item';\nconst MENTION = 'mention';\nconst LINK = 'link';\n\n// Marks\nconst BOLD = 'bold';\nconst ITALIC = 'italic';\nconst UNDERLINE = 'underline';\nconst H1 = 'h1';\n\n// Other events\nconst EDITOR_CHANGE = 'editor-change';\nconst EDITOR_FOCUS = 'editor-focus';\nconst EDITOR_BLUR = 'editor-blur';\nconst EDITOR_LAYOUT = 'editor-layout';\n\n// Node type\nconst PARAGRAPH = 'paragraph';\nconst HEADING = 'heading';\n\nexport {\n  BULLETED_LIST,\n  NUMBERED_LIST,\n  LIST_ITEM,\n  MENTION,\n  LINK,\n  BOLD,\n  ITALIC,\n  UNDERLINE,\n  EDITOR_CHANGE,\n  EDITOR_FOCUS,\n  EDITOR_BLUR,\n  EDITOR_LAYOUT,\n  H1,\n  PARAGRAPH,\n  HEADING,\n};\n","import React from 'react';\nimport { Editor } from 'slate';\nimport compose from './compose';\nimport { NUMBERED_LIST, BULLETED_LIST, HEADING } from '../constants';\n\nconst isBlockActive = (editor, format) => {\n  const [match] = Editor.nodes(editor, {\n    match: (n) => n.type === format,\n  });\n  return !!match;\n};\n\nconst isList = (node) => [BULLETED_LIST, NUMBERED_LIST].includes(node.type);\n\nconst DefaultElement = React.forwardRef((props, ref) => (\n  <p ref={ref} style={{ margin: 0, lineHeight: 1.5 }} {...props} />\n));\n\nconst HeadingElement = React.forwardRef((props, ref) => (\n  <div ref={ref} style={{ margin: 0, lineHeight: 1.5 }} {...props} />\n));\n\nconst renderDefaultElement = ({ attributes, children, element }) => {\n  const isHeading = element.type === HEADING;\n  return isHeading ? (\n    <HeadingElement {...attributes}>{children}</HeadingElement>\n  ) : (\n    <DefaultElement {...attributes}>{children}</DefaultElement>\n  );\n};\n\nconst makeRenderElement = (block, CustomElement) => (next) => (props) => {\n  if (props.element.type === block) {\n    return <CustomElement {...props} />;\n  }\n  return next(props);\n};\n\nconst composeRenderElement = (plugins) =>\n  compose(...plugins.map((plugin) => plugin.renderElement))(\n    renderDefaultElement,\n  );\n\nexport {\n  isBlockActive,\n  isList,\n  renderDefaultElement,\n  makeRenderElement,\n  composeRenderElement,\n};\n","const messagePrefix = '@hero-editor';\n\nconst addMessageListener = (type, callback) => (editor) => {\n  const listener = (event) => {\n    if (event.data.type === `${messagePrefix}/${editor.id}/${type}`) {\n      callback({ editor, data: event.data.data });\n    }\n  };\n  window.addEventListener('message', listener);\n  return () => window.removeEventListener('message', listener);\n};\n\nconst postMessage = (type, data, editor) => {\n  const message = {\n    type: `${messagePrefix}/${editor.id}/${type}`,\n    data,\n  };\n  window.postMessage(message, '*');\n  window.ReactNativeWebView?.postMessage(JSON.stringify(message));\n};\n\nexport { addMessageListener, postMessage };\n","import React from 'react';\n\nconst styles = {\n  toolbar: {\n    display: 'flex',\n    flexDirection: 'row',\n  },\n  button: {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n\n    height: 30,\n    minWidth: 30,\n    margin: 5,\n    padding: 0,\n    border: 'none',\n\n    background: 'transparent',\n    borderRadius: 4,\n    cursor: 'pointer',\n  },\n  buttonActive: {\n    background: '#f5f5f5',\n  },\n  separator: {\n    margin: '10px 5px',\n    borderRight: 'solid thin #eaeaea',\n  },\n};\n\nconst Toolbar = ({ children }) => <div style={styles.toolbar}>{children}</div>;\n\nToolbar.Button = ({ active, ...props }) => (\n  <button\n    {...props}\n    style={{\n      ...styles.button,\n      ...(active ? styles.buttonActive : undefined),\n    }}\n  />\n);\n\nToolbar.Separator = () => <div style={styles.separator} />;\n\nexport default Toolbar;\n","import React from 'react';\n\nconst svgIcons = {\n  format_bold:\n    '<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24\" viewBox=\"0 0 24 24\" width=\"24\"><path d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M15.6 10.79c.97-.67 1.65-1.77 1.65-2.79 0-2.26-1.75-4-4-4H7v14h7.04c2.09 0 3.71-1.7 3.71-3.79 0-1.52-.86-2.82-2.15-3.42zM10 6.5h3c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5h-3v-3zm3.5 9H10v-3h3.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5z\"/></svg>',\n  format_italic:\n    '<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24\" viewBox=\"0 0 24 24\" width=\"24\"><path d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M10 4v3h2.21l-3.42 8H6v3h8v-3h-2.21l3.42-8H18V4z\"/></svg>',\n  format_underlined:\n    '<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24\" viewBox=\"0 0 24 24\" width=\"24\"><path d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M12 17c3.31 0 6-2.69 6-6V3h-2.5v8c0 1.93-1.57 3.5-3.5 3.5S8.5 12.93 8.5 11V3H6v8c0 3.31 2.69 6 6 6zm-7 2v2h14v-2H5z\"/></svg>',\n  format_list_bulleted:\n    '<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24\" viewBox=\"0 0 24 24\" width=\"24\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M4 10.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm0-6c-.83 0-1.5.67-1.5 1.5S3.17 7.5 4 7.5 5.5 6.83 5.5 6 4.83 4.5 4 4.5zm0 12c-.83 0-1.5.68-1.5 1.5s.68 1.5 1.5 1.5 1.5-.68 1.5-1.5-.67-1.5-1.5-1.5zM7 19h14v-2H7v2zm0-6h14v-2H7v2zm0-8v2h14V5H7z\"/></svg>',\n  format_list_numbered:\n    '<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24\" viewBox=\"0 0 24 24\" width=\"24\"><path d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M2 17h2v.5H3v1h1v.5H2v1h3v-4H2v1zm1-9h1V4H2v1h1v3zm-1 3h1.8L2 13.1v.9h3v-1H3.2L5 10.9V10H2v1zm5-6v2h14V5H7zm0 14h14v-2H7v2zm0-6h14v-2H7v2z\"/></svg>',\n  format_h1:\n    '<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24\" viewBox=\"0 0 24 24\" width=\"24\"><path d=\"M0 0h24v24H0z\" fill=\"none\" /><path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14h-2V9h-2V7h4v10z\" /> </svg>',\n};\n\nconst styles = {\n  icon: {\n    opacity: 0.7,\n  },\n};\n\nconst Icon = ({ children }) => (\n  <img\n    height={20}\n    src={`data:image/svg+xml;utf8,${svgIcons[children]}`}\n    style={styles.icon}\n  />\n);\n\nexport default Icon;\n","import React from 'react';\nimport { useSlate } from 'slate-react';\nimport {\n  createPlugin,\n  isMarkActive,\n  toggleMark,\n  makeRenderLeaf,\n  addMessageListener,\n  postMessage,\n} from '../helpers';\nimport Toolbar from '../components/Toolbar';\nimport Icon from '../components/Icon';\nimport { BOLD } from '../constants';\n\nconst renderLeaf = makeRenderLeaf(BOLD, ({ children }) => (\n  <strong>{children}</strong>\n));\n\nconst handleMessage = addMessageListener(BOLD, ({ editor }) => {\n  toggleMark(editor, BOLD);\n});\n\nconst ToolbarButton = () => {\n  const editor = useSlate();\n\n  return (\n    <Toolbar.Button\n      active={isMarkActive(editor, BOLD)}\n      onMouseDown={(event) => {\n        event.preventDefault();\n        postMessage(BOLD, {}, editor);\n      }}\n    >\n      <Icon>format_bold</Icon>\n    </Toolbar.Button>\n  );\n};\n\nexport default () =>\n  createPlugin({\n    name: BOLD,\n    renderLeaf,\n    handleMessage,\n    ToolbarButton,\n  });\n","import React from 'react';\nimport { useSlate } from 'slate-react';\nimport {\n  createPlugin,\n  isMarkActive,\n  toggleMark,\n  makeRenderLeaf,\n  addMessageListener,\n  postMessage,\n} from '../helpers';\nimport Toolbar from '../components/Toolbar';\nimport Icon from '../components/Icon';\nimport { ITALIC } from '../constants';\n\nconst renderLeaf = makeRenderLeaf(ITALIC, ({ children }) => (\n  <em>{children}</em>\n));\n\nconst handleMessage = addMessageListener(ITALIC, ({ editor }) => {\n  toggleMark(editor, ITALIC);\n});\n\nconst ToolbarButton = () => {\n  const editor = useSlate();\n\n  return (\n    <Toolbar.Button\n      active={isMarkActive(editor, ITALIC)}\n      onMouseDown={(event) => {\n        event.preventDefault();\n        postMessage(ITALIC, {}, editor);\n      }}\n    >\n      <Icon>format_italic</Icon>\n    </Toolbar.Button>\n  );\n};\n\nexport default () =>\n  createPlugin({\n    name: ITALIC,\n    renderLeaf,\n    handleMessage,\n    ToolbarButton,\n  });\n","import React from 'react';\nimport { useSlate } from 'slate-react';\nimport {\n  createPlugin,\n  isMarkActive,\n  toggleMark,\n  makeRenderLeaf,\n  addMessageListener,\n  postMessage,\n} from '../helpers';\nimport Toolbar from '../components/Toolbar';\nimport Icon from '../components/Icon';\nimport { UNDERLINE } from '../constants';\n\nconst renderLeaf = makeRenderLeaf(UNDERLINE, ({ children }) => (\n  <u>{children}</u>\n));\n\nconst handleMessage = addMessageListener(UNDERLINE, ({ editor }) => {\n  toggleMark(editor, UNDERLINE);\n});\n\nconst ToolbarButton = () => {\n  const editor = useSlate();\n\n  return (\n    <>\n      <Toolbar.Button\n        active={isMarkActive(editor, UNDERLINE)}\n        onMouseDown={(event) => {\n          event.preventDefault();\n          postMessage(UNDERLINE, {}, editor);\n        }}\n      >\n        <Icon>format_underlined</Icon>\n      </Toolbar.Button>\n      <Toolbar.Separator />\n    </>\n  );\n};\n\nexport default () =>\n  createPlugin({\n    name: UNDERLINE,\n    renderLeaf,\n    handleMessage,\n    ToolbarButton,\n  });\n","import { createPlugin } from '../helpers';\n\nconst name = 'logger';\n\nconst isEmpty = (object) => object && Object.keys(object).length < 1;\n\nconst handleMessage = () => {\n  const listener = (event) => {\n    if (event.data.type?.startsWith('@hero-editor')) {\n      const groupMethod = isEmpty(event.data.data) ? 'groupCollapsed' : 'group';\n      console[groupMethod](`%c ${event.data.type} `, 'color: limegreen;');\n      console.log({\n        data: event.data.data,\n        event,\n      });\n      console.groupEnd();\n    }\n  };\n  window.addEventListener('message', listener);\n  return () => window.removeEventListener('message', listener);\n};\n\nexport default () => createPlugin({ name, handleMessage });\n","import React from 'react';\nimport { Transforms } from 'slate';\nimport { useSlate } from 'slate-react';\nimport {\n  createPlugin,\n  isBlockActive,\n  makeRenderElement,\n  addMessageListener,\n  postMessage,\n  isList,\n} from '../helpers';\nimport Toolbar from '../components/Toolbar';\nimport Icon from '../components/Icon';\nimport { BULLETED_LIST, LIST_ITEM } from '../constants';\n\nconst renderElement = makeRenderElement(\n  BULLETED_LIST,\n  ({ attributes, children }) => <ul {...attributes}>{children}</ul>,\n);\n\nconst handleMessage = addMessageListener(BULLETED_LIST, ({ editor }) => {\n  const isActive = isBlockActive(editor, BULLETED_LIST);\n\n  // Unwrap all the items of any list\n  Transforms.unwrapNodes(editor, {\n    match: isList,\n    split: true,\n  });\n\n  if (isActive) {\n    Transforms.setNodes(editor, { type: 'paragraph' });\n  } else {\n    Transforms.setNodes(editor, { type: LIST_ITEM });\n    Transforms.wrapNodes(editor, { type: BULLETED_LIST, children: [] });\n  }\n});\n\nconst ToolbarButton = () => {\n  const editor = useSlate();\n\n  return (\n    <Toolbar.Button\n      active={isBlockActive(editor, BULLETED_LIST)}\n      onMouseDown={(event) => {\n        event.preventDefault();\n        postMessage(BULLETED_LIST, {}, editor);\n      }}\n    >\n      <Icon>format_list_bulleted</Icon>\n    </Toolbar.Button>\n  );\n};\n\nexport default () =>\n  createPlugin({\n    name: BULLETED_LIST,\n    renderElement,\n    handleMessage,\n    ToolbarButton,\n  });\n","import React from 'react';\nimport { Transforms } from 'slate';\nimport { useSlate } from 'slate-react';\nimport {\n  createPlugin,\n  isBlockActive,\n  makeRenderElement,\n  addMessageListener,\n  postMessage,\n  isList,\n} from '../helpers';\nimport Toolbar from '../components/Toolbar';\nimport Icon from '../components/Icon';\nimport { NUMBERED_LIST, LIST_ITEM } from '../constants';\n\nconst renderElement = makeRenderElement(\n  NUMBERED_LIST,\n  ({ attributes, children }) => <ol {...attributes}>{children}</ol>,\n);\n\nconst handleMessage = addMessageListener(NUMBERED_LIST, ({ editor }) => {\n  const isActive = isBlockActive(editor, NUMBERED_LIST);\n\n  // Unwrap all the items of any list\n  Transforms.unwrapNodes(editor, {\n    match: isList,\n    split: true,\n  });\n\n  if (isActive) {\n    Transforms.setNodes(editor, { type: 'paragraph' });\n  } else {\n    Transforms.setNodes(editor, { type: LIST_ITEM });\n    Transforms.wrapNodes(editor, { type: NUMBERED_LIST, children: [] });\n  }\n});\n\nconst ToolbarButton = () => {\n  const editor = useSlate();\n\n  return (\n    <Toolbar.Button\n      active={isBlockActive(editor, NUMBERED_LIST)}\n      onMouseDown={(event) => {\n        event.preventDefault();\n        postMessage(NUMBERED_LIST, {}, editor);\n      }}\n    >\n      <Icon>format_list_numbered</Icon>\n    </Toolbar.Button>\n  );\n};\n\nexport default () =>\n  createPlugin({\n    name: NUMBERED_LIST,\n    renderElement,\n    handleMessage,\n    ToolbarButton,\n  });\n","import React from 'react';\nimport { createPlugin, makeRenderElement } from '../helpers';\nimport { LIST_ITEM } from '../constants';\n\nconst renderElement = makeRenderElement(\n  LIST_ITEM,\n  ({ attributes, children }) => <li {...attributes}>{children}</li>,\n);\n\nexport default () =>\n  createPlugin({\n    name: LIST_ITEM,\n    renderElement,\n  });\n","import React, { useState, useEffect, useRef } from 'react';\nimport { Editor, Range, Transforms } from 'slate';\nimport { useSlate, ReactEditor } from 'slate-react';\nimport {\n  createPlugin,\n  makeRenderElement,\n  addMessageListener,\n  postMessage,\n} from '../helpers';\nimport { MENTION, EDITOR_CHANGE } from '../constants';\n\nconst MentionElement = ({ attributes, children, element }) => (\n  <span\n    {...attributes}\n    contentEditable={false}\n    style={{ padding: '2px 4px', background: '#eeeeee', borderRadius: 4 }}\n  >\n    @{element.data.name}\n    {children}\n  </span>\n);\n\nconst renderElement = makeRenderElement(MENTION, MentionElement);\n\nconst handleMessage = (editor) => {\n  const removeEditorChangeListener = addMessageListener(\n    EDITOR_CHANGE,\n    ({ editor }) => {\n      const { selection } = editor;\n\n      if (selection && Range.isCollapsed(selection)) {\n        const [start] = Range.edges(selection);\n        const wordBefore = Editor.before(editor, start, { unit: 'word' });\n        const before = wordBefore && Editor.before(editor, wordBefore);\n        const beforeRange = before && Editor.range(editor, before, start);\n        const beforeText = beforeRange && Editor.string(editor, beforeRange);\n        const beforeMatch = beforeText && beforeText.match(/^@(\\w+)$/);\n        const after = Editor.after(editor, start);\n        const afterRange = Editor.range(editor, start, after);\n        const afterText = Editor.string(editor, afterRange);\n        const afterMatch = afterText.match(/^(\\s|$)/);\n\n        if (beforeMatch && afterMatch) {\n          postMessage(\n            'mention-search',\n            { target: beforeRange, search: beforeMatch[1] },\n            editor,\n          );\n        } else {\n          postMessage('mention-search', { target: null, search: '' }, editor);\n        }\n      }\n    },\n  )(editor);\n\n  const removeMentionApplyListener = addMessageListener(\n    'mention-apply',\n    ({ editor, data }) => {\n      const { id, name, meta } = data;\n      Transforms.select(editor, meta.target);\n      const mention = {\n        type: MENTION,\n        data: { id, name },\n        children: [{ text: '' }],\n      };\n      Transforms.insertNodes(editor, mention);\n      Transforms.move(editor);\n    },\n  )(editor);\n\n  return () => {\n    removeEditorChangeListener();\n    removeMentionApplyListener();\n  };\n};\n\nconst MentionListWrapper = ({ renderMentionList }) => {\n  const [search, setSearch] = useState('');\n  const [target, setTarget] = useState(null);\n  const wrapper = useRef(null);\n  const editor = useSlate();\n\n  useEffect(() => {\n    const removeMentionSearchListener = addMessageListener(\n      'mention-search',\n      ({ data }) => {\n        const wrapperEl = wrapper.current;\n\n        if (data.target) {\n          const domRange = ReactEditor.toDOMRange(editor, data.target);\n          const rangeRect = domRange.getBoundingClientRect();\n          const editorRect = wrapperEl.parentElement.getBoundingClientRect();\n\n          wrapperEl.style.display = 'block';\n          wrapperEl.style.top = `${rangeRect.top - editorRect.top + 20}px`;\n          wrapperEl.style.left = `${rangeRect.left - editorRect.left}px`;\n        } else {\n          wrapperEl.style.display = 'none';\n        }\n\n        setSearch(data.search);\n        setTarget(data.target);\n      },\n    )(editor);\n\n    return () => removeMentionSearchListener();\n  }, []);\n\n  return (\n    <div ref={wrapper} style={{ position: 'absolute', display: 'none' }}>\n      {renderMentionList(search, ({ id, name }) => {\n        postMessage('mention-apply', { id, name, meta: { target } }, editor);\n      })}\n    </div>\n  );\n};\n\nconst enhanceEditor = (editor) => {\n  const { isInline, isVoid } = editor;\n\n  editor.isInline = (element) => {\n    return element.type === MENTION ? true : isInline(element);\n  };\n\n  editor.isVoid = (element) => {\n    return element.type === MENTION ? true : isVoid(element);\n  };\n\n  return editor;\n};\n\nexport default ({ renderMentionList }) =>\n  createPlugin({\n    name: MENTION,\n    renderElement,\n    renderCustom: () => (\n      <MentionListWrapper key={MENTION} renderMentionList={renderMentionList} />\n    ),\n    handleMessage,\n    enhanceEditor,\n  });\n","import React, { useCallback, useEffect, useRef } from 'react';\nimport { createPlugin, useForceUpdate } from '../helpers';\n\nconst styles = {\n  placeholder: {\n    boxSizing: 'border-box',\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    width: '100%',\n    padding: 16,\n    lineHeight: 1.5,\n    color: 'lightgrey',\n    zIndex: -1,\n  },\n};\n\nconst CACHE_TTL = 500;\n\nconst isDefined = (ref) => typeof ref.current !== 'undefined';\n\nconst checkEmptyOptimistically = (content) =>\n  content.length === 1 &&\n  content[0].type === 'paragraph' &&\n  content[0].children.length === 1 &&\n  content[0].children[0].text === '';\n\nconst EditorPlaceholder = ({ value, editor, style }) => {\n  const cache = useRef(undefined);\n  const { isForceUpdated, forceUpdate } = useForceUpdate();\n\n  const createPlaceholder = useCallback(() => {\n    const isEmpty = checkEmptyOptimistically(editor.children);\n    const mergedStyle = { ...styles.placeholder, ...style };\n\n    return isEmpty ? <div style={mergedStyle}>{value}</div> : null;\n  }, []);\n\n  useEffect(() => {\n    if (isDefined(cache)) {\n      const timerId = setTimeout(() => {\n        cache.current = undefined;\n\n        if (!isForceUpdated) forceUpdate();\n      }, CACHE_TTL);\n\n      return () => clearTimeout(timerId);\n    }\n  });\n\n  if (isDefined(cache)) return cache.current;\n\n  cache.current = createPlaceholder();\n\n  return cache.current;\n};\n\nexport default ({ value, style }) =>\n  createPlugin({\n    name: 'editor-placeholder',\n    renderCustom: (editor) => (\n      <EditorPlaceholder\n        key=\"editor-placeholder\"\n        value={value}\n        editor={editor}\n        style={style}\n      />\n    ),\n  });\n","import React from 'react';\nimport isUrl from 'is-url';\nimport { Transforms } from 'slate';\nimport {\n  createPlugin,\n  makeRenderElement,\n  addMessageListener,\n  postMessage,\n} from '../helpers';\nimport { LINK } from '../constants';\n\nconst getUrl = (element) =>\n  element.children.reduce((url, node) => url + node.text, '');\n\nconst LinkElement = ({ attributes, children, element }) => (\n  <a {...attributes} href={getUrl(element)}>\n    {children}\n  </a>\n);\n\nconst renderElement = makeRenderElement(LINK, LinkElement);\n\nconst handleMessage = addMessageListener(LINK, ({ editor, data: { url } }) => {\n  Transforms.insertNodes(editor, {\n    type: LINK,\n    data: { url },\n    children: [{ text: url }],\n  });\n});\n\nconst enhanceEditor = (editor) => {\n  const { isInline, insertData } = editor;\n\n  editor.isInline = (element) => {\n    return element.type === LINK ? true : isInline(element);\n  };\n\n  editor.insertData = (data) => {\n    const text = data.getData('text/plain');\n\n    if (text && isUrl(text)) {\n      postMessage(LINK, { url: text }, editor);\n    } else {\n      insertData(data);\n    }\n  };\n\n  return editor;\n};\n\nexport default () =>\n  createPlugin({\n    name: LINK,\n    renderElement,\n    handleMessage,\n    enhanceEditor,\n  });\n","import { ReactEditor } from 'slate-react';\nimport { createPlugin, addMessageListener, postMessage } from '../helpers';\nimport { EDITOR_CHANGE } from '../constants';\n\nconst handleMessage = addMessageListener(EDITOR_CHANGE, ({ editor }) => {\n  const { selection } = editor;\n\n  if (selection) {\n    const domRange = ReactEditor.toDOMRange(editor, selection);\n    const rangeRect = domRange.getBoundingClientRect();\n\n    postMessage(\n      'cursor-change',\n      {\n        offset: undefined,\n        position: {\n          top: rangeRect.top,\n          left: rangeRect.left,\n        },\n      },\n      editor,\n    );\n  }\n});\n\nexport default () =>\n  createPlugin({\n    name: 'cursor-tracker',\n    handleMessage,\n  });\n","import React from 'react';\nimport { useSlate } from 'slate-react';\nimport { Transforms } from 'slate';\nimport {\n  createPlugin,\n  isMarkActive,\n  toggleMark,\n  makeRenderLeaf,\n  addMessageListener,\n  postMessage,\n  isHeading,\n  isBlockActive,\n} from '../helpers';\nimport Toolbar from '../components/Toolbar';\nimport Icon from '../components/Icon';\nimport { H1, HEADING } from '../constants';\n\nconst renderLeaf = makeRenderLeaf(H1, ({ children }) => <h1>{children}</h1>);\n\nconst handleMessage = addMessageListener(H1, ({ editor }) => {\n  const isActive = isBlockActive(editor, HEADING);\n  toggleMark(editor, H1);\n  return Transforms.setNodes(editor, {\n    type: isActive ? 'paragraph' : 'heading',\n  });\n});\n\nconst ToolbarButton = () => {\n  const editor = useSlate();\n\n  return (\n    <Toolbar.Button\n      active={isMarkActive(editor, H1)}\n      onMouseDown={(event) => {\n        event.preventDefault();\n        postMessage(H1, {}, editor);\n      }}\n    >\n      <Icon>format_h1</Icon>\n    </Toolbar.Button>\n  );\n};\n\nexport default () =>\n  createPlugin({\n    name: H1,\n    renderLeaf,\n    handleMessage,\n    ToolbarButton,\n  });\n","import React from 'react';\n\nconst styles = {\n  jsonViewer: {\n    padding: 16,\n    borderRadius: 4,\n    background: 'linen',\n  },\n};\n\nconst JsonViewer = ({ value }) => (\n  <pre style={styles.jsonViewer}>\n    <code>{JSON.stringify(value, null, 2)}</code>\n  </pre>\n);\n\nexport default JsonViewer;\n","import { Node } from 'slate';\n\n// TODO: wip\nconst plainSerializer = (nodes) => {\n  return nodes.map((n) => Node.string(n)).join('\\n');\n};\n\nexport default plainSerializer;\n","// lmao\nconst y = (f) =>\n  ((g) => (...a) => f(g(g))(...a))((g) => (...a) => f(g(g))(...a));\n\nexport default y;\n","import React from 'react';\nimport { Text, Node } from 'slate';\nimport y from '../helpers/why';\n\nconst isRoot = Array.isArray;\n\nconst makeReactTransformer = (rules) =>\n  y((reactTransformer) => (node, key) => {\n    if (isRoot(node)) return node.map(reactTransformer);\n\n    if (Text.isText(node)) return rules.leaf(node, key);\n\n    const children = node.children.map(reactTransformer);\n\n    return rules.element(node, children, key);\n  });\n\nconst defaultRules = {\n  leaf: (node, key) => {\n    let children = node.text;\n\n    if (node.bold) children = <strong key={key}>{children}</strong>;\n\n    if (node.italic) children = <em key={key}>{children}</em>;\n\n    if (node.underline) children = <u key={key}>{children}</u>;\n\n    return <span key={key}>{children}</span>;\n  },\n\n  element: (node, children, key) => {\n    switch (node.type) {\n      case 'paragraph':\n        return (\n          <p\n            key={key}\n            style={{ margin: 0, lineHeight: 1.5, minHeight: '1.5em' }}\n          >\n            {children}\n          </p>\n        );\n\n      case 'link':\n        return (\n          <a key={key} href={Node.string(node)} target=\"_blank\">\n            {children}\n          </a>\n        );\n\n      case 'mention':\n        return (\n          <span\n            key={key}\n            style={{\n              padding: '2px 4px',\n              background: '#eeeeee',\n              borderRadius: 4,\n            }}\n          >\n            @{node.data.name}\n          </span>\n        );\n\n      case 'bulleted-list':\n        return <ul key={key}>{children}</ul>;\n\n      case 'numbered-list':\n        return <ol key={key}>{children}</ol>;\n\n      case 'list-item':\n        return <li key={key}>{children}</li>;\n        q;\n      default:\n        return <div key={key}>{children}</div>;\n    }\n  },\n};\n\nconst defaultReactTransformer = makeReactTransformer(defaultRules);\n\nexport default makeReactTransformer;\n\nexport { makeReactTransformer, defaultReactTransformer };\n","import React, { useMemo, useEffect, useRef } from 'react';\nimport { createEditor } from 'slate';\nimport { Slate, Editable, withReact } from 'slate-react';\nimport {\n  composeRenderLeaf,\n  composeRenderElement,\n  postMessage,\n  withId,\n  map,\n  get,\n  apply,\n  flow,\n} from './helpers';\nimport Toolbar from './components/Toolbar';\nimport {\n  EDITOR_CHANGE,\n  EDITOR_FOCUS,\n  EDITOR_BLUR,\n  EDITOR_LAYOUT,\n} from './constants';\n\nconst styles = {\n  editorWrapper: {\n    fontFamily: 'sans-serif',\n    border: 'solid thin #eaeaea',\n    borderRadius: 4,\n  },\n  editableWrapper: {\n    position: 'relative',\n  },\n  editable: {\n    padding: 16,\n  },\n};\n\nconst getCustomElements = (editor) =>\n  map(flow(get('renderCustom'), apply([editor])));\n\nconst addMessageListeners = (editor) =>\n  map(flow(get('handleMessage'), apply([editor])));\n\nconst getToolbarButtons = map(({ name, ToolbarButton }) => (\n  <ToolbarButton key={name} />\n));\n\nconst noop = () => {};\n\nconst HeroEditor = ({\n  id,\n  showToolbar = true,\n  autoFocus = false,\n  plugins = [],\n  placeholder,\n  value,\n  onChange,\n  onFocus = noop,\n  onBlur = noop,\n  onLayout = noop,\n  wrapperStyle,\n  editableStyle,\n}) => {\n  const wrapper = useRef(null);\n  const wrapperLayout = useRef({ width: 0, height: 0 });\n\n  const editor = useMemo(\n    () =>\n      flow(\n        createEditor,\n        withReact,\n        withId(id),\n        ...map(get('enhanceEditor'))(plugins),\n      )(),\n    [],\n  );\n\n  const renderLeaf = useMemo(() => composeRenderLeaf(plugins), [plugins]);\n\n  const renderElement = useMemo(() => composeRenderElement(plugins), [plugins]);\n\n  const renderCustom = useMemo(() => () => getCustomElements(editor)(plugins), [\n    plugins,\n    value,\n  ]);\n\n  const toolBarButtons = useMemo(() => getToolbarButtons(plugins), [plugins]);\n\n  useEffect(() => {\n    const removeHandlers = addMessageListeners(editor)(plugins);\n\n    return () => removeHandlers.forEach((removeHandler) => removeHandler());\n  }, [plugins]);\n\n  useEffect(() => {\n    const width = wrapper.current?.offsetWidth;\n    const height = wrapper.current?.offsetHeight;\n\n    if (\n      width !== wrapperLayout.current.width ||\n      height !== wrapperLayout.current.height\n    ) {\n      wrapperLayout.current = { width, height };\n      onLayout(wrapperLayout.current);\n      postMessage(EDITOR_LAYOUT, wrapperLayout.current, editor);\n    }\n  }, [value]);\n\n  return (\n    <div\n      ref={wrapper}\n      className=\"hero-editor--wrapper\"\n      style={{ ...styles.editorWrapper, ...wrapperStyle }}\n    >\n      <Slate\n        editor={editor}\n        value={value}\n        onChange={(value) => {\n          onChange(value);\n          postMessage(EDITOR_CHANGE, { value }, editor);\n        }}\n      >\n        {showToolbar ? <Toolbar>{toolBarButtons}</Toolbar> : null}\n        <div style={styles.editableWrapper}>\n          <Editable\n            className=\"hero-editor--editable\"\n            placeholder={placeholder}\n            autoFocus={autoFocus}\n            renderLeaf={renderLeaf}\n            renderElement={renderElement}\n            onFocus={(e) => {\n              onFocus(e);\n              postMessage(EDITOR_FOCUS, {}, editor);\n            }}\n            onBlur={(e) => {\n              onBlur(e);\n              postMessage(EDITOR_BLUR, {}, editor);\n            }}\n            style={{ ...styles.editable, ...editableStyle }}\n          />\n          {renderCustom()}\n        </div>\n      </Slate>\n    </div>\n  );\n};\n\nexport * from './plugins';\nexport { default as JsonViewer } from './components/JsonViewer';\nexport { default as Toolbar } from './components/Toolbar';\nexport { default as plainSerializer } from './serializers/plain';\nexport { default as makeReactTransformer } from './transformers/react';\nexport { defaultReactTransformer } from './transformers/react';\nexport default HeroEditor;\n"],"sourceRoot":""}